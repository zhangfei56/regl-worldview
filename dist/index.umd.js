var ReglWorldview=function(t,e,r,n){"use strict";function o(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function i(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}),e.default=t,Object.freeze(e)}var a=i(e),s=o(e),c=o(r),u=o(n);function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function _(t,e){return t(e={exports:{}},e.exports),e.exports}var d="object"==typeof f&&f&&f.Object===Object&&f,m="object"==typeof self&&self&&self.Object===Object&&self,h=d||m||Function("return this")(),y=h.Symbol,b=Object.prototype,v=b.hasOwnProperty,g=b.toString,A=y?y.toStringTag:void 0;var w=function(t){var e=v.call(t,A),r=t[A];try{t[A]=void 0;var n=!0}catch(t){}var o=g.call(t);return n&&(e?t[A]=r:delete t[A]),o},x=Object.prototype.toString;var E=function(t){return x.call(t)},O="[object Null]",T="[object Undefined]",j=y?y.toStringTag:void 0;var S=function(t){return null==t?void 0===t?T:O:j&&j in Object(t)?w(t):E(t)};var C=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},D="[object AsyncFunction]",I="[object Function]",P="[object GeneratorFunction]",M="[object Proxy]";var F,k=function(t){if(!C(t))return!1;var e=S(t);return e==I||e==P||e==D||e==M},R=h["__core-js_shared__"],B=(F=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+F:"";var z=function(t){return!!B&&B in t},G=Function.prototype.toString;var N=function(t){if(null!=t){try{return G.call(t)}catch(t){}try{return t+""}catch(t){}}return""},L=/^\[object .+?Constructor\]$/,U=Function.prototype,W=Object.prototype,H=U.toString,V=W.hasOwnProperty,Y=RegExp("^"+H.call(V).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Q=function(t){return!(!C(t)||z(t))&&(k(t)?Y:L).test(N(t))};var q=function(t,e){return null==t?void 0:t[e]};var K=function(t,e){var r=q(t,e);return Q(r)?r:void 0},$=function(){try{var t=K(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var X=function(t,e,r){"__proto__"==e&&$?$(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r};var Z=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),s=a.length;s--;){var c=a[t?s:++o];if(!1===r(i[c],c,i))break}return e}}();var J=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var tt=function(t){return null!=t&&"object"==typeof t},et="[object Arguments]";var rt=function(t){return tt(t)&&S(t)==et},nt=Object.prototype,ot=nt.hasOwnProperty,it=nt.propertyIsEnumerable,at=rt(function(){return arguments}())?rt:function(t){return tt(t)&&ot.call(t,"callee")&&!it.call(t,"callee")},st=Array.isArray;var ct=function(){return!1},ut=_(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?h.Buffer:void 0,i=(o?o.isBuffer:void 0)||ct;t.exports=i}),pt=9007199254740991,lt=/^(?:0|[1-9]\d*)$/;var ft=function(t,e){var r=typeof t;return!!(e=null==e?pt:e)&&("number"==r||"symbol"!=r&&lt.test(t))&&t>-1&&t%1==0&&t<e},_t=9007199254740991;var dt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=_t},mt={};mt["[object Float32Array]"]=mt["[object Float64Array]"]=mt["[object Int8Array]"]=mt["[object Int16Array]"]=mt["[object Int32Array]"]=mt["[object Uint8Array]"]=mt["[object Uint8ClampedArray]"]=mt["[object Uint16Array]"]=mt["[object Uint32Array]"]=!0,mt["[object Arguments]"]=mt["[object Array]"]=mt["[object ArrayBuffer]"]=mt["[object Boolean]"]=mt["[object DataView]"]=mt["[object Date]"]=mt["[object Error]"]=mt["[object Function]"]=mt["[object Map]"]=mt["[object Number]"]=mt["[object Object]"]=mt["[object RegExp]"]=mt["[object Set]"]=mt["[object String]"]=mt["[object WeakMap]"]=!1;var ht=function(t){return tt(t)&&dt(t.length)&&!!mt[S(t)]};var yt=function(t){return function(e){return t(e)}},bt=_(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r&&d.process,i=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i}),vt=bt&&bt.isTypedArray,gt=vt?yt(vt):ht,At=Object.prototype.hasOwnProperty;var wt=function(t,e){var r=st(t),n=!r&&at(t),o=!r&&!n&&ut(t),i=!r&&!n&&!o&&gt(t),a=r||n||o||i,s=a?J(t.length,String):[],c=s.length;for(var u in t)!e&&!At.call(t,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ft(u,c))||s.push(u);return s},xt=Object.prototype;var Et=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||xt)};var Ot=function(t,e){return function(r){return t(e(r))}},Tt=Ot(Object.keys,Object),jt=Object.prototype.hasOwnProperty;var St=function(t){if(!Et(t))return Tt(t);var e=[];for(var r in Object(t))jt.call(t,r)&&"constructor"!=r&&e.push(r);return e};var Ct=function(t){return null!=t&&dt(t.length)&&!k(t)};var Dt=function(t){return Ct(t)?wt(t):St(t)};var It=function(t,e){return t&&Z(t,e,Dt)};var Pt=function(){this.__data__=[],this.size=0};var Mt=function(t,e){return t===e||t!=t&&e!=e};var Ft=function(t,e){for(var r=t.length;r--;)if(Mt(t[r][0],e))return r;return-1},kt=Array.prototype.splice;var Rt=function(t){var e=this.__data__,r=Ft(e,t);return!(r<0||(r==e.length-1?e.pop():kt.call(e,r,1),--this.size,0))};var Bt=function(t){var e=this.__data__,r=Ft(e,t);return r<0?void 0:e[r][1]};var zt=function(t){return Ft(this.__data__,t)>-1};var Gt=function(t,e){var r=this.__data__,n=Ft(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function Nt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Nt.prototype.clear=Pt,Nt.prototype.delete=Rt,Nt.prototype.get=Bt,Nt.prototype.has=zt,Nt.prototype.set=Gt;var Lt=Nt;var Ut=function(){this.__data__=new Lt,this.size=0};var Wt=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var Ht=function(t){return this.__data__.get(t)};var Vt=function(t){return this.__data__.has(t)},Yt=K(h,"Map"),Qt=K(Object,"create");var qt=function(){this.__data__=Qt?Qt(null):{},this.size=0};var Kt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},$t="__lodash_hash_undefined__",Xt=Object.prototype.hasOwnProperty;var Zt=function(t){var e=this.__data__;if(Qt){var r=e[t];return r===$t?void 0:r}return Xt.call(e,t)?e[t]:void 0},Jt=Object.prototype.hasOwnProperty;var te=function(t){var e=this.__data__;return Qt?void 0!==e[t]:Jt.call(e,t)},ee="__lodash_hash_undefined__";var re=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Qt&&void 0===e?ee:e,this};function ne(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ne.prototype.clear=qt,ne.prototype.delete=Kt,ne.prototype.get=Zt,ne.prototype.has=te,ne.prototype.set=re;var oe=ne;var ie=function(){this.size=0,this.__data__={hash:new oe,map:new(Yt||Lt),string:new oe}};var ae=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var se=function(t,e){var r=t.__data__;return ae(e)?r["string"==typeof e?"string":"hash"]:r.map};var ce=function(t){var e=se(this,t).delete(t);return this.size-=e?1:0,e};var ue=function(t){return se(this,t).get(t)};var pe=function(t){return se(this,t).has(t)};var le=function(t,e){var r=se(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function fe(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}fe.prototype.clear=ie,fe.prototype.delete=ce,fe.prototype.get=ue,fe.prototype.has=pe,fe.prototype.set=le;var _e=fe,de=200;var me=function(t,e){var r=this.__data__;if(r instanceof Lt){var n=r.__data__;if(!Yt||n.length<de-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new _e(n)}return r.set(t,e),this.size=r.size,this};function he(t){var e=this.__data__=new Lt(t);this.size=e.size}he.prototype.clear=Ut,he.prototype.delete=Wt,he.prototype.get=Ht,he.prototype.has=Vt,he.prototype.set=me;var ye=he,be="__lodash_hash_undefined__";var ve=function(t){return this.__data__.set(t,be),this};var ge=function(t){return this.__data__.has(t)};function Ae(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new _e;++e<r;)this.add(t[e])}Ae.prototype.add=Ae.prototype.push=ve,Ae.prototype.has=ge;var we=Ae;var xe=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1};var Ee=function(t,e){return t.has(e)},Oe=1,Te=2;var je=function(t,e,r,n,o,i){var a=r&Oe,s=t.length,c=e.length;if(s!=c&&!(a&&c>s))return!1;var u=i.get(t),p=i.get(e);if(u&&p)return u==e&&p==t;var l=-1,f=!0,_=r&Te?new we:void 0;for(i.set(t,e),i.set(e,t);++l<s;){var d=t[l],m=e[l];if(n)var h=a?n(m,d,l,e,t,i):n(d,m,l,t,e,i);if(void 0!==h){if(h)continue;f=!1;break}if(_){if(!xe(e,function(t,e){if(!Ee(_,e)&&(d===t||o(d,t,r,n,i)))return _.push(e)})){f=!1;break}}else if(d!==m&&!o(d,m,r,n,i)){f=!1;break}}return i.delete(t),i.delete(e),f},Se=h.Uint8Array;var Ce=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r};var De=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r},Ie=1,Pe=2,Me="[object Boolean]",Fe="[object Date]",ke="[object Error]",Re="[object Map]",Be="[object Number]",ze="[object RegExp]",Ge="[object Set]",Ne="[object String]",Le="[object Symbol]",Ue="[object ArrayBuffer]",We="[object DataView]",He=y?y.prototype:void 0,Ve=He?He.valueOf:void 0;var Ye=function(t,e,r,n,o,i,a){switch(r){case We:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Ue:return!(t.byteLength!=e.byteLength||!i(new Se(t),new Se(e)));case Me:case Fe:case Be:return Mt(+t,+e);case ke:return t.name==e.name&&t.message==e.message;case ze:case Ne:return t==e+"";case Re:var s=Ce;case Ge:var c=n&Ie;if(s||(s=De),t.size!=e.size&&!c)return!1;var u=a.get(t);if(u)return u==e;n|=Pe,a.set(t,e);var p=je(s(t),s(e),n,o,i,a);return a.delete(t),p;case Le:if(Ve)return Ve.call(t)==Ve.call(e)}return!1};var Qe=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t};var qe=function(t,e,r){var n=e(t);return st(t)?n:Qe(n,r(t))};var Ke=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i};var $e=function(){return[]},Xe=Object.prototype.propertyIsEnumerable,Ze=Object.getOwnPropertySymbols,Je=Ze?function(t){return null==t?[]:(t=Object(t),Ke(Ze(t),function(e){return Xe.call(t,e)}))}:$e;var tr=function(t){return qe(t,Dt,Je)},er=1,rr=Object.prototype.hasOwnProperty;var nr=function(t,e,r,n,o,i){var a=r&er,s=tr(t),c=s.length;if(c!=tr(e).length&&!a)return!1;for(var u=c;u--;){var p=s[u];if(!(a?p in e:rr.call(e,p)))return!1}var l=i.get(t),f=i.get(e);if(l&&f)return l==e&&f==t;var _=!0;i.set(t,e),i.set(e,t);for(var d=a;++u<c;){var m=t[p=s[u]],h=e[p];if(n)var y=a?n(h,m,p,e,t,i):n(m,h,p,t,e,i);if(!(void 0===y?m===h||o(m,h,r,n,i):y)){_=!1;break}d||(d="constructor"==p)}if(_&&!d){var b=t.constructor,v=e.constructor;b!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof v&&v instanceof v)&&(_=!1)}return i.delete(t),i.delete(e),_},or=K(h,"DataView"),ir=K(h,"Promise"),ar=K(h,"Set"),sr=K(h,"WeakMap"),cr=N(or),ur=N(Yt),pr=N(ir),lr=N(ar),fr=N(sr),_r=S;(or&&"[object DataView]"!=_r(new or(new ArrayBuffer(1)))||Yt&&"[object Map]"!=_r(new Yt)||ir&&"[object Promise]"!=_r(ir.resolve())||ar&&"[object Set]"!=_r(new ar)||sr&&"[object WeakMap]"!=_r(new sr))&&(_r=function(t){var e=S(t),r="[object Object]"==e?t.constructor:void 0,n=r?N(r):"";if(n)switch(n){case cr:return"[object DataView]";case ur:return"[object Map]";case pr:return"[object Promise]";case lr:return"[object Set]";case fr:return"[object WeakMap]"}return e});var dr=_r,mr=1,hr="[object Arguments]",yr="[object Array]",br="[object Object]",vr=Object.prototype.hasOwnProperty;var gr=function(t,e,r,n,o,i){var a=st(t),s=st(e),c=a?yr:dr(t),u=s?yr:dr(e),p=(c=c==hr?br:c)==br,l=(u=u==hr?br:u)==br,f=c==u;if(f&&ut(t)){if(!ut(e))return!1;a=!0,p=!1}if(f&&!p)return i||(i=new ye),a||gt(t)?je(t,e,r,n,o,i):Ye(t,e,c,r,n,o,i);if(!(r&mr)){var _=p&&vr.call(t,"__wrapped__"),d=l&&vr.call(e,"__wrapped__");if(_||d){var m=_?t.value():t,h=d?e.value():e;return i||(i=new ye),o(m,h,r,n,i)}}return!!f&&(i||(i=new ye),nr(t,e,r,n,o,i))};var Ar=function t(e,r,n,o,i){return e===r||(null==e||null==r||!tt(e)&&!tt(r)?e!=e&&r!=r:gr(e,r,n,o,t,i))},wr=1,xr=2;var Er=function(t,e,r,n){var o=r.length,i=o,a=!n;if(null==t)return!i;for(t=Object(t);o--;){var s=r[o];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<i;){var c=(s=r[o])[0],u=t[c],p=s[1];if(a&&s[2]){if(void 0===u&&!(c in t))return!1}else{var l=new ye;if(n)var f=n(u,p,c,t,e,l);if(!(void 0===f?Ar(p,u,wr|xr,n,l):f))return!1}}return!0};var Or=function(t){return t==t&&!C(t)};var Tr=function(t){for(var e=Dt(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Or(o)]}return e};var jr=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}};var Sr=function(t){var e=Tr(t);return 1==e.length&&e[0][2]?jr(e[0][0],e[0][1]):function(r){return r===t||Er(r,t,e)}},Cr="[object Symbol]";var Dr=function(t){return"symbol"==typeof t||tt(t)&&S(t)==Cr},Ir=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pr=/^\w*$/;var Mr=function(t,e){if(st(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!Dr(t))||Pr.test(t)||!Ir.test(t)||null!=e&&t in Object(e)},Fr="Expected a function";function kr(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Fr);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(kr.Cache||_e),r}kr.Cache=_e;var Rr=kr,Br=500;var zr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gr=/\\(\\)?/g,Nr=function(t){var e=Rr(t,function(t){return r.size===Br&&r.clear(),t}),r=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(zr,function(t,r,n,o){e.push(n?o.replace(Gr,"$1"):r||t)}),e});var Lr=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},Ur=1/0,Wr=y?y.prototype:void 0,Hr=Wr?Wr.toString:void 0;var Vr=function t(e){if("string"==typeof e)return e;if(st(e))return Lr(e,t)+"";if(Dr(e))return Hr?Hr.call(e):"";var r=e+"";return"0"==r&&1/e==-Ur?"-0":r};var Yr=function(t){return null==t?"":Vr(t)};var Qr=function(t,e){return st(t)?t:Mr(t,e)?[t]:Nr(Yr(t))},qr=1/0;var Kr=function(t){if("string"==typeof t||Dr(t))return t;var e=t+"";return"0"==e&&1/t==-qr?"-0":e};var $r=function(t,e){for(var r=0,n=(e=Qr(e,t)).length;null!=t&&r<n;)t=t[Kr(e[r++])];return r&&r==n?t:void 0};var Xr=function(t,e,r){var n=null==t?void 0:$r(t,e);return void 0===n?r:n};var Zr=function(t,e){return null!=t&&e in Object(t)};var Jr=function(t,e,r){for(var n=-1,o=(e=Qr(e,t)).length,i=!1;++n<o;){var a=Kr(e[n]);if(!(i=null!=t&&r(t,a)))break;t=t[a]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&dt(o)&&ft(a,o)&&(st(t)||at(t))};var tn=function(t,e){return null!=t&&Jr(t,e,Zr)},en=1,rn=2;var nn=function(t,e){return Mr(t)&&Or(e)?jr(Kr(t),e):function(r){var n=Xr(r,t);return void 0===n&&n===e?tn(r,t):Ar(e,n,en|rn)}};var on=function(t){return t};var an=function(t){return function(e){return null==e?void 0:e[t]}};var sn=function(t){return function(e){return $r(e,t)}};var cn=function(t){return Mr(t)?an(Kr(t)):sn(t)};var un=function(t){return"function"==typeof t?t:null==t?on:"object"==typeof t?st(t)?nn(t[0],t[1]):Sr(t):cn(t)};var pn=function(t,e){var r={};return e=un(e),It(t,function(t,n,o){X(r,n,e(t,n,o))}),r},ln=Object.prototype.hasOwnProperty;var fn=function(t,e,r){var n=t[e];ln.call(t,e)&&Mt(n,r)&&(void 0!==r||e in t)||X(t,e,r)};var _n=function(t,e,r,n){if(!C(t))return t;for(var o=-1,i=(e=Qr(e,t)).length,a=i-1,s=t;null!=s&&++o<i;){var c=Kr(e[o]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(o!=a){var p=s[c];void 0===(u=n?n(p,c,s):void 0)&&(u=C(p)?p:ft(e[o+1])?[]:{})}fn(s,c,u),s=s[c]}return t};var dn=function(t,e,r){for(var n=-1,o=e.length,i={};++n<o;){var a=e[n],s=$r(t,a);r(s,a)&&_n(i,Qr(a,t),s)}return i},mn=Ot(Object.getPrototypeOf,Object),hn=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Qe(e,Je(t)),t=mn(t);return e}:$e;var yn=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},bn=Object.prototype.hasOwnProperty;var vn=function(t){if(!C(t))return yn(t);var e=Et(t),r=[];for(var n in t)("constructor"!=n||!e&&bn.call(t,n))&&r.push(n);return r};var gn=function(t){return Ct(t)?wt(t,!0):vn(t)};var An=function(t){return qe(t,gn,hn)};var wn=function(t,e){if(null==t)return{};var r=Lr(An(t),function(t){return[t]});return e=un(e),dn(t,r,function(t,r){return e(t,r[0])})},xn="undefined"!=typeof Float32Array?Float32Array:Array;function En(){var t=new xn(16);return xn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function On(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Tn(t,e){var r=e[0],n=e[1],o=e[2],i=e[3],a=e[4],s=e[5],c=e[6],u=e[7],p=e[8],l=e[9],f=e[10],_=e[11],d=e[12],m=e[13],h=e[14],y=e[15],b=r*s-n*a,v=r*c-o*a,g=r*u-i*a,A=n*c-o*s,w=n*u-i*s,x=o*u-i*c,E=p*m-l*d,O=p*h-f*d,T=p*y-_*d,j=l*h-f*m,S=l*y-_*m,C=f*y-_*h,D=b*C-v*S+g*j+A*T-w*O+x*E;return D?(D=1/D,t[0]=(s*C-c*S+u*j)*D,t[1]=(o*S-n*C-i*j)*D,t[2]=(m*x-h*w+y*A)*D,t[3]=(f*w-l*x-_*A)*D,t[4]=(c*T-a*C-u*O)*D,t[5]=(r*C-o*T+i*O)*D,t[6]=(h*g-d*x-y*v)*D,t[7]=(p*x-f*g+_*v)*D,t[8]=(a*S-s*T+u*E)*D,t[9]=(n*T-r*S-i*E)*D,t[10]=(d*w-m*g+y*b)*D,t[11]=(l*g-p*w-_*b)*D,t[12]=(s*O-a*j-c*E)*D,t[13]=(r*j-n*O+o*E)*D,t[14]=(m*v-d*A-h*b)*D,t[15]=(p*A-l*v+f*b)*D,t):null}function jn(t,e,r){var n=e[0],o=e[1],i=e[2],a=e[3],s=e[4],c=e[5],u=e[6],p=e[7],l=e[8],f=e[9],_=e[10],d=e[11],m=e[12],h=e[13],y=e[14],b=e[15],v=r[0],g=r[1],A=r[2],w=r[3];return t[0]=v*n+g*s+A*l+w*m,t[1]=v*o+g*c+A*f+w*h,t[2]=v*i+g*u+A*_+w*y,t[3]=v*a+g*p+A*d+w*b,v=r[4],g=r[5],A=r[6],w=r[7],t[4]=v*n+g*s+A*l+w*m,t[5]=v*o+g*c+A*f+w*h,t[6]=v*i+g*u+A*_+w*y,t[7]=v*a+g*p+A*d+w*b,v=r[8],g=r[9],A=r[10],w=r[11],t[8]=v*n+g*s+A*l+w*m,t[9]=v*o+g*c+A*f+w*h,t[10]=v*i+g*u+A*_+w*y,t[11]=v*a+g*p+A*d+w*b,v=r[12],g=r[13],A=r[14],w=r[15],t[12]=v*n+g*s+A*l+w*m,t[13]=v*o+g*c+A*f+w*h,t[14]=v*i+g*u+A*_+w*y,t[15]=v*a+g*p+A*d+w*b,t}function Sn(t,e,r){var n=r[0],o=r[1],i=r[2],a=void 0,s=void 0,c=void 0,u=void 0,p=void 0,l=void 0,f=void 0,_=void 0,d=void 0,m=void 0,h=void 0,y=void 0;return e===t?(t[12]=e[0]*n+e[4]*o+e[8]*i+e[12],t[13]=e[1]*n+e[5]*o+e[9]*i+e[13],t[14]=e[2]*n+e[6]*o+e[10]*i+e[14],t[15]=e[3]*n+e[7]*o+e[11]*i+e[15]):(a=e[0],s=e[1],c=e[2],u=e[3],p=e[4],l=e[5],f=e[6],_=e[7],d=e[8],m=e[9],h=e[10],y=e[11],t[0]=a,t[1]=s,t[2]=c,t[3]=u,t[4]=p,t[5]=l,t[6]=f,t[7]=_,t[8]=d,t[9]=m,t[10]=h,t[11]=y,t[12]=a*n+p*o+d*i+e[12],t[13]=s*n+l*o+m*i+e[13],t[14]=c*n+f*o+h*i+e[14],t[15]=u*n+_*o+y*i+e[15]),t}function Cn(t,e,r){var n=Math.sin(r),o=Math.cos(r),i=e[4],a=e[5],s=e[6],c=e[7],u=e[8],p=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*o+u*n,t[5]=a*o+p*n,t[6]=s*o+l*n,t[7]=c*o+f*n,t[8]=u*o-i*n,t[9]=p*o-a*n,t[10]=l*o-s*n,t[11]=f*o-c*n,t}function Dn(t,e,r){var n=Math.sin(r),o=Math.cos(r),i=e[0],a=e[1],s=e[2],c=e[3],u=e[8],p=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o-u*n,t[1]=a*o-p*n,t[2]=s*o-l*n,t[3]=c*o-f*n,t[8]=i*n+u*o,t[9]=a*n+p*o,t[10]=s*n+l*o,t[11]=c*n+f*o,t}function In(t,e,r,n){var o=e[0],i=e[1],a=e[2],s=e[3],c=o+o,u=i+i,p=a+a,l=o*c,f=o*u,_=o*p,d=i*u,m=i*p,h=a*p,y=s*c,b=s*u,v=s*p,g=n[0],A=n[1],w=n[2];return t[0]=(1-(d+h))*g,t[1]=(f+v)*g,t[2]=(_-b)*g,t[3]=0,t[4]=(f-v)*A,t[5]=(1-(l+h))*A,t[6]=(m+y)*A,t[7]=0,t[8]=(_+b)*w,t[9]=(m-y)*w,t[10]=(1-(l+d))*w,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Pn(t,e){var r=e[0],n=e[1],o=e[2],i=e[3],a=r+r,s=n+n,c=o+o,u=r*a,p=n*a,l=n*s,f=o*a,_=o*s,d=o*c,m=i*a,h=i*s,y=i*c;return t[0]=1-l-d,t[1]=p+y,t[2]=f-h,t[3]=0,t[4]=p-y,t[5]=1-u-d,t[6]=_+m,t[7]=0,t[8]=f+h,t[9]=_-m,t[10]=1-u-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}var Mn=jn;function Fn(){var t=new xn(3);return xn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function kn(t,e,r){var n=new xn(3);return n[0]=t,n[1]=e,n[2]=r,n}function Rn(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Bn(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function zn(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function Gn(t,e){var r=e[0]-t[0],n=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(r*r+n*n+o*o)}function Nn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ln(t,e){var r=e[0],n=e[1],o=e[2],i=r*r+n*n+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t}function Un(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Wn(t,e,r){var n=e[0],o=e[1],i=e[2],a=r[0],s=r[1],c=r[2];return t[0]=o*c-i*s,t[1]=i*a-n*c,t[2]=n*s-o*a,t}function Hn(t,e,r){var n=e[0],o=e[1],i=e[2],a=r[3]*n+r[7]*o+r[11]*i+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*o+r[8]*i+r[12])/a,t[1]=(r[1]*n+r[5]*o+r[9]*i+r[13])/a,t[2]=(r[2]*n+r[6]*o+r[10]*i+r[14])/a,t}function Vn(t,e,r){var n=r[0],o=r[1],i=r[2],a=r[3],s=e[0],c=e[1],u=e[2],p=o*u-i*c,l=i*s-n*u,f=n*c-o*s,_=o*f-i*l,d=i*p-n*f,m=n*l-o*p,h=2*a;return p*=h,l*=h,f*=h,_*=2,d*=2,m*=2,t[0]=s+p+_,t[1]=c+l+d,t[2]=u+f+m,t}var Yn=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)};function Qn(){var t=new xn(4);return xn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function qn(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function Kn(t,e,r){r*=.5;var n=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(r),c=Math.cos(r);return t[0]=n*c-i*s,t[1]=o*c+a*s,t[2]=i*c+n*s,t[3]=a*c-o*s,t}function $n(t,e){var r=e[0],n=e[1],o=e[2],i=e[3],a=r*r+n*n+o*o+i*i,s=a?1/a:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-o*s,t[3]=i*s,t}Fn(),function(){var t,e=(t=new xn(4),xn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();var Xn,Zn,Jn,to,eo=function(t,e){var r=e[0],n=e[1],o=e[2],i=e[3],a=r*r+n*n+o*o+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=o*a,t[3]=i*a),t},ro=(Xn=Fn(),Zn=kn(1,0,0),Jn=kn(0,1,0),function(t,e,r){var n=Un(e,r);return n<-.999999?(Wn(Xn,Zn,e),Yn(Xn)<1e-6&&Wn(Xn,Jn,e),Ln(Xn,Xn),qn(t,Xn,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Wn(Xn,e,r),t[0]=Xn[0],t[1]=Xn[1],t[2]=Xn[2],t[3]=1+n,eo(t,t))});Qn(),Qn(),to=new xn(9),xn!=Float32Array&&(to[1]=0,to[2]=0,to[3]=0,to[5]=0,to[6]=0,to[7]=0),to[0]=1,to[4]=1,to[8]=1,function(){var t,e=(t=new xn(2),xn!=Float32Array&&(t[0]=0,t[1]=0),t)}();class no{constructor(t,e){l(this,"left",void 0),l(this,"right",void 0),l(this,"top",void 0),l(this,"bottom",void 0),l(this,"width",void 0),l(this,"height",void 0),this.left=t,this.top=e,this.right=-t,this.bottom=-e,this.width=2*Math.abs(t),this.height=2*Math.abs(e)}}function oo(t,e,r){const n=e/r,o=Math.abs(t);return new no(-o/2*n,o/2)}const io=0,ao=1,so=[0,0,0,0];var co=_(function(t,e){function r(t,e){return t===e}function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=null,o=null;return function(){return function(t,e,r){if(null===e||null===r||e.length!==r.length)return!1;for(var n=e.length,o=0;o<n;o++)if(!t(e[o],r[o]))return!1;return!0}(e,n,arguments)||(o=t.apply(null,arguments)),n=arguments,o}}function o(t){for(var e=arguments.length,r=Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return function(){for(var e=arguments.length,o=Array(e),i=0;i<e;i++)o[i]=arguments[i];var a=0,s=o.pop(),c=function(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every(function(t){return"function"==typeof t})){var r=e.map(function(t){return typeof t}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return e}(o),u=t.apply(void 0,[function(){return a++,s.apply(null,arguments)}].concat(r)),p=n(function(){for(var t=[],e=c.length,r=0;r<e;r++)t.push(c[r].apply(null,arguments));return u.apply(null,t)});return p.resultFunc=s,p.recomputations=function(){return a},p.resetRecomputations=function(){return a=0},p}}e.__esModule=!0,e.defaultMemoize=n,e.createSelectorCreator=o,e.createStructuredSelector=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if("object"!=typeof t)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof t);var r=Object.keys(t);return e(r.map(function(e){return t[e]}),function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e,n){return t[r[n]]=e,t},{})})};var i=e.createSelector=o(n)});!function(t){t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")&&t.default}(co),co.defaultMemoize,co.createSelectorCreator,co.createStructuredSelector;var uo=co.createSelector;function po(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function lo(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?po(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):po(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}const fo="\n  uniform vec3 _position;\n  uniform vec4 _rotation;\n\n  // rotate a 3d point v by a rotation quaternion q\n  vec3 rotate(vec3 v, vec4 q) {\n    vec3 temp = cross(q.xyz, v) + q.w * v;\n    return v + (2.0 * cross(q.xyz, temp));\n  }\n\n  vec3 applyPose(vec3 point) {\n    // rotate the point and then add the position of the pose\n    return rotate(point, _rotation) + _position;\n  }\n",_o={r:1,g:1,b:1,a:1},mo=({x:t,y:e,z:r})=>[t,e,r],ho=({x:t,y:e,z:r,w:n})=>[t,e,r,n],yo=([t,e,r])=>({x:t,y:e,z:r}),bo=([t,e,r,n])=>({x:t,y:e,z:r,w:n}),vo=t=>{const e=new Float32Array(3*t.length);let r=0;for(const{x:n,y:o,z:i}of t)e[r++]=n,e[r++]=o,e[r++]=i;return e},go=t=>[t.r,t.g,t.b,t.a],Ao=t=>({r:t[0],g:t[1],b:t[2],a:t[3]}),wo=t=>Array.isArray(t)?Ao(t):t;function xo(t=_o){const{r:e,g:r,b:n,a:o}=t;return`rgba(${(255*e).toFixed()}, ${(255*r).toFixed()}, ${(255*n).toFixed()}, ${o.toFixed(3)})`}const Eo=t=>{const e=new Float32Array(4*t.length);let r=0;for(const{r:n,g:o,b:i,a:a}of t)e[r++]=n,e[r++]=o,e[r++]=i,e[r++]=a;return e},Oo=(t,{r:e,g:r,b:n,a:o})=>{const i=new Float32Array(4*t);for(let a=0;a<t;a++)i[4*a+0]=e,i[4*a+1]=r,i[4*a+2]=n,i[4*a+3]=o;return i},To={enable:!0,func:{src:"src alpha",dst:"one minus src alpha",srcAlpha:1,dstAlpha:"one minus src alpha"},equation:{rgb:"add",alpha:"add"}},jo={enable:!0,mask:!0},So={enable:(t,e)=>e.depth&&e.depth.enable||jo.enable,mask:(t,e)=>e.depth&&e.depth.mask||jo.mask},Co=lo(lo({},To),{},{enable:(t,e)=>e.blend&&e.blend.enable||To.enable,func:(t,e)=>e.blend&&e.blend.func||To.func}),Do=Co;function Io(t){const{vert:e,uniforms:r}=t,n="function"==typeof e?(t,r)=>e(t,r).replace("#WITH_POSE",fo):e.replace("#WITH_POSE",fo),o=lo(lo({},r),{},{_position:(t,e)=>{const{position:r}=e.pose;return Array.isArray(r)?r:mo(r)},_rotation:(t,e)=>{const{orientation:r}=e.pose;return Array.isArray(r)?r:[r.x,r.y,r.z,r.w]}});return lo(lo({},t),{},{vert:n,uniforms:o})}function Po({colors:t,color:e,points:r}){return t&&t.length||!e?t?Fo(t)?Eo(t):t:[]:Oo(r.length,e)}function Mo(t){const e=t.buffer({usage:"dynamic",data:[]});return function(t,r,n){let o,i;return r&&r.length?(o=Fo(r)?Eo(r):r,i=1):(o=Fo(t)?go(t):t,i=n),{buffer:e({usage:"dynamic",data:o}),divisor:i}}}function Fo(t){return!(!t||(e=t,e.length&&Array.isArray(e[0]))||!isNaN(t[0]));var e}function ko(t=0){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255,1]}function Ro(t){const e=t[0],r=t[1];return t[2]|r<<8|e<<16}function Bo(t,e,r,n){const o=e*Math.sin(n);return t[0]=o*Math.sin(r),t[1]=e*Math.cos(n),t[2]=o*Math.cos(r),t}const zo=Object.freeze([1,0,0]),Go=[0,0,0],No=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Lo=[0,0,0,0],Uo=t=>t,Wo=uo(Uo,({perspective:t})=>t),Ho=uo(Uo,({distance:t})=>t),Vo=uo(Uo,({phi:t})=>t),Yo=uo(Uo,({thetaOffset:t})=>t),Qo=uo(Uo,({targetOrientation:t})=>t),qo=uo(Qo,t=>{const e=Vn(Go,zo,t);return-Math.atan2(e[1],e[0])}),Ko=uo(Wo,Vo,Yo,(t,e,r)=>{const n=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}([0,0,0,0]);return function(t,e,r){r*=.5;var n=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(r),c=Math.cos(r);t[0]=n*c+o*s,t[1]=o*c-n*s,t[2]=i*c+a*s,t[3]=a*c-i*s}(n,n,-r),t&&function(t,e,r){r*=.5;var n=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(r),c=Math.cos(r);t[0]=n*c+a*s,t[1]=o*c+i*s,t[2]=i*c-o*s,t[3]=a*c-n*s}(n,n,e),n}),$o=uo(Yo,Vo,Ho,(t,e,r)=>{const n=Bo([],r,t,e),[o,i,a]=n;return n[0]=-o,n[1]=-a,n[2]=i,n});var Xo={orientation:Ko,position:$o,targetHeading:qo,view:uo(Uo,Ko,$o,({target:t,targetOffset:e,targetOrientation:r,perspective:n},o,i)=>{const a=On([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return jn(a,a,Pn(No,$n(Lo,o))),n&&Sn(a,a,Nn(Go,i)),Sn(a,a,Nn(Go,e)),jn(a,a,Pn(No,r)),Sn(a,a,Nn(Go,t)),n||(Go[0]=0,Go[1]=0,Go[2]=-2500,Hn(Go,Go,Pn(No,$n(Lo,r))),Sn(a,a,Go)),a}),billboardRotation:uo(Ko,qo,(t,e)=>{const r=On(En());return function(t,e,r){var n=Math.sin(r),o=Math.cos(r),i=e[0],a=e[1],s=e[2],c=e[3],u=e[4],p=e[5],l=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o+u*n,t[1]=a*o+p*n,t[2]=s*o+l*n,t[3]=c*o+f*n,t[4]=u*o-i*n,t[5]=p*o-a*n,t[6]=l*o-s*n,t[7]=f*o-c*n}(r,r,-e),jn(r,r,Pn(No,t)),r})};function Zo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function Jo(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Zo(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zo(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}const ti=Object.freeze([0,0,1]),ei=[0,0,0,0],ri={distance:75,perspective:!0,phi:Math.PI/4,target:[0,0,0],targetOffset:[0,0,0],targetOrientation:[0,0,0,1],thetaOffset:0,fovy:Math.PI/4,near:.01,far:5e3};class ni{constructor(t=(()=>{}),e=ri){l(this,"state",void 0),l(this,"_onChange",void 0),l(this,"setCameraState",t=>{for(const[e,r]of Object.entries(ri))null==t[e]&&(t[e]=r);this.state=t}),l(this,"cameraRotate",([t,e])=>{if(0===t&&0===e)return;const{thetaOffset:r,phi:n}=this.state;this.setCameraState(Jo(Jo({},this.state),{},{thetaOffset:r-t,phi:Math.max(0,Math.min(n+e,Math.PI))})),this._onChange(this.state)}),l(this,"cameraMove",([t,e])=>{if(0===t&&0===e)return;const{targetOffset:r,thetaOffset:n}=this.state,o=[t,e,0],i=Vn(o,o,qn(ei,ti,-n));this.setCameraState(Jo(Jo({},this.state),{},{targetOffset:Rn(i,r,i)})),this._onChange(this.state)}),l(this,"cameraZoom",t=>{const{distance:e}=this.state,r=function(t,e){return Math.max(.001,t*(1-e/100))}(e,t);e!==r&&(this.setCameraState(Jo(Jo({},this.state),{},{distance:r})),this._onChange(this.state))}),this._onChange=t,this.setCameraState(e)}}const oi=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var ii,ai,si,ci,ui,pi,li,fi,_i,di,mi,hi,yi,bi,vi,gi=t=>{if(!t)throw new Error("Invalid regl instance");return class{constructor(){l(this,"viewportWidth",0),l(this,"viewportHeight",0),l(this,"cameraState",ri),l(this,"draw",t({context:{projection(t,e){const{viewportWidth:r,viewportHeight:n}=t;return this.viewportWidth=r,this.viewportHeight=n,this.cameraState=e,this.getProjection()},view(t,e){return this.getView()},billboardRotation(t,e){return Xo.billboardRotation(this.cameraState)},isPerspective(t,e){return this.cameraState.perspective},fovy(t,e){return this.cameraState.fovy}},uniforms:{view:t.context("view"),billboardRotation:t.context("billboardRotation"),projection:t.context("projection")}}))}getProjection(){const{near:t,far:e,distance:r,fovy:n}=this.cameraState;if(!this.cameraState.perspective){const n=oo(r,this.viewportWidth,this.viewportHeight),{left:o,right:i,bottom:a,top:s}=n;return function(t,e,r,n,o,i,a){var s=1/(e-r),c=1/(n-o),u=1/(i-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(o+n)*c,t[14]=(a+i)*u,t[15]=1,t}([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o,i,a,s,t,e)}return function(t,e,r,n,o){var i=1/Math.tan(e/2),a=void 0;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(a=1/(n-o),t[10]=(o+n)*a,t[14]=2*o*n*a):(t[10]=-1,t[14]=-2*n),t}([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n,this.viewportWidth/this.viewportHeight,t,e)}getView(){return Xo.view(this.cameraState)}toScreenCoord(t,e){const r=this.getProjection(),n=Xo.view(this.cameraState),o=jn(oi,r,n),[i,a,s,c]=function(t,e,r,n){const o=r[0],i=r[1],a=r[2],s=r[3],c=io,u=ao;!function(t,e,r,n,o){t[0]=e,t[1]=r,t[2]=n,t[3]=o}(so,e[0],e[1],e[2],1),function(t,e,r){var n=e[0],o=e[1],i=e[2],a=e[3];t[0]=r[0]*n+r[4]*o+r[8]*i+r[12]*a,t[1]=r[1]*n+r[5]*o+r[9]*i+r[13]*a,t[2]=r[2]*n+r[6]*o+r[10]*i+r[14]*a,t[3]=r[3]*n+r[7]*o+r[11]*i+r[15]*a}(so,so,n);const p=so[3];return 0!==p&&(so[0]=so[0]/p,so[1]=so[1]/p,so[2]=so[2]/p),t[0]=o+a/2*so[0]+(0+a/2),t[1]=i+s/2*so[1]+(0+s/2),t[2]=(u-c)/2*so[2]+(u+c)/2,t[3]=0===p?0:1/p,t}([],e,t,o);if(s<0||s>1||c<0)return;const u=t[3]+t[1];return[i-t[0],u-a,s]}}},Ai=!1;function wi(){if(!Ai){Ai=!0;var t=navigator.userAgent,e=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),r=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(hi=/\b(iPhone|iP[ao]d)/.exec(t),yi=/\b(iP[ao]d)/.exec(t),di=/Android/i.exec(t),bi=/FBAN\/\w+;/i.exec(t),vi=/Mobile/i.exec(t),mi=!!/Win64/.exec(t),e){(ii=e[1]?parseFloat(e[1]):e[5]?parseFloat(e[5]):NaN)&&document&&document.documentMode&&(ii=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(t);pi=n?parseFloat(n[1])+4:ii,ai=e[2]?parseFloat(e[2]):NaN,si=e[3]?parseFloat(e[3]):NaN,(ci=e[4]?parseFloat(e[4]):NaN)?(e=/(?:Chrome\/(\d+\.\d+))/.exec(t),ui=e&&e[1]?parseFloat(e[1]):NaN):ui=NaN}else ii=ai=si=ui=ci=NaN;if(r){if(r[1]){var o=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);li=!o||parseFloat(o[1].replace("_","."))}else li=!1;fi=!!r[2],_i=!!r[3]}else li=fi=_i=!1}}var xi,Ei={ie:function(){return wi()||ii},ieCompatibilityMode:function(){return wi()||pi>ii},ie64:function(){return Ei.ie()&&mi},firefox:function(){return wi()||ai},opera:function(){return wi()||si},webkit:function(){return wi()||ci},safari:function(){return Ei.webkit()},chrome:function(){return wi()||ui},windows:function(){return wi()||fi},osx:function(){return wi()||li},linux:function(){return wi()||_i},iphone:function(){return wi()||hi},mobile:function(){return wi()||hi||yi||di||vi},nativeApp:function(){return wi()||bi},android:function(){return wi()||di},ipad:function(){return wi()||yi}},Oi=Ei,Ti=!("undefined"==typeof window||!window.document||!window.document.createElement),ji={canUseDOM:Ti,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:Ti&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:Ti&&!!window.screen,isInWorker:!Ti};ji.canUseDOM&&(xi=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var Si=function(t,e){if(!ji.canUseDOM||e&&!("addEventListener"in document))return!1;var r="on"+t,n=r in document;if(!n){var o=document.createElement("div");o.setAttribute(r,"return;"),n="function"==typeof o[r]}return!n&&xi&&"wheel"===t&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n},Ci=10,Di=40,Ii=800;function Pi(t){var e=0,r=0,n=0,o=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=r,r=0),n=e*Ci,o=r*Ci,"deltaY"in t&&(o=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||o)&&t.deltaMode&&(1==t.deltaMode?(n*=Di,o*=Di):(n*=Ii,o*=Ii)),n&&!e&&(e=n<1?-1:1),o&&!r&&(r=o<1?-1:1),{spinX:e,spinY:r,pixelX:n,pixelY:o}}Pi.getEventType=function(){return Oi.firefox()?"DOMMouseScroll":Si("wheel")?"wheel":"mousewheel"};var Mi=Pi;const Fi=4,ki=.3,Ri=.3,Bi=150,zi=1.5,Gi={KeyA:"moveLeft",KeyD:"moveRight",KeyE:"rotateRight",KeyF:"tiltUp",KeyQ:"rotateLeft",KeyR:"tiltDown",KeyS:"moveDown",KeyW:"moveUp",KeyX:"zoomOut",KeyZ:"zoomIn"};class Ni extends a.Component{constructor(...t){super(...t),l(this,"_keyTimer",void 0),l(this,"_keys",new Set),l(this,"_buttons",new Set),l(this,"_listeners",[]),l(this,"_shiftKey",!1),l(this,"_metaKey",!1),l(this,"_ctrlKey",!1),l(this,"_el",void 0),l(this,"_rect",void 0),l(this,"_initialMouse",void 0),l(this,"_getMouseOnScreen",t=>{const{clientX:e,clientY:r}=t,{top:n,left:o,width:i,height:a}=this._rect;return[(e-o)/i,(r-n)/a]}),l(this,"_onMouseDown",t=>{const{_el:e}=this;e&&(t.preventDefault(),this._buttons.add(t.button),e.focus(),this._rect=e.getBoundingClientRect(),this._initialMouse=this._getMouseOnScreen(t),this.startDragging(t))}),l(this,"_onWindowMouseMove",t=>{if(!this._buttons.size)return;this._shiftKey=t.shiftKey;const{cameraStore:{cameraMove:e,cameraRotate:r,state:{perspective:n}}}=this.props;let o,i;const a=this._getMouseOnScreen(t);if(document.pointerLockElement&&(t.movementX||t.movementY)?(o=-t.movementX/this._rect.width,i=-t.movementY/this._rect.height):(o=this._initialMouse[0]-a[0],i=this._initialMouse[1]-a[1]),this._initialMouse=a,this._isRightMouseDown()){const t=this._getMagnitude(Fi);r([(n?o:-o)*t,n?i*t:0])}if(this._isLeftMouseDown()){const{x:t,y:r}=this._getMoveMagnitude();e([this._getMagnitude(o*t),this._getMagnitude(-i*r)])}}),l(this,"_onMouseUp",t=>{this._buttons.delete(t.button),this._endDragging()}),l(this,"_onWindowMouseUp",t=>{const{_el:e}=this;e&&(e.contains(t.target)||t.target===e||(this._buttons.clear(),this._endDragging()))}),l(this,"_getKeyMotion",t=>{const e=this._getMagnitude(Ri),r=this._getMagnitude(Bi),n=this._getMagnitude(zi),{keyMap:o,shiftKeys:i}=this.props,a=o&&o[t]||Gi[t]||!1;if(this._shiftKey&&!i)return null;switch(a){case"moveRight":return{x:e};case"moveLeft":return{x:-e};case"moveUp":return{y:e};case"moveDown":return{y:-e};case"zoomIn":return{zoom:r};case"zoomOut":return{zoom:-r};case"rotateLeft":return{yaw:-n};case"rotateRight":return{yaw:n};case"tiltUp":return{tilt:-n};case"tiltDown":return{tilt:n};case!1:return null;default:return console.warn("Unrecognized key action:",a),null}}),l(this,"_onKeyDown",t=>{const{keyMap:e}=this.props;this._shiftKey=t.shiftKey,this._metaKey=t.metaKey,this._ctrlKey=t.ctrlKey;const r=t.nativeEvent.code;return t.repeat||this._keys.has(r)?(t.stopPropagation(),void t.preventDefault()):t.altKey||t.ctrlKey||t.metaKey?void 0:!(e&&r in e&&!e[r])&&void(this._getKeyMotion(r)&&(this._keys.add(r),this._startKeyTimer(),t.stopPropagation(),t.preventDefault()))}),l(this,"_onKeyUp",t=>{this._shiftKey=t.shiftKey,this._metaKey=t.metaKey,this._ctrlKey=t.ctrlKey,this._keys.delete(t.nativeEvent.code)}),l(this,"_onWheel",t=>{t.preventDefault(),t.stopPropagation(),this._shiftKey=t.shiftKey;const{pixelX:e,pixelY:r}=Mi(t),n=r||e,o=-1*Math.sign(n),i=Math.abs(n),a=Math.max(1,Math.min(i,50)),s=this._getMagnitude(a*o*ki);this.props.cameraStore.cameraZoom(s)}),l(this,"_onBlur",t=>{this._keys=new Set,this._ctrlKey=!1,this._shiftKey=!1,this._metaKey=!1,this._stopKeyTimer()}),l(this,"_onContextMenu",t=>{t.preventDefault(),t.stopPropagation()})}componentDidMount(){const{_el:t}=this;if(!t)return;this._rect=t.getBoundingClientRect();const e=(t,e,r)=>{t.addEventListener(e,r),this._listeners.push({target:t,name:e,fn:r})};e(document,"blur",this._onBlur),e(window,"mouseup",this._onWindowMouseUp),t.addEventListener("wheel",this._onWheel,{passive:!1})}componentWillUnmount(){this._listeners.forEach(t=>{t.target.removeEventListener(t.name,t.fn)}),this._endDragging();const{_el:t}=this;t&&t.removeEventListener("wheel",this._onWheel,{passive:!1})}focus(){this._el&&this._el.focus()}_isLeftMouseDown(){return this._buttons.has(0)}_isRightMouseDown(){return this._buttons.has(2)}_getMagnitude(t=1){return this._shiftKey?t/10:t}_getMoveMagnitude(){if(this._ctrlKey)return{x:0,y:0};const{cameraStore:{state:{distance:t,perspective:e}}}=this.props;if(e)return{x:t,y:t};const{width:r,height:n}=this._rect,o=oo(t,r,n);return{x:o.width,y:o.height}}startDragging(t){0!==t.button&&this._el&&"function"==typeof this._el.requestPointerLock&&this._el.requestPointerLock(),window.addEventListener("mousemove",this._onWindowMouseMove)}_endDragging(){window.removeEventListener("mousemove",this._onWindowMouseMove),"function"==typeof document.exitPointerLock&&document.exitPointerLock()}_moveKeyboard(t){const e={x:0,y:0,zoom:0,yaw:0,tilt:0};this._keys.forEach(t=>{const{x:r=0,y:n=0,zoom:o=0,yaw:i=0,tilt:a=0}=this._getKeyMotion(t)||{};e.x+=r,e.y+=n,e.zoom+=o,e.yaw+=i,e.tilt+=a});const{cameraStore:{cameraMove:r,cameraRotate:n,cameraZoom:o,state:{perspective:i}}}=this.props;if(e.x||e.y){const{x:n,y:o}=this._getMoveMagnitude();r([e.x*n*t,e.y*o*t])}(e.yaw||i&&e.tilt)&&n([e.yaw*t,i?e.tilt*t:0]),e.zoom&&o(e.zoom*t)}_startKeyTimer(t){this._keyTimer||(this._keyTimer=requestAnimationFrame(e=>{this._moveKeyboard((t?e-t:0)/1e3),this._keyTimer=void 0,this._keys.size&&this._startKeyTimer(e)}))}_stopKeyTimer(){this._keyTimer&&cancelAnimationFrame(this._keyTimer),this._keyTimer=void 0}render(){const{children:t}=this.props;return a.createElement("div",{tabIndex:0,style:{outline:"none"},draggable:!0,ref:t=>this._el=t,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onBlur:this._onBlur,onContextMenu:this._onContextMenu,onKeyDown:this._onKeyDown,onKeyUp:this._onKeyUp},t)}}function Li(){return process&&process.env&&"development"}const Ui=[0,0,0],Wi=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class Hi{constructor(t,e,r){l(this,"origin",void 0),l(this,"dir",void 0),l(this,"point",void 0),this.origin=t,this.dir=e,this.point=r}distanceToPoint(t){return Gn(this.origin,t)}planeIntersection(t,e){const r=Un(e,t),n=Un(e,this.dir);if(0===n)return null;const o=(r-Un(e,this.origin))/n;var i,a,s;return Rn([0,0,0],this.origin,(i=Ui,a=this.dir,s=o,i[0]=a[0]*s,i[1]=a[1]*s,i[2]=a[2]*s,i))}}function Vi(t,{clientX:e,clientY:r,width:n,height:o}){const i=t.getProjection(),a=t.getView(),s=jn(Wi,i,a),c=Hn([0,0,0],[2*e/n-1,-2*r/o+1,0],Tn(Wi,s)),u=Hn([0,0,0],[0,0,0],Tn(Wi,a)),p=Ln([0,0,0],Bn(Ui,c,u));return new Hi(u,p,c)}var Yi=s.default.createContext(void 0);class Qi extends a.Component{constructor(t){super(t),l(this,"context",void 0),"production"!==Li()&&(this.shouldComponentUpdate=(t=>(t.reglCommand!==this.props.reglCommand&&console.error("Changing the regl command prop on a <Command /> is not supported."),!0)))}componentDidMount(){const t=this.context;t&&(t.onMount(this,this.props.reglCommand),this._updateContext())}componentDidUpdate(){this._updateContext()}componentWillUnmount(){const t=this.context;t&&t.onUnmount(this)}_updateContext(){const t=this.context;if(!t)return;const{reglCommand:e,layerIndex:r,getChildrenForHitmap:n}=this.props,o=this.props.children||this.props.drawProps;null!=o&&t.registerDrawCall({instance:this,reglCommand:e,children:o,layerIndex:r,getChildrenForHitmap:n})}handleMouseEvent(t,e,r,n){const o=this.props[n];o&&t.length&&o(r,{ray:e,objects:t})}render(){return a.createElement(Yi.Consumer,null,t=>(t&&(this.context=t),null))}}l(Qi,"displayName","Command");const qi=(()=>global.postMessage&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope)()?class{constructor(t){l(this,"_callback",void 0),this._callback=t}observe(){this._callback([{contentRect:{width:150,height:150}}])}unobserve(){}}:ResizeObserver;function Ki({children:t}){const[r,n]=e.useState(void 0),[o,i]=e.useState(),[a]=e.useState(()=>new qi(t=>{if(!t||!t.length)return;const e=Math.round(t[0].contentRect.width),r=Math.round(t[0].contentRect.height),n=Math.round(t[0].contentRect.left),o=Math.round(t[0].contentRect.top);i({width:e,height:r,top:o,left:n})})),c=e.useCallback(t=>{t&&n(t.parentElement)},[]);return e.useEffect(()=>{if(r)return a.observe(r),()=>a.unobserve(r)},[r,a]),null==o?s.default.createElement("div",{ref:c}):t(o)}var $i=_(function(t,e){t.exports=function(){var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var r=Object.keys(e),n=0;n<r.length;++n)t[r[n]]=e[r[n]];return t},r="\n";function n(t){var e=new Error("(regl) "+t);throw console.error(e),e}function o(t,e){t||n(e)}function i(t){return t?": "+t:""}function a(t,e){switch(e){case"number":return"number"==typeof t;case"object":return"object"==typeof t;case"string":return"string"==typeof t;case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"undefined":return void 0===t;case"symbol":return"symbol"==typeof t}}function s(t,e,r){e.indexOf(t)<0&&n("invalid value"+i(r)+". must be one of: "+e)}var c=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function u(t,e){for(t+="";t.length<e;)t=" "+t;return t}function p(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function l(t,e){this.number=t,this.line=e,this.errors=[]}function f(t,e,r){this.file=t,this.line=e,this.message=r}function _(){var t=new Error,e=(t.stack||t).toString(),r=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(r)return r[1];var n=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return n?n[1]:"unknown"}function d(){var t=new Error,e=(t.stack||t).toString(),r=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(r)return r[1];var n=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return n?n[1]:"unknown"}function m(t,e){var r,n=t.split("\n"),o=1,i=0,a={unknown:new p,0:new p};a.unknown.name=a[0].name=e||_(),a.unknown.lines.push(new l(0,""));for(var s=0;s<n.length;++s){var c=n[s],u=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(c);if(u)switch(u[1]){case"line":var f=/(\d+)(\s+\d+)?/.exec(u[2]);f&&(o=0|f[1],f[2]&&((i=0|f[2])in a||(a[i]=new p)));break;case"define":var d=/SHADER_NAME(_B64)?\s+(.*)$/.exec(u[2]);d&&(a[i].name=d[1]?(r=d[2],"undefined"!=typeof atob?atob(r):"base64:"+r):d[2])}a[i].lines.push(new l(o++,c))}return Object.keys(a).forEach(function(t){var e=a[t];e.lines.forEach(function(t){e.index[t.number]=t})}),a}function h(t){t._commandRef=_()}function y(t,e){var r=d();n(t+" in command "+(e||_())+("unknown"===r?"":" called from "+r))}function b(t,e,r,n){a(t,e)||y("invalid parameter type"+i(r)+". expected "+e+", got "+typeof t,n||_())}var v=33071,g=9728,A=9984,w=9985,x=9986,E=9987,O=5126,T=32819,j=32820,S=33635,C=34042,D={};function I(t,e){return t===j||t===T||t===S?2:t===C?4:D[t]*e}function P(t){return!(t&t-1||!t)}D[5120]=D[5121]=1,D[5122]=D[5123]=D[36193]=D[S]=D[T]=D[j]=2,D[5124]=D[5125]=D[O]=D[C]=4;var M=e(o,{optional:function(t){t()},raise:n,commandRaise:y,command:function(t,e,r){t||y(e,r||_())},parameter:function(t,e,r){t in e||n("unknown parameter ("+t+")"+i(r)+". possible values: "+Object.keys(e).join())},commandParameter:function(t,e,r,n){t in e||y("unknown parameter ("+t+")"+i(r)+". possible values: "+Object.keys(e).join(),n||_())},constructor:function(t){Object.keys(t).forEach(function(t){c.indexOf(t)<0&&n('invalid regl constructor argument "'+t+'". must be one of '+c)})},type:function(t,e,r){a(t,e)||n("invalid parameter type"+i(r)+". expected "+e+", got "+typeof t)},commandType:b,isTypedArray:function(e,r){t(e)||n("invalid parameter type"+i(r)+". must be a typed array")},nni:function(t,e){t>=0&&(0|t)===t||n("invalid parameter type, ("+t+")"+i(e)+". must be a nonnegative integer")},oneOf:s,shaderError:function(t,e,n,i,a){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var s=t.getShaderInfoLog(e),c=i===t.FRAGMENT_SHADER?"fragment":"vertex";b(n,"string",c+" shader source must be a string",a);var p=m(n,a),l=function(t){var e=[];return t.split("\n").forEach(function(t){if(!(t.length<5)){var r=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);r?e.push(new f(0|r[1],0|r[2],r[3].trim())):t.length>0&&e.push(new f("unknown",0,t))}}),e}(s);!function(t,e){e.forEach(function(e){var r=t[e.file];if(r){var n=r.index[e.line];if(n)return n.errors.push(e),void(r.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)})}(p,l),Object.keys(p).forEach(function(t){var e=p[t];if(e.hasErrors){var n=[""],o=[""];i("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach(function(t){if(t.errors.length>0){i(u(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),i(t.line+r,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach(function(n){var o=n.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(o);if(a){var s=a[1];switch(o=a[2],s){case"assign":s="="}e=Math.max(t.line.indexOf(s,e),0)}else e=0;i(u("| ",6)),i(u("^^^",e+3)+r,"font-weight:bold"),i(u("| ",6)),i(o+r,"font-weight:bold")}),i(u("| ",6)+r)}else i(u(t.number,4)+"|  "),i(t.line+r,"color:red")}),"undefined"==typeof document||window.chrome?console.log(n.join("")):(o[0]=n.join("%c"),console.log.apply(console,o))}function i(t,e){n.push(t),o.push(e||"")}}),o.raise("Error compiling "+c+" shader, "+p[0].name)}},linkError:function(t,e,n,i,a){if(!t.getProgramParameter(e,t.LINK_STATUS)){var s=t.getProgramInfoLog(e),c=m(n,a),u=m(i,a),p='Error linking program with vertex shader, "'+u[0].name+'", and fragment shader "'+c[0].name+'"';"undefined"!=typeof document?console.log("%c"+p+r+"%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(p+r+s),o.raise(p)}},callSite:d,saveCommandRef:h,saveDrawInfo:function(t,e,r,n){function o(t){return t?n.id(t):0}function i(t,e){Object.keys(e).forEach(function(e){t[n.id(e)]=!0})}h(t),t._fragId=o(t.static.frag),t._vertId=o(t.static.vert);var a=t._uniformSet={};i(a,e.static),i(a,e.dynamic);var s=t._attributeSet={};i(s,r.static),i(s,r.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic},framebufferFormat:function(t,e,r){t.texture?s(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):s(t.renderbuffer._renderbuffer.format,r,"unsupported renderbuffer format for attachment")},guessCommand:_,texture2D:function(t,e,r){var n,i=e.width,a=e.height,s=e.channels;o(i>0&&i<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),(t.wrapS!==v||t.wrapT!==v)&&o(P(i)&&P(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==i&&1!==a&&o(t.minFilter!==A&&t.minFilter!==x&&t.minFilter!==w&&t.minFilter!==E,"min filter requires mipmap"):(o(P(i)&&P(a),"texture must be a square power of 2 to support mipmapping"),o(e.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),e.type===O&&(r.extensions.indexOf("oes_texture_float_linear")<0&&o(t.minFilter===g&&t.magFilter===g,"filter not supported, must enable oes_texture_float_linear"),o(!t.genMipmaps,"mipmap generation not supported with float textures"));var c=e.images;for(n=0;n<16;++n)if(c[n]){var u=i>>n,p=a>>n;o(e.mipmask&1<<n,"missing mipmap data");var l=c[n];if(o(l.width===u&&l.height===p,"invalid shape for mip images"),o(l.format===e.format&&l.internalformat===e.internalformat&&l.type===e.type,"incompatible type for mip image"),l.compressed);else if(l.data){var f=Math.ceil(I(l.type,s)*u/l.unpackAlignment)*l.unpackAlignment;o(l.data.byteLength===f*p,"invalid data for image, buffer size is inconsistent with image format")}else l.element||l.copy}else t.genMipmaps||o(0==(e.mipmask&1<<n),"extra mipmap data");e.compressed&&o(!t.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(t,e,r,n){var i=t.width,a=t.height,s=t.channels;o(i>0&&i<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),o(i===a,"cube map must be square"),o(e.wrapS===v&&e.wrapT===v,"wrap mode not supported by cube map");for(var c=0;c<r.length;++c){var u=r[c];o(u.width===i&&u.height===a,"inconsistent cube map face shape"),e.genMipmaps&&(o(!u.compressed,"can not generate mipmap for compressed textures"),o(1===u.mipmask,"can not specify mipmaps and generate mipmaps"));for(var p=u.images,l=0;l<16;++l){var f=p[l];if(f){var _=i>>l,d=a>>l;o(u.mipmask&1<<l,"missing mipmap data"),o(f.width===_&&f.height===d,"invalid shape for mip images"),o(f.format===t.format&&f.internalformat===t.internalformat&&f.type===t.type,"incompatible type for mip image"),f.compressed||(f.data?o(f.data.byteLength===_*d*Math.max(I(f.type,s),f.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):f.element||f.copy)}}}}}),F=0,k=0,R=5,B=6;function z(t,e){this.id=F++,this.type=t,this.data=e}function G(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function N(t){return"["+function t(e){if(0===e.length)return[];var r=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&r===n&&('"'===r||"'"===r))return['"'+G(e.substr(1,e.length-2))+'"'];var o=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(o)return t(e.substr(0,o.index)).concat(t(o[1])).concat(t(e.substr(o.index+o[0].length)));var i=e.split(".");if(1===i.length)return['"'+G(e)+'"'];for(var a=[],s=0;s<i.length;++s)a=a.concat(t(i[s]));return a}(t).join("][")+"]"}var L={DynamicVariable:z,define:function(t,e){return new z(t,N(e+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof z},unbox:function t(e,r){return"function"==typeof e?new z(k,e):"number"==typeof e||"boolean"==typeof e?new z(R,e):Array.isArray(e)?new z(B,e.map((e,n)=>t(e,r+"["+n+"]"))):e instanceof z?e:void M(!1,"invalid option type in uniform "+r)},accessor:N},U={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},W="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function H(t){return"string"==typeof t?t.split():(M(Array.isArray(t),"invalid extension array"),t)}function V(t){return"string"==typeof t?(M("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function Y(t){var r,n,o,i,a,s=t||{},c={},u=[],p=[],l="undefined"==typeof window?1:window.devicePixelRatio,f=!1,_=function(t){t&&M.raise(t)},d=function(){};if("string"==typeof s?(M("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),r=document.querySelector(s),M(r,"invalid query string for element")):"object"==typeof s?"string"==typeof(a=s).nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?r=s:function(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}(s)?o=(i=s).canvas:(M.constructor(s),"gl"in s?i=s.gl:"canvas"in s?o=V(s.canvas):"container"in s&&(n=V(s.container)),"attributes"in s&&(c=s.attributes,M.type(c,"object","invalid context attributes")),"extensions"in s&&(u=H(s.extensions)),"optionalExtensions"in s&&(p=H(s.optionalExtensions)),"onDone"in s&&(M.type(s.onDone,"function","invalid or missing onDone callback"),_=s.onDone),"profile"in s&&(f=!!s.profile),"pixelRatio"in s&&(l=+s.pixelRatio,M(l>0,"invalid pixel ratio"))):M.raise("invalid arguments to regl"),r&&("canvas"===r.nodeName.toLowerCase()?o=r:n=r),!i){if(!o){M("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var m=function(t,r,n){var o,i=document.createElement("canvas");function a(){var r=window.innerWidth,o=window.innerHeight;if(t!==document.body){var a=t.getBoundingClientRect();r=a.right-a.left,o=a.bottom-a.top}i.width=n*r,i.height=n*o,e(i.style,{width:r+"px",height:o+"px"})}return e(i.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(i),t===document.body&&(i.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(o=new ResizeObserver(function(){setTimeout(a)})).observe(t):window.addEventListener("resize",a,!1),a(),{canvas:i,onDestroy:function(){o?o.disconnect():window.removeEventListener("resize",a),t.removeChild(i)}}}(n||document.body,0,l);if(!m)return null;o=m.canvas,d=m.onDestroy}void 0===c.premultipliedAlpha&&(c.premultipliedAlpha=!0),i=function(t,e){function r(r){try{return t.getContext(r,e)}catch(t){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}(o,c)}return i?{gl:i,canvas:o,container:n,extensions:u,optionalExtensions:p,pixelRatio:l,profile:f,onDone:_,onDestroy:d}:(d(),_("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Q(t,e){for(var r=Array(t),n=0;n<t;++n)r[n]=e(n);return r}var q=5120,K=5121,$=5122,X=5123,Z=5124,J=5125,tt=5126;function et(t){var e,r;return e=(t>65535)<<4,e|=r=((t>>>=e)>255)<<3,e|=r=((t>>>=r)>15)<<2,(e|=r=((t>>>=r)>3)<<1)|(t>>>=r)>>1}function rt(){var t=Q(8,function(){return[]});function e(e){var r=function(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}(e),n=t[et(r)>>2];return n.length>0?n.pop():new ArrayBuffer(r)}function r(e){t[et(e.byteLength)>>2].push(e)}return{alloc:e,free:r,allocType:function(t,r){var n=null;switch(t){case q:n=new Int8Array(e(r),0,r);break;case K:n=new Uint8Array(e(r),0,r);break;case $:n=new Int16Array(e(2*r),0,r);break;case X:n=new Uint16Array(e(2*r),0,r);break;case Z:n=new Int32Array(e(4*r),0,r);break;case J:n=new Uint32Array(e(4*r),0,r);break;case tt:n=new Float32Array(e(4*r),0,r);break;default:return null}return n.length!==r?n.subarray(0,r):n},freeType:function(t){r(t.buffer)}}}var nt=rt();nt.zero=rt();var ot=function(t,e){var r=1;e.ext_texture_filter_anisotropic&&(r=t.getParameter(34047));var n=1,o=1;e.webgl_draw_buffers&&(n=t.getParameter(34852),o=t.getParameter(36063));var i=!!e.oes_texture_float;if(i){var a=t.createTexture();t.bindTexture(3553,a),t.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var s=t.createFramebuffer();if(t.bindFramebuffer(36160,s),t.framebufferTexture2D(36160,36064,3553,a,0),t.bindTexture(3553,null),36053!==t.checkFramebufferStatus(36160))i=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var c=nt.allocType(5126,4);t.readPixels(0,0,1,1,6408,5126,c),t.getError()?i=!1:(t.deleteFramebuffer(s),t.deleteTexture(a),i=1===c[0]),nt.freeType(c)}}var u="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),p=!0;if(!u){var l=t.createTexture(),f=nt.allocType(5121,36);t.activeTexture(33984),t.bindTexture(34067,l),t.texImage2D(34069,0,6408,3,3,0,6408,5121,f),nt.freeType(f),t.bindTexture(34067,null),t.deleteTexture(l),p=!t.getError()}return{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(e).filter(function(t){return!!e[t]}),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:o,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:i,npotTextureCube:p}};function it(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var at=function(t){return Object.keys(t).map(function(e){return t[e]})},st={shape:function(t){for(var e=[],r=t;r.length;r=r[0])e.push(r.length);return e},flatten:function(t,e,r,n){var o=1;if(e.length)for(var i=0;i<e.length;++i)o*=e[i];else o=0;var a=n||nt.allocType(r,o);switch(e.length){case 0:break;case 1:!function(t,e,r){for(var n=0;n<e;++n)r[n]=t[n]}(t,e[0],a);break;case 2:!function(t,e,r,n){for(var o=0,i=0;i<e;++i)for(var a=t[i],s=0;s<r;++s)n[o++]=a[s]}(t,e[0],e[1],a);break;case 3:ct(t,e[0],e[1],e[2],a,0);break;default:!function t(e,r,n,o,i){for(var a=1,s=n+1;s<r.length;++s)a*=r[s];var c=r[n];if(r.length-n==4){var u=r[n+1],p=r[n+2],l=r[n+3];for(s=0;s<c;++s)ct(e[s],u,p,l,o,i),i+=a}else for(s=0;s<c;++s)t(e[s],r,n+1,o,i),i+=a}(t,e,0,a,0)}return a}};function ct(t,e,r,n,o,i){for(var a=i,s=0;s<e;++s)for(var c=t[s],u=0;u<r;++u)for(var p=c[u],l=0;l<n;++l)o[a++]=p[l]}var ut={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},pt={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},lt={dynamic:35048,stream:35040,static:35044},ft=st.flatten,_t=st.shape,dt=35044,mt=35040,ht=5121,yt=5126,bt=[];function vt(t){return 0|ut[Object.prototype.toString.call(t)]}function gt(t,e){for(var r=0;r<e.length;++r)t[r]=e[r]}function At(t,e,r,n,o,i,a){for(var s=0,c=0;c<r;++c)for(var u=0;u<n;++u)t[s++]=e[o*c+i*u+a]}bt[5120]=1,bt[5122]=2,bt[5124]=4,bt[5121]=1,bt[5123]=2,bt[5125]=4,bt[5126]=4;var wt={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},xt=0,Et=1,Ot=4,Tt=5120,jt=5121,St=5122,Ct=5123,Dt=5124,It=5125,Pt=34963,Mt=35040,Ft=35044,kt=new Float32Array(1),Rt=new Uint32Array(kt.buffer),Bt=5123;function zt(t){for(var e=nt.allocType(Bt,t.length),r=0;r<t.length;++r)if(isNaN(t[r]))e[r]=65535;else if(t[r]===1/0)e[r]=31744;else if(t[r]===-1/0)e[r]=64512;else{kt[0]=t[r];var n=Rt[0],o=n>>>31<<15,i=(n<<1>>>24)-127,a=n>>13&1023;if(i<-24)e[r]=o;else if(i<-14){var s=-14-i;e[r]=o+(a+1024>>s)}else e[r]=i>15?o+31744:o+(i+15<<10)+a}return e}function Gt(e){return Array.isArray(e)||t(e)}var Nt=function(t){return!(t&t-1||!t)},Lt=34467,Ut=3553,Wt=34067,Ht=34069,Vt=6408,Yt=6406,Qt=6407,qt=6409,Kt=6410,$t=32854,Xt=32855,Zt=36194,Jt=32819,te=32820,ee=33635,re=34042,ne=6402,oe=34041,ie=35904,ae=35906,se=36193,ce=33776,ue=33777,pe=33778,le=33779,fe=35986,_e=35987,de=34798,me=35840,he=35841,ye=35842,be=35843,ve=36196,ge=5121,Ae=5123,we=5125,xe=5126,Ee=10242,Oe=10243,Te=10497,je=33071,Se=33648,Ce=10240,De=10241,Ie=9728,Pe=9729,Me=9984,Fe=9985,ke=9986,Re=9987,Be=33170,ze=4352,Ge=4353,Ne=4354,Le=34046,Ue=3317,We=37440,He=37441,Ve=37443,Ye=37444,Qe=33984,qe=[Me,ke,Fe,Re],Ke=[0,qt,Kt,Qt,Vt],$e={};function Xe(t){return"[object "+t+"]"}$e[qt]=$e[Yt]=$e[ne]=1,$e[oe]=$e[Kt]=2,$e[Qt]=$e[ie]=3,$e[Vt]=$e[ae]=4;var Ze=Xe("HTMLCanvasElement"),Je=Xe("OffscreenCanvas"),tr=Xe("CanvasRenderingContext2D"),er=Xe("ImageBitmap"),rr=Xe("HTMLImageElement"),nr=Xe("HTMLVideoElement"),or=Object.keys(ut).concat([Ze,Je,tr,er,rr,nr]),ir=[];ir[ge]=1,ir[xe]=4,ir[se]=2,ir[Ae]=2,ir[we]=4;var ar=[];function sr(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function cr(t){if(!Array.isArray(t))return!1;var e=t.length;return!(0===e||!Gt(t[0]))}function ur(t){return Object.prototype.toString.call(t)}function pr(t){return ur(t)===Ze}function lr(t){return ur(t)===Je}function fr(t){if(!t)return!1;var e=ur(t);return or.indexOf(e)>=0||sr(t)||cr(t)||it(t)}function _r(t){return 0|ut[Object.prototype.toString.call(t)]}function dr(t,e){return nt.allocType(t.type===se?xe:t.type,e)}function mr(t,e){t.type===se?(t.data=zt(e),nt.freeType(e)):t.data=e}function hr(t,e,r,n,o,i){var a;if(a=void 0!==ar[t]?ar[t]:$e[t]*ir[e],i&&(a*=6),o){for(var s=0,c=r;c>=1;)s+=a*c*c,c/=2;return s}return a*r*n}function yr(r,n,o,i,a,s,c){var u={"don't care":ze,"dont care":ze,nice:Ne,fast:Ge},p={repeat:Te,clamp:je,mirror:Se},l={nearest:Ie,linear:Pe},f=e({mipmap:Re,"nearest mipmap nearest":Me,"linear mipmap nearest":Fe,"nearest mipmap linear":ke,"linear mipmap linear":Re},l),_={none:0,browser:Ye},d={uint8:ge,rgba4:Jt,rgb565:ee,"rgb5 a1":te},m={alpha:Yt,luminance:qt,"luminance alpha":Kt,rgb:Qt,rgba:Vt,rgba4:$t,"rgb5 a1":Xt,rgb565:Zt},h={};n.ext_srgb&&(m.srgb=ie,m.srgba=ae),n.oes_texture_float&&(d.float32=d.float=xe),n.oes_texture_half_float&&(d.float16=d["half float"]=se),n.webgl_depth_texture&&(e(m,{depth:ne,"depth stencil":oe}),e(d,{uint16:Ae,uint32:we,"depth stencil":re})),n.webgl_compressed_texture_s3tc&&e(h,{"rgb s3tc dxt1":ce,"rgba s3tc dxt1":ue,"rgba s3tc dxt3":pe,"rgba s3tc dxt5":le}),n.webgl_compressed_texture_atc&&e(h,{"rgb atc":fe,"rgba atc explicit alpha":_e,"rgba atc interpolated alpha":de}),n.webgl_compressed_texture_pvrtc&&e(h,{"rgb pvrtc 4bppv1":me,"rgb pvrtc 2bppv1":he,"rgba pvrtc 4bppv1":ye,"rgba pvrtc 2bppv1":be}),n.webgl_compressed_texture_etc1&&(h["rgb etc1"]=ve);var y=Array.prototype.slice.call(r.getParameter(Lt));Object.keys(h).forEach(function(t){var e=h[t];y.indexOf(e)>=0&&(m[t]=e)});var b=Object.keys(m);o.textureFormats=b;var v=[];Object.keys(m).forEach(function(t){var e=m[t];v[e]=t});var g=[];Object.keys(d).forEach(function(t){var e=d[t];g[e]=t});var A=[];Object.keys(l).forEach(function(t){var e=l[t];A[e]=t});var w=[];Object.keys(f).forEach(function(t){var e=f[t];w[e]=t});var x=[];Object.keys(p).forEach(function(t){var e=p[t];x[e]=t});var E=b.reduce(function(t,e){var r=m[e];return r===qt||r===Yt||r===qt||r===Kt||r===ne||r===oe||n.ext_srgb&&(r===ie||r===ae)?t[r]=r:r===Xt||e.indexOf("rgba")>=0?t[r]=Vt:t[r]=Qt,t},{});function O(){this.internalformat=Vt,this.format=Vt,this.type=ge,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Ye,this.width=0,this.height=0,this.channels=0}function T(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function j(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(M.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(M.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(M.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(M.parameter(e.colorSpace,_,"invalid colorSpace"),t.colorSpace=_[e.colorSpace]),"type"in e){var r=e.type;M(n.oes_texture_float||!("float"===r||"float32"===r),"you must enable the OES_texture_float extension in order to use floating point textures."),M(n.oes_texture_half_float||!("half float"===r||"float16"===r),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),M(n.webgl_depth_texture||!("uint16"===r||"uint32"===r||"depth stencil"===r),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),M.parameter(r,d,"invalid texture type"),t.type=d[r]}var i=t.width,a=t.height,s=t.channels,c=!1;"shape"in e?(M(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),i=e.shape[0],a=e.shape[1],3===e.shape.length&&(s=e.shape[2],M(s>0&&s<=4,"invalid number of channels"),c=!0),M(i>=0&&i<=o.maxTextureSize,"invalid width"),M(a>=0&&a<=o.maxTextureSize,"invalid height")):("radius"in e&&(i=a=e.radius,M(i>=0&&i<=o.maxTextureSize,"invalid radius")),"width"in e&&(i=e.width,M(i>=0&&i<=o.maxTextureSize,"invalid width")),"height"in e&&(a=e.height,M(a>=0&&a<=o.maxTextureSize,"invalid height")),"channels"in e&&(s=e.channels,M(s>0&&s<=4,"invalid number of channels"),c=!0)),t.width=0|i,t.height=0|a,t.channels=0|s;var u=!1;if("format"in e){var p=e.format;M(n.webgl_depth_texture||!("depth"===p||"depth stencil"===p),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),M.parameter(p,m,"invalid texture format");var l=t.internalformat=m[p];t.format=E[l],p in d&&("type"in e||(t.type=d[p])),p in h&&(t.compressed=!0),u=!0}!c&&u?t.channels=$e[t.format]:c&&!u?t.channels!==Ke[t.format]&&(t.format=t.internalformat=Ke[t.channels]):u&&c&&M(t.channels===$e[t.format],"number of channels inconsistent with specified format")}}function S(t){r.pixelStorei(We,t.flipY),r.pixelStorei(He,t.premultiplyAlpha),r.pixelStorei(Ve,t.colorSpace),r.pixelStorei(Ue,t.unpackAlignment)}function C(){O.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function D(e,r){var n=null;if(fr(r)?n=r:r&&(M.type(r,"object","invalid pixel data type"),j(e,r),"x"in r&&(e.xOffset=0|r.x),"y"in r&&(e.yOffset=0|r.y),fr(r.data)&&(n=r.data)),M(!e.compressed||n instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),r.copy){M(!n,"can not specify copy and data field for the same texture");var i=a.viewportWidth,s=a.viewportHeight;e.width=e.width||i-e.xOffset,e.height=e.height||s-e.yOffset,e.needsCopy=!0,M(e.xOffset>=0&&e.xOffset<i&&e.yOffset>=0&&e.yOffset<s&&e.width>0&&e.width<=i&&e.height>0&&e.height<=s,"copy texture read out of bounds")}else if(n){if(t(n))e.channels=e.channels||4,e.data=n,"type"in r||e.type!==ge||(e.type=_r(n));else if(sr(n))e.channels=e.channels||4,function(t,e){var r=e.length;switch(t.type){case ge:case Ae:case we:case xe:var n=nt.allocType(t.type,r);n.set(e),t.data=n;break;case se:t.data=zt(e);break;default:M.raise("unsupported texture type, must specify a typed array")}}(e,n),e.alignment=1,e.needsFree=!0;else if(it(n)){var c=n.data;Array.isArray(c)||e.type!==ge||(e.type=_r(c));var u,p,l,f,_,d,m=n.shape,h=n.stride;3===m.length?(l=m[2],d=h[2]):(M(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),l=1,d=1),u=m[0],p=m[1],f=h[0],_=h[1],e.alignment=1,e.width=u,e.height=p,e.channels=l,e.format=e.internalformat=Ke[l],e.needsFree=!0,function(t,e,r,n,o,i){for(var a=t.width,s=t.height,c=t.channels,u=dr(t,a*s*c),p=0,l=0;l<s;++l)for(var f=0;f<a;++f)for(var _=0;_<c;++_)u[p++]=e[r*f+n*l+o*_+i];mr(t,u)}(e,c,f,_,d,n.offset)}else if(pr(n)||lr(n)||ur(n)===tr)pr(n)||lr(n)?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(function(t){return ur(t)===er}(n))e.element=n,e.width=n.width,e.height=n.height,e.channels=4;else if(function(t){return ur(t)===rr}(n))e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if(function(t){return ur(t)===nr}(n))e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(cr(n)){var y=e.width||n[0].length,b=e.height||n.length,v=e.channels;v=Gt(n[0][0])?v||n[0][0].length:v||1;for(var g=st.shape(n),A=1,w=0;w<g.length;++w)A*=g[w];var x=dr(e,A);st.flatten(n,g,"",x),mr(e,x),e.alignment=1,e.width=y,e.height=b,e.channels=v,e.format=e.internalformat=Ke[v],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===xe?M(o.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===se&&M(o.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function I(t,e,n){var o=t.element,a=t.data,s=t.internalformat,c=t.format,u=t.type,p=t.width,l=t.height;S(t),o?r.texImage2D(e,n,c,c,u,o):t.compressed?r.compressedTexImage2D(e,n,s,p,l,0,a):t.needsCopy?(i(),r.copyTexImage2D(e,n,c,t.xOffset,t.yOffset,p,l,0)):r.texImage2D(e,n,c,p,l,0,c,u,a||null)}function P(t,e,n,o,a){var s=t.element,c=t.data,u=t.internalformat,p=t.format,l=t.type,f=t.width,_=t.height;S(t),s?r.texSubImage2D(e,a,n,o,p,l,s):t.compressed?r.compressedTexSubImage2D(e,a,n,o,u,f,_,c):t.needsCopy?(i(),r.copyTexSubImage2D(e,a,n,o,t.xOffset,t.yOffset,f,_)):r.texSubImage2D(e,a,n,o,f,_,p,l,c)}var F=[];function k(){return F.pop()||new C}function R(t){t.needsFree&&nt.freeType(t.data),C.call(t),F.push(t)}function B(){O.call(this),this.genMipmaps=!1,this.mipmapHint=ze,this.mipmask=0,this.images=Array(16)}function z(t,e,r){var n=t.images[0]=k();t.mipmask=1,n.width=t.width=e,n.height=t.height=r,n.channels=t.channels=4}function G(t,e){var r=null;if(fr(e))T(r=t.images[0]=k(),t),D(r,e),t.mipmask=1;else if(j(t,e),Array.isArray(e.mipmap))for(var n=e.mipmap,o=0;o<n.length;++o)T(r=t.images[o]=k(),t),r.width>>=o,r.height>>=o,D(r,n[o]),t.mipmask|=1<<o;else T(r=t.images[0]=k(),t),D(r,e),t.mipmask=1;T(t,t.images[0]),!t.compressed||t.internalformat!==ce&&t.internalformat!==ue&&t.internalformat!==pe&&t.internalformat!==le||M(t.width%4==0&&t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function N(t,e){for(var r=t.images,n=0;n<r.length;++n){if(!r[n])return;I(r[n],e,n)}}var L=[];function U(){var t=L.pop()||new B;O.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function W(t){for(var e=t.images,r=0;r<e.length;++r)e[r]&&R(e[r]),e[r]=null;L.push(t)}function H(){this.minFilter=Ie,this.magFilter=Ie,this.wrapS=je,this.wrapT=je,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ze}function V(t,e){if("min"in e){var r=e.min;M.parameter(r,f),t.minFilter=f[r],qe.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var n=e.mag;M.parameter(n,l),t.magFilter=l[n]}var i=t.wrapS,a=t.wrapT;if("wrap"in e){var s=e.wrap;"string"==typeof s?(M.parameter(s,p),i=a=p[s]):Array.isArray(s)&&(M.parameter(s[0],p),M.parameter(s[1],p),i=p[s[0]],a=p[s[1]])}else{if("wrapS"in e){var c=e.wrapS;M.parameter(c,p),i=p[c]}if("wrapT"in e){var _=e.wrapT;M.parameter(_,p),a=p[_]}}if(t.wrapS=i,t.wrapT=a,"anisotropic"in e){var d=e.anisotropic;M("number"==typeof d&&d>=1&&d<=o.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var m=!1;switch(typeof e.mipmap){case"string":M.parameter(e.mipmap,u,"invalid mipmap hint"),t.mipmapHint=u[e.mipmap],t.genMipmaps=!0,m=!0;break;case"boolean":m=t.genMipmaps=e.mipmap;break;case"object":M(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,m=!0;break;default:M.raise("invalid mipmap type")}!m||"min"in e||(t.minFilter=Me)}}function Y(t,e){r.texParameteri(e,De,t.minFilter),r.texParameteri(e,Ce,t.magFilter),r.texParameteri(e,Ee,t.wrapS),r.texParameteri(e,Oe,t.wrapT),n.ext_texture_filter_anisotropic&&r.texParameteri(e,Le,t.anisotropic),t.genMipmaps&&(r.hint(Be,t.mipmapHint),r.generateMipmap(e))}var Q=0,q={},K=o.maxTextureUnits,$=Array(K).map(function(){return null});function X(t){O.call(this),this.mipmask=0,this.internalformat=Vt,this.id=Q++,this.refCount=1,this.target=t,this.texture=r.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new H,c.profile&&(this.stats={size:0})}function Z(t){r.activeTexture(Qe),r.bindTexture(t.target,t.texture)}function J(){var t=$[0];t?r.bindTexture(t.target,t.texture):r.bindTexture(Ut,null)}function tt(t){var e=t.texture;M(e,"must not double destroy texture");var n=t.unit,o=t.target;n>=0&&(r.activeTexture(Qe+n),r.bindTexture(o,null),$[n]=null),r.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete q[t.id],s.textureCount--}return e(X.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(t<0){for(var e=0;e<K;++e){var n=$[e];if(n){if(n.bindCount>0)continue;n.unit=-1}$[e]=this,t=e;break}t>=K&&M.raise("insufficient number of texture units"),c.profile&&s.maxTextureUnits<t+1&&(s.maxTextureUnits=t+1),this.unit=t,r.activeTexture(Qe+t),r.bindTexture(this.target,this.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&tt(this)}}),c.profile&&(s.getTotalTextureSize=function(){var t=0;return Object.keys(q).forEach(function(e){t+=q[e].stats.size}),t}),{create2D:function(t,e){var n=new X(Ut);function i(t,e){var r=n.texInfo;H.call(r);var a=U();return"number"==typeof t?z(a,0|t,"number"==typeof e?0|e:0|t):t?(M.type(t,"object","invalid arguments to regl.texture"),V(r,t),G(a,t)):z(a,1,1),r.genMipmaps&&(a.mipmask=(a.width<<1)-1),n.mipmask=a.mipmask,T(n,a),M.texture2D(r,a,o),n.internalformat=a.internalformat,i.width=a.width,i.height=a.height,Z(n),N(a,Ut),Y(r,Ut),J(),W(a),c.profile&&(n.stats.size=hr(n.internalformat,n.type,a.width,a.height,r.genMipmaps,!1)),i.format=v[n.internalformat],i.type=g[n.type],i.mag=A[r.magFilter],i.min=w[r.minFilter],i.wrapS=x[r.wrapS],i.wrapT=x[r.wrapT],i}return q[n.id]=n,s.textureCount++,i(t,e),i.subimage=function(t,e,r,o){M(!!t,"must specify image data");var a=0|e,s=0|r,c=0|o,u=k();return T(u,n),u.width=0,u.height=0,D(u,t),u.width=u.width||(n.width>>c)-a,u.height=u.height||(n.height>>c)-s,M(n.type===u.type&&n.format===u.format&&n.internalformat===u.internalformat,"incompatible format for texture.subimage"),M(a>=0&&s>=0&&a+u.width<=n.width&&s+u.height<=n.height,"texture.subimage write out of bounds"),M(n.mipmask&1<<c,"missing mipmap data"),M(u.data||u.element||u.needsCopy,"missing image data"),Z(n),P(u,Ut,a,s,c),J(),R(u),i},i.resize=function(t,e){var o=0|t,a=0|e||o;if(o===n.width&&a===n.height)return i;i.width=n.width=o,i.height=n.height=a,Z(n);for(var s=0;n.mipmask>>s;++s){var u=o>>s,p=a>>s;if(!u||!p)break;r.texImage2D(Ut,s,n.format,u,p,0,n.format,n.type,null)}return J(),c.profile&&(n.stats.size=hr(n.internalformat,n.type,o,a,!1,!1)),i},i._reglType="texture2d",i._texture=n,c.profile&&(i.stats=n.stats),i.destroy=function(){n.decRef()},i},createCube:function(t,e,n,i,a,u){var p=new X(Wt);q[p.id]=p,s.cubeCount++;var l=new Array(6);function f(t,e,r,n,i,a){var s,u=p.texInfo;for(H.call(u),s=0;s<6;++s)l[s]=U();if("number"!=typeof t&&t)if("object"==typeof t)if(e)G(l[0],t),G(l[1],e),G(l[2],r),G(l[3],n),G(l[4],i),G(l[5],a);else if(V(u,t),j(p,t),"faces"in t){var _=t.faces;for(M(Array.isArray(_)&&6===_.length,"cube faces must be a length 6 array"),s=0;s<6;++s)M("object"==typeof _[s]&&!!_[s],"invalid input for cube map face"),T(l[s],p),G(l[s],_[s])}else for(s=0;s<6;++s)G(l[s],t);else M.raise("invalid arguments to cube map");else{var d=0|t||1;for(s=0;s<6;++s)z(l[s],d,d)}for(T(p,l[0]),o.npotTextureCube||M(Nt(p.width)&&Nt(p.height),"your browser does not support non power or two texture dimensions"),u.genMipmaps?p.mipmask=(l[0].width<<1)-1:p.mipmask=l[0].mipmask,M.textureCube(p,u,l,o),p.internalformat=l[0].internalformat,f.width=l[0].width,f.height=l[0].height,Z(p),s=0;s<6;++s)N(l[s],Ht+s);for(Y(u,Wt),J(),c.profile&&(p.stats.size=hr(p.internalformat,p.type,f.width,f.height,u.genMipmaps,!0)),f.format=v[p.internalformat],f.type=g[p.type],f.mag=A[u.magFilter],f.min=w[u.minFilter],f.wrapS=x[u.wrapS],f.wrapT=x[u.wrapT],s=0;s<6;++s)W(l[s]);return f}return f(t,e,n,i,a,u),f.subimage=function(t,e,r,n,o){M(!!e,"must specify image data"),M("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var i=0|r,a=0|n,s=0|o,c=k();return T(c,p),c.width=0,c.height=0,D(c,e),c.width=c.width||(p.width>>s)-i,c.height=c.height||(p.height>>s)-a,M(p.type===c.type&&p.format===c.format&&p.internalformat===c.internalformat,"incompatible format for texture.subimage"),M(i>=0&&a>=0&&i+c.width<=p.width&&a+c.height<=p.height,"texture.subimage write out of bounds"),M(p.mipmask&1<<s,"missing mipmap data"),M(c.data||c.element||c.needsCopy,"missing image data"),Z(p),P(c,Ht+t,i,a,s),J(),R(c),f},f.resize=function(t){var e=0|t;if(e!==p.width){f.width=p.width=e,f.height=p.height=e,Z(p);for(var n=0;n<6;++n)for(var o=0;p.mipmask>>o;++o)r.texImage2D(Ht+n,o,p.format,e>>o,e>>o,0,p.format,p.type,null);return J(),c.profile&&(p.stats.size=hr(p.internalformat,p.type,f.width,f.height,!1,!0)),f}},f._reglType="textureCube",f._texture=p,c.profile&&(f.stats=p.stats),f.destroy=function(){p.decRef()},f},clear:function(){for(var t=0;t<K;++t)r.activeTexture(Qe+t),r.bindTexture(Ut,null),$[t]=null;at(q).forEach(tt),s.cubeCount=0,s.textureCount=0},getTexture:function(t){return null},restore:function(){for(var t=0;t<K;++t){var e=$[t];e&&(e.bindCount=0,e.unit=-1,$[t]=null)}at(q).forEach(function(t){t.texture=r.createTexture(),r.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!=(t.mipmask&1<<e))if(t.target===Ut)r.texImage2D(Ut,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var n=0;n<6;++n)r.texImage2D(Ht+n,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);Y(t.texInfo,t.target)})},refresh:function(){for(var t=0;t<K;++t){var e=$[t];e&&(e.bindCount=0,e.unit=-1,$[t]=null),r.activeTexture(Qe+t),r.bindTexture(Ut,null),r.bindTexture(Wt,null)}}}}ar[$t]=2,ar[Xt]=2,ar[Zt]=2,ar[oe]=4,ar[ce]=.5,ar[ue]=.5,ar[pe]=1,ar[le]=1,ar[fe]=.5,ar[_e]=1,ar[de]=1,ar[me]=.5,ar[he]=.25,ar[ye]=.5,ar[be]=.25,ar[ve]=.5;var br=36161,vr=32854,gr=[];function Ar(t,e,r){return gr[t]*e*r}gr[vr]=2,gr[32855]=2,gr[36194]=2,gr[33189]=2,gr[36168]=1,gr[34041]=4,gr[35907]=4,gr[34836]=16,gr[34842]=8,gr[34843]=6;var wr=function(t,e,r,n,o){var i={rgba4:vr,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(i.srgba=35907),e.ext_color_buffer_half_float&&(i.rgba16f=34842,i.rgb16f=34843),e.webgl_color_buffer_float&&(i.rgba32f=34836);var a=[];Object.keys(i).forEach(function(t){var e=i[t];a[e]=t});var s=0,c={};function u(t){this.id=s++,this.refCount=1,this.renderbuffer=t,this.format=vr,this.width=0,this.height=0,o.profile&&(this.stats={size:0})}function p(e){var r=e.renderbuffer;M(r,"must not double destroy renderbuffer"),t.bindRenderbuffer(br,null),t.deleteRenderbuffer(r),e.renderbuffer=null,e.refCount=0,delete c[e.id],n.renderbufferCount--}return u.prototype.decRef=function(){--this.refCount<=0&&p(this)},o.profile&&(n.getTotalRenderbufferSize=function(){var t=0;return Object.keys(c).forEach(function(e){t+=c[e].stats.size}),t}),{create:function(e,s){var p=new u(t.createRenderbuffer());function l(e,n){var s=0,c=0,u=vr;if("object"==typeof e&&e){var f=e;if("shape"in f){var _=f.shape;M(Array.isArray(_)&&_.length>=2,"invalid renderbuffer shape"),s=0|_[0],c=0|_[1]}else"radius"in f&&(s=c=0|f.radius),"width"in f&&(s=0|f.width),"height"in f&&(c=0|f.height);"format"in f&&(M.parameter(f.format,i,"invalid renderbuffer format"),u=i[f.format])}else"number"==typeof e?(s=0|e,c="number"==typeof n?0|n:s):e?M.raise("invalid arguments to renderbuffer constructor"):s=c=1;if(M(s>0&&c>0&&s<=r.maxRenderbufferSize&&c<=r.maxRenderbufferSize,"invalid renderbuffer size"),s!==p.width||c!==p.height||u!==p.format)return l.width=p.width=s,l.height=p.height=c,p.format=u,t.bindRenderbuffer(br,p.renderbuffer),t.renderbufferStorage(br,u,s,c),M(0===t.getError(),"invalid render buffer format"),o.profile&&(p.stats.size=Ar(p.format,p.width,p.height)),l.format=a[p.format],l}return c[p.id]=p,n.renderbufferCount++,l(e,s),l.resize=function(e,n){var i=0|e,a=0|n||i;return i===p.width&&a===p.height?l:(M(i>0&&a>0&&i<=r.maxRenderbufferSize&&a<=r.maxRenderbufferSize,"invalid renderbuffer size"),l.width=p.width=i,l.height=p.height=a,t.bindRenderbuffer(br,p.renderbuffer),t.renderbufferStorage(br,p.format,i,a),M(0===t.getError(),"invalid render buffer format"),o.profile&&(p.stats.size=Ar(p.format,p.width,p.height)),l)},l._reglType="renderbuffer",l._renderbuffer=p,o.profile&&(l.stats=p.stats),l.destroy=function(){p.decRef()},l},clear:function(){at(c).forEach(p)},restore:function(){at(c).forEach(function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(br,e.renderbuffer),t.renderbufferStorage(br,e.format,e.width,e.height)}),t.bindRenderbuffer(br,null)}}},xr=36160,Er=36161,Or=3553,Tr=34069,jr=36064,Sr=36096,Cr=36128,Dr=33306,Ir=36053,Pr=6402,Mr=[6407,6408],Fr=[];Fr[6408]=4,Fr[6407]=3;var kr=[];kr[5121]=1,kr[5126]=4,kr[36193]=2;var Rr=33189,Br=36168,zr=34041,Gr=[32854,32855,36194,35907,34842,34843,34836],Nr={};Nr[Ir]="complete",Nr[36054]="incomplete attachment",Nr[36057]="incomplete dimensions",Nr[36055]="incomplete, missing attachment",Nr[36061]="unsupported";var Lr=5126,Ur=34962;function Wr(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Lr,this.offset=0,this.stride=0,this.divisor=0}var Hr=35632,Vr=35633,Yr=35718,Qr=35721,qr=6408,Kr=5121,$r=3333,Xr=5126;function Zr(e,r,n,o,i,a,s){function c(c){var u;null===r.next?(M(i.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),u=Kr):(M(null!==r.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),u=r.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(M(u===Kr||u===Xr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),u===Xr&&M(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):M(u===Kr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var p=0,l=0,f=o.framebufferWidth,_=o.framebufferHeight,d=null;t(c)?d=c:c&&(M.type(c,"object","invalid arguments to regl.read()"),p=0|c.x,l=0|c.y,M(p>=0&&p<o.framebufferWidth,"invalid x offset for regl.read"),M(l>=0&&l<o.framebufferHeight,"invalid y offset for regl.read"),f=0|(c.width||o.framebufferWidth-p),_=0|(c.height||o.framebufferHeight-l),d=c.data||null),d&&(u===Kr?M(d instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):u===Xr&&M(d instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),M(f>0&&f+p<=o.framebufferWidth,"invalid width for read pixels"),M(_>0&&_+l<=o.framebufferHeight,"invalid height for read pixels"),n();var m=f*_*4;return d||(u===Kr?d=new Uint8Array(m):u===Xr&&(d=d||new Float32Array(m))),M.isTypedArray(d,"data buffer for regl.read() must be a typedarray"),M(d.byteLength>=m,"data buffer for regl.read() too small"),e.pixelStorei($r,4),e.readPixels(p,l,f,_,qr,u,d),d}return function(t){return t&&"framebuffer"in t?function(t){var e;return r.setFBO({framebuffer:t.framebuffer},function(){e=c(t)}),e}(t):c(t)}}function Jr(t){return Array.prototype.slice.call(t)}function tn(t){return Jr(t).join("")}var en="xyzw".split(""),rn=5121,nn=1,on=2,an=0,sn=1,cn=2,un=3,pn=4,ln=5,fn=6,_n="dither",dn="blend.enable",mn="blend.color",hn="blend.equation",yn="blend.func",bn="depth.enable",vn="depth.func",gn="depth.range",An="depth.mask",wn="colorMask",xn="cull.enable",En="cull.face",On="frontFace",Tn="lineWidth",jn="polygonOffset.enable",Sn="polygonOffset.offset",Cn="sample.alpha",Dn="sample.enable",In="sample.coverage",Pn="stencil.enable",Mn="stencil.mask",Fn="stencil.func",kn="stencil.opFront",Rn="stencil.opBack",Bn="scissor.enable",zn="scissor.box",Gn="viewport",Nn="profile",Ln="framebuffer",Un="vert",Wn="frag",Hn="elements",Vn="primitive",Yn="count",Qn="offset",qn="instances",Kn="vao",$n=Ln+"Width",Xn=Ln+"Height",Zn=Gn+"Width",Jn=Gn+"Height",to="drawingBufferWidth",eo="drawingBufferHeight",ro=[yn,hn,Fn,kn,Rn,In,Gn,zn,Sn],no=34962,oo=34963,io=3553,ao=34067,so=2884,co=3042,uo=3024,po=2960,lo=2929,fo=3089,_o=32823,mo=32926,ho=32928,yo=5126,bo=35664,vo=35665,go=35666,Ao=5124,wo=35667,xo=35668,Eo=35669,Oo=35670,To=35671,jo=35672,So=35673,Co=35674,Do=35675,Io=35676,Po=35678,Mo=35680,Fo=4,ko=1028,Ro=1029,Bo=2304,zo=2305,Go=32775,No=32776,Lo=519,Uo=7680,Wo=0,Ho=1,Vo=32774,Yo=513,Qo=36160,qo=36064,Ko={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},$o=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Xo={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Zo={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Jo={frag:35632,vert:35633},ti={cw:Bo,ccw:zo};function ei(e){return Array.isArray(e)||t(e)||it(e)}function ri(t){return t.sort(function(t,e){return t===Gn?-1:e===Gn?1:t<e?-1:1})}function ni(t,e,r,n){this.thisDep=t,this.contextDep=e,this.propDep=r,this.append=n}function oi(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function ii(t){return new ni(!1,!1,!1,t)}function ai(t,e){var r=t.type;if(r===an){var n=t.data.length;return new ni(!0,n>=1,n>=2,e)}if(r===pn){var o=t.data;return new ni(o.thisDep,o.contextDep,o.propDep,e)}if(r===ln)return new ni(!1,!1,!1,e);if(r===fn){for(var i=!1,a=!1,s=!1,c=0;c<t.data.length;++c){var u=t.data[c];if(u.type===sn)s=!0;else if(u.type===cn)a=!0;else if(u.type===un)i=!0;else if(u.type===an){i=!0;var p=u.data;p>=1&&(a=!0),p>=2&&(s=!0)}else u.type===pn&&(i=i||u.data.thisDep,a=a||u.data.contextDep,s=s||u.data.propDep)}return new ni(i,a,s,e)}return new ni(r===un,r===cn,r===sn,e)}var si=new ni(!1,!1,!1,function(){});function ci(t,r,n,o,i,a,s,c,u,p,l,f,_,d,m){var h=p.Record,y={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(y.min=Go,y.max=No);var b=n.angle_instanced_arrays,v=n.webgl_draw_buffers,g={dirty:!0,profile:m.profile},A={},w=[],x={},E={};function O(t){return t.replace(".","_")}function T(t,e,r){var n=O(t);w.push(t),A[n]=g[n]=!!r,x[n]=e}function j(t,e,r){var n=O(t);w.push(t),Array.isArray(r)?(g[n]=r.slice(),A[n]=r.slice()):g[n]=A[n]=r,E[n]=e}T(_n,uo),T(dn,co),j(mn,"blendColor",[0,0,0,0]),j(hn,"blendEquationSeparate",[Vo,Vo]),j(yn,"blendFuncSeparate",[Ho,Wo,Ho,Wo]),T(bn,lo,!0),j(vn,"depthFunc",Yo),j(gn,"depthRange",[0,1]),j(An,"depthMask",!0),j(wn,wn,[!0,!0,!0,!0]),T(xn,so),j(En,"cullFace",Ro),j(On,On,zo),j(Tn,Tn,1),T(jn,_o),j(Sn,"polygonOffset",[0,0]),T(Cn,mo),T(Dn,ho),j(In,"sampleCoverage",[1,!1]),T(Pn,po),j(Mn,"stencilMask",-1),j(Fn,"stencilFunc",[Lo,0,-1]),j(kn,"stencilOpSeparate",[ko,Uo,Uo,Uo]),j(Rn,"stencilOpSeparate",[Ro,Uo,Uo,Uo]),T(Bn,fo),j(zn,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),j(Gn,Gn,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var S={gl:t,context:_,strings:r,next:A,current:g,draw:f,elements:a,buffer:i,shader:l,attributes:p.state,vao:p,uniforms:u,framebuffer:c,extensions:n,timer:d,isBufferArgs:ei},C={primTypes:wt,compareFuncs:Xo,blendFuncs:Ko,blendEquations:y,stencilOps:Zo,glTypes:pt,orientationType:ti};M.optional(function(){S.isArrayLike=Gt}),v&&(C.backBuffer=[Ro],C.drawBuffer=Q(o.maxDrawbuffers,function(t){return 0===t?[0]:Q(t,function(t){return qo+t})}));var D=0;function I(){var t=function(){var t=0,r=[],n=[];function o(){var r=[],n=[];return e(function(){r.push.apply(r,Jr(arguments))},{def:function(){var e="v"+t++;return n.push(e),arguments.length>0&&(r.push(e,"="),r.push.apply(r,Jr(arguments)),r.push(";")),e},toString:function(){return tn([n.length>0?"var "+n.join(",")+";":"",tn(r)])}})}function i(){var t=o(),r=o(),n=t.toString,i=r.toString;function a(e,n){r(e,n,"=",t.def(e,n),";")}return e(function(){t.apply(t,Jr(arguments))},{def:t.def,entry:t,exit:r,save:a,set:function(e,r,n){a(e,r),t(e,r,"=",n,";")},toString:function(){return n()+i()}})}var a=o(),s={};return{global:a,link:function(e){for(var o=0;o<n.length;++o)if(n[o]===e)return r[o];var i="g"+t++;return r.push(i),n.push(e),i},block:o,proc:function(t,r){var n=[];function o(){var t="a"+n.length;return n.push(t),t}r=r||0;for(var a=0;a<r;++a)o();var c=i(),u=c.toString;return s[t]=e(c,{arg:o,toString:function(){return tn(["function(",n.join(),"){",u(),"}"])}})},scope:i,cond:function(){var t=tn(arguments),r=i(),n=i(),o=r.toString,a=n.toString;return e(r,{then:function(){return r.apply(r,Jr(arguments)),this},else:function(){return n.apply(n,Jr(arguments)),this},toString:function(){var e=a();return e&&(e="else{"+e+"}"),tn(["if(",t,"){",o(),"}",e])}})},compile:function(){var t=['"use strict";',a,"return {"];Object.keys(s).forEach(function(e){t.push('"',e,'":',s[e].toString(),",")}),t.push("}");var e=tn(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(e)).apply(null,n)}}}(),n=t.link,o=t.global;t.id=D++,t.batchId="0";var i=n(S),a=t.shared={props:"a0"};Object.keys(S).forEach(function(t){a[t]=o.def(i,".",t)}),M.optional(function(){t.CHECK=n(M),t.commandStr=M.guessCommand(),t.command=n(t.commandStr),t.assert=function(t,e,r){t("if(!(",e,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},C.invalidBlendCombinations=$o});var s=t.next={},c=t.current={};Object.keys(E).forEach(function(t){Array.isArray(g[t])&&(s[t]=o.def(a.next,".",t),c[t]=o.def(a.current,".",t))});var u=t.constants={};Object.keys(C).forEach(function(t){u[t]=o.def(JSON.stringify(C[t]))}),t.invoke=function(e,r){switch(r.type){case an:var o=["this",a.context,a.props,t.batchId];return e.def(n(r.data),".call(",o.slice(0,Math.max(r.data.length+1,4)),")");case sn:return e.def(a.props,r.data);case cn:return e.def(a.context,r.data);case un:return e.def("this",r.data);case pn:return r.data.append(t,e),r.data.ref;case ln:return r.data.toString();case fn:return r.data.map(function(r){return t.invoke(e,r)})}},t.attribCache={};var l={};return t.scopeAttrib=function(t){var e=r.id(t);if(e in l)return l[e];var o=p.scope[e];o||(o=p.scope[e]=new h);var i=l[e]=n(o);return i},t}function P(t,e,s,u,f){var _=t.static,d=t.dynamic;M.optional(function(){var t=[Ln,Un,Wn,Hn,Vn,Qn,Yn,qn,Nn,Kn].concat(w);function e(e){Object.keys(e).forEach(function(e){M.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',f.commandStr)})}e(_),e(d)});var m=function(t,e){var r=t.static;if("string"==typeof r[Wn]&&"string"==typeof r[Un]){if(Object.keys(e.dynamic).length>0)return null;var n=e.static,o=Object.keys(n);if(o.length>0&&"number"==typeof n[o[0]]){for(var i=[],a=0;a<o.length;++a)M("number"==typeof n[o[a]],"must specify all vertex attribute locations when using vaos"),i.push([0|n[o[a]],o[a]]);return i}}return null}(t,e),v=function(t,e){var r=t.static,n=t.dynamic;if(Ln in r){var o=r[Ln];return o?(o=c.getFramebuffer(o),M.command(o,"invalid framebuffer object"),ii(function(t,e){var r=t.link(o),n=t.shared;e.set(n.framebuffer,".next",r);var i=n.context;return e.set(i,"."+$n,r+".width"),e.set(i,"."+Xn,r+".height"),r})):ii(function(t,e){var r=t.shared;e.set(r.framebuffer,".next","null");var n=r.context;return e.set(n,"."+$n,n+"."+to),e.set(n,"."+Xn,n+"."+eo),"null"})}if(Ln in n){var i=n[Ln];return ai(i,function(t,e){var r=t.invoke(e,i),n=t.shared,o=n.framebuffer,a=e.def(o,".getFramebuffer(",r,")");M.optional(function(){t.assert(e,"!"+r+"||"+a,"invalid framebuffer object")}),e.set(o,".next",a);var s=n.context;return e.set(s,"."+$n,a+"?"+a+".width:"+s+"."+to),e.set(s,"."+Xn,a+"?"+a+".height:"+s+"."+eo),a})}return null}(t),g=function(t,e,r){var n=t.static,o=t.dynamic;function i(t){if(t in n){var i=n[t];M.commandType(i,"object","invalid "+t,r.commandStr);var a,s,c=!0,u=0|i.x,p=0|i.y;return"width"in i?(a=0|i.width,M.command(a>=0,"invalid "+t,r.commandStr)):c=!1,"height"in i?(s=0|i.height,M.command(s>=0,"invalid "+t,r.commandStr)):c=!1,new ni(!c&&e&&e.thisDep,!c&&e&&e.contextDep,!c&&e&&e.propDep,function(t,e){var r=t.shared.context,n=a;"width"in i||(n=e.def(r,".",$n,"-",u));var o=s;return"height"in i||(o=e.def(r,".",Xn,"-",p)),[u,p,n,o]})}if(t in o){var l=o[t],f=ai(l,function(e,r){var n=e.invoke(r,l);M.optional(function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)});var o=e.shared.context,i=r.def(n,".x|0"),a=r.def(n,".y|0"),s=r.def('"width" in ',n,"?",n,".width|0:","(",o,".",$n,"-",i,")"),c=r.def('"height" in ',n,"?",n,".height|0:","(",o,".",Xn,"-",a,")");return M.optional(function(){e.assert(r,s+">=0&&"+c+">=0","invalid "+t)}),[i,a,s,c]});return e&&(f.thisDep=f.thisDep||e.thisDep,f.contextDep=f.contextDep||e.contextDep,f.propDep=f.propDep||e.propDep),f}return e?new ni(e.thisDep,e.contextDep,e.propDep,function(t,e){var r=t.shared.context;return[0,0,e.def(r,".",$n),e.def(r,".",Xn)]}):null}var a=i(Gn);if(a){var s=a;a=new ni(a.thisDep,a.contextDep,a.propDep,function(t,e){var r=s.append(t,e),n=t.shared.context;return e.set(n,"."+Zn,r[2]),e.set(n,"."+Jn,r[3]),r})}return{viewport:a,scissor_box:i(zn)}}(t,v,f),A=function(t,e){var r=t.static,n=t.dynamic,o=function(){if(Hn in r){var t=r[Hn];ei(t)?t=a.getElements(a.create(t,!0)):t&&(t=a.getElements(t),M.command(t,"invalid elements",e.commandStr));var o=ii(function(e,r){if(t){var n=e.link(t);return e.ELEMENTS=n,n}return e.ELEMENTS=null,null});return o.value=t,o}if(Hn in n){var i=n[Hn];return ai(i,function(t,e){var r=t.shared,n=r.isBufferArgs,o=r.elements,a=t.invoke(e,i),s=e.def("null"),c=e.def(n,"(",a,")"),u=t.cond(c).then(s,"=",o,".createStream(",a,");").else(s,"=",o,".getElements(",a,");");return M.optional(function(){t.assert(u.else,"!"+a+"||"+s,"invalid elements")}),e.entry(u),e.exit(t.cond(c).then(o,".destroyStream(",s,");")),t.ELEMENTS=s,s})}return null}();function i(t,i){if(t in r){var a=0|r[t];return M.command(!i||a>=0,"invalid "+t,e.commandStr),ii(function(t,e){return i&&(t.OFFSET=a),a})}if(t in n){var s=n[t];return ai(s,function(e,r){var n=e.invoke(r,s);return i&&(e.OFFSET=n,M.optional(function(){e.assert(r,n+">=0","invalid "+t)})),n})}return i&&o?ii(function(t,e){return t.OFFSET="0",0}):null}var s=i(Qn,!0);return{elements:o,primitive:function(){if(Vn in r){var t=r[Vn];return M.commandParameter(t,wt,"invalid primitve",e.commandStr),ii(function(e,r){return wt[t]})}if(Vn in n){var i=n[Vn];return ai(i,function(t,e){var r=t.constants.primTypes,n=t.invoke(e,i);return M.optional(function(){t.assert(e,n+" in "+r,"invalid primitive, must be one of "+Object.keys(wt))}),e.def(r,"[",n,"]")})}return o?oi(o)?o.value?ii(function(t,e){return e.def(t.ELEMENTS,".primType")}):ii(function(){return Fo}):new ni(o.thisDep,o.contextDep,o.propDep,function(t,e){var r=t.ELEMENTS;return e.def(r,"?",r,".primType:",Fo)}):null}(),count:function(){if(Yn in r){var t=0|r[Yn];return M.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),ii(function(){return t})}if(Yn in n){var i=n[Yn];return ai(i,function(t,e){var r=t.invoke(e,i);return M.optional(function(){t.assert(e,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")}),r})}if(o){if(oi(o)){if(o)return s?new ni(s.thisDep,s.contextDep,s.propDep,function(t,e){var r=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return M.optional(function(){t.assert(e,r+">=0","invalid vertex offset/element buffer too small")}),r}):ii(function(t,e){return e.def(t.ELEMENTS,".vertCount")});var a=ii(function(){return-1});return M.optional(function(){a.MISSING=!0}),a}var c=new ni(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,function(t,e){var r=t.ELEMENTS;return t.OFFSET?e.def(r,"?",r,".vertCount-",t.OFFSET,":-1"):e.def(r,"?",r,".vertCount:-1")});return M.optional(function(){c.DYNAMIC=!0}),c}return null}(),instances:i(qn,!1),offset:s}}(t,f),x=function(t,e){var r=t.static,n=t.dynamic,i={};return w.forEach(function(t){var a=O(t);function s(e,o){if(t in r){var s=e(r[t]);i[a]=ii(function(){return s})}else if(t in n){var c=n[t];i[a]=ai(c,function(t,e){return o(t,e,t.invoke(e,c))})}}switch(t){case xn:case dn:case _n:case Pn:case bn:case Bn:case jn:case Cn:case Dn:case An:return s(function(r){return M.commandType(r,"boolean",t,e.commandStr),r},function(e,r,n){return M.optional(function(){e.assert(r,"typeof "+n+'==="boolean"',"invalid flag "+t,e.commandStr)}),n});case vn:return s(function(r){return M.commandParameter(r,Xo,"invalid "+t,e.commandStr),Xo[r]},function(e,r,n){var o=e.constants.compareFuncs;return M.optional(function(){e.assert(r,n+" in "+o,"invalid "+t+", must be one of "+Object.keys(Xo))}),r.def(o,"[",n,"]")});case gn:return s(function(t){return M.command(Gt(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t},function(t,e,r){return M.optional(function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===2&&typeof "+r+'[0]==="number"&&typeof '+r+'[1]==="number"&&'+r+"[0]<="+r+"[1]","depth range must be a 2d array")}),[e.def("+",r,"[0]"),e.def("+",r,"[1]")]});case yn:return s(function(t){M.commandType(t,"object","blend.func",e.commandStr);var r="srcRGB"in t?t.srcRGB:t.src,n="srcAlpha"in t?t.srcAlpha:t.src,o="dstRGB"in t?t.dstRGB:t.dst,i="dstAlpha"in t?t.dstAlpha:t.dst;return M.commandParameter(r,Ko,a+".srcRGB",e.commandStr),M.commandParameter(n,Ko,a+".srcAlpha",e.commandStr),M.commandParameter(o,Ko,a+".dstRGB",e.commandStr),M.commandParameter(i,Ko,a+".dstAlpha",e.commandStr),M.command(-1===$o.indexOf(r+", "+o),"unallowed blending combination (srcRGB, dstRGB) = ("+r+", "+o+")",e.commandStr),[Ko[r],Ko[o],Ko[n],Ko[i]]},function(e,r,n){var o=e.constants.blendFuncs;function i(i,a){var s=r.def('"',i,a,'" in ',n,"?",n,".",i,a,":",n,".",i);return M.optional(function(){e.assert(r,s+" in "+o,"invalid "+t+"."+i+a+", must be one of "+Object.keys(Ko))}),s}M.optional(function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid blend func, must be an object")});var a=i("src","RGB"),s=i("dst","RGB");M.optional(function(){var t=e.constants.invalidBlendCombinations;e.assert(r,t+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var c=r.def(o,"[",a,"]"),u=r.def(o,"[",i("src","Alpha"),"]");return[c,r.def(o,"[",s,"]"),u,r.def(o,"[",i("dst","Alpha"),"]")]});case hn:return s(function(r){return"string"==typeof r?(M.commandParameter(r,y,"invalid "+t,e.commandStr),[y[r],y[r]]):"object"==typeof r?(M.commandParameter(r.rgb,y,t+".rgb",e.commandStr),M.commandParameter(r.alpha,y,t+".alpha",e.commandStr),[y[r.rgb],y[r.alpha]]):void M.commandRaise("invalid blend.equation",e.commandStr)},function(e,r,n){var o=e.constants.blendEquations,i=r.def(),a=r.def(),s=e.cond("typeof ",n,'==="string"');return M.optional(function(){function r(t,r,n){e.assert(t,n+" in "+o,"invalid "+r+", must be one of "+Object.keys(y))}r(s.then,t,n),e.assert(s.else,n+"&&typeof "+n+'==="object"',"invalid "+t),r(s.else,t+".rgb",n+".rgb"),r(s.else,t+".alpha",n+".alpha")}),s.then(i,"=",a,"=",o,"[",n,"];"),s.else(i,"=",o,"[",n,".rgb];",a,"=",o,"[",n,".alpha];"),r(s),[i,a]});case mn:return s(function(t){return M.command(Gt(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),Q(4,function(e){return+t[e]})},function(t,e,r){return M.optional(function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===4","blend.color must be a 4d array")}),Q(4,function(t){return e.def("+",r,"[",t,"]")})});case Mn:return s(function(t){return M.commandType(t,"number",a,e.commandStr),0|t},function(t,e,r){return M.optional(function(){t.assert(e,"typeof "+r+'==="number"',"invalid stencil.mask")}),e.def(r,"|0")});case Fn:return s(function(r){M.commandType(r,"object",a,e.commandStr);var n=r.cmp||"keep",o=r.ref||0,i="mask"in r?r.mask:-1;return M.commandParameter(n,Xo,t+".cmp",e.commandStr),M.commandType(o,"number",t+".ref",e.commandStr),M.commandType(i,"number",t+".mask",e.commandStr),[Xo[n],o,i]},function(t,e,r){var n=t.constants.compareFuncs;return M.optional(function(){function o(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}o(r+"&&typeof ",r,'==="object"'),o('!("cmp" in ',r,")||(",r,".cmp in ",n,")")}),[e.def('"cmp" in ',r,"?",n,"[",r,".cmp]",":",Uo),e.def(r,".ref|0"),e.def('"mask" in ',r,"?",r,".mask|0:-1")]});case kn:case Rn:return s(function(r){M.commandType(r,"object",a,e.commandStr);var n=r.fail||"keep",o=r.zfail||"keep",i=r.zpass||"keep";return M.commandParameter(n,Zo,t+".fail",e.commandStr),M.commandParameter(o,Zo,t+".zfail",e.commandStr),M.commandParameter(i,Zo,t+".zpass",e.commandStr),[t===Rn?Ro:ko,Zo[n],Zo[o],Zo[i]]},function(e,r,n){var o=e.constants.stencilOps;function i(i){return M.optional(function(){e.assert(r,'!("'+i+'" in '+n+")||("+n+"."+i+" in "+o+")","invalid "+t+"."+i+", must be one of "+Object.keys(Zo))}),r.def('"',i,'" in ',n,"?",o,"[",n,".",i,"]:",Uo)}return M.optional(function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)}),[t===Rn?Ro:ko,i("fail"),i("zfail"),i("zpass")]});case Sn:return s(function(t){M.commandType(t,"object",a,e.commandStr);var r=0|t.factor,n=0|t.units;return M.commandType(r,"number",a+".factor",e.commandStr),M.commandType(n,"number",a+".units",e.commandStr),[r,n]},function(e,r,n){return M.optional(function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)}),[r.def(n,".factor|0"),r.def(n,".units|0")]});case En:return s(function(t){var r=0;return"front"===t?r=ko:"back"===t&&(r=Ro),M.command(!!r,a,e.commandStr),r},function(t,e,r){return M.optional(function(){t.assert(e,r+'==="front"||'+r+'==="back"',"invalid cull.face")}),e.def(r,'==="front"?',ko,":",Ro)});case Tn:return s(function(t){return M.command("number"==typeof t&&t>=o.lineWidthDims[0]&&t<=o.lineWidthDims[1],"invalid line width, must be a positive number between "+o.lineWidthDims[0]+" and "+o.lineWidthDims[1],e.commandStr),t},function(t,e,r){return M.optional(function(){t.assert(e,"typeof "+r+'==="number"&&'+r+">="+o.lineWidthDims[0]+"&&"+r+"<="+o.lineWidthDims[1],"invalid line width")}),r});case On:return s(function(t){return M.commandParameter(t,ti,a,e.commandStr),ti[t]},function(t,e,r){return M.optional(function(){t.assert(e,r+'==="cw"||'+r+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),e.def(r+'==="cw"?'+Bo+":"+zo)});case wn:return s(function(t){return M.command(Gt(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map(function(t){return!!t})},function(t,e,r){return M.optional(function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===4","invalid color.mask")}),Q(4,function(t){return"!!"+r+"["+t+"]"})});case In:return s(function(t){M.command("object"==typeof t&&t,a,e.commandStr);var r="value"in t?t.value:1,n=!!t.invert;return M.command("number"==typeof r&&r>=0&&r<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[r,n]},function(t,e,r){return M.optional(function(){t.assert(e,r+"&&typeof "+r+'==="object"',"invalid sample.coverage")}),[e.def('"value" in ',r,"?+",r,".value:1"),e.def("!!",r,".invert")]})}}),i}(t,f),E=function(t,e,n){var o=t.static,i=t.dynamic;function a(t){if(t in o){var e=r.id(o[t]);M.optional(function(){l.shader(Jo[t],e,M.guessCommand())});var n=ii(function(){return e});return n.id=e,n}if(t in i){var a=i[t];return ai(a,function(e,r){var n=e.invoke(r,a),o=r.def(e.shared.strings,".id(",n,")");return M.optional(function(){r(e.shared.shader,".shader(",Jo[t],",",o,",",e.command,");")}),o})}return null}var s,c=a(Wn),u=a(Un),p=null;return oi(c)&&oi(u)?(p=l.program(u.id,c.id,null,n),s=ii(function(t,e){return t.link(p)})):s=new ni(c&&c.thisDep||u&&u.thisDep,c&&c.contextDep||u&&u.contextDep,c&&c.propDep||u&&u.propDep,function(t,e){var r,n,o=t.shared.shader;r=c?c.append(t,e):e.def(o,".",Wn),n=u?u.append(t,e):e.def(o,".",Un);var i=o+".program("+n+","+r;return M.optional(function(){i+=","+t.command}),e.def(i+")")}),{frag:c,vert:u,progVar:s,program:p}}(t,0,m);function T(t){var e=g[t];e&&(x[t]=e)}T(Gn),T(O(zn));var j=Object.keys(x).length>0,S={framebuffer:v,draw:A,shader:E,state:x,dirty:j,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(S.profile=function(t){var e,r=t.static,n=t.dynamic;if(Nn in r){var o=!!r[Nn];(e=ii(function(t,e){return o})).enable=o}else if(Nn in n){var i=n[Nn];e=ai(i,function(t,e){return t.invoke(e,i)})}return e}(t),S.uniforms=function(t,e){var r=t.static,n=t.dynamic,o={};return Object.keys(r).forEach(function(t){var n,i=r[t];if("number"==typeof i||"boolean"==typeof i)n=ii(function(){return i});else if("function"==typeof i){var a=i._reglType;"texture2d"===a||"textureCube"===a?n=ii(function(t){return t.link(i)}):"framebuffer"===a||"framebufferCube"===a?(M.command(i.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),n=ii(function(t){return t.link(i.color[0])})):M.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else Gt(i)?n=ii(function(e){return e.global.def("[",Q(i.length,function(r){return M.command("number"==typeof i[r]||"boolean"==typeof i[r],"invalid uniform "+t,e.commandStr),i[r]}),"]")}):M.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);n.value=i,o[t]=n}),Object.keys(n).forEach(function(t){var e=n[t];o[t]=ai(e,function(t,r){return t.invoke(r,e)})}),o}(s,f),S.drawVAO=S.scopeVAO=function(t,e){var r=t.static,n=t.dynamic;if(Kn in r){var o=r[Kn];return null!==o&&null===p.getVAO(o)&&(o=p.createVAO(o)),ii(function(t){return t.link(p.getVAO(o))})}if(Kn in n){var i=n[Kn];return ai(i,function(t,e){var r=t.invoke(e,i);return e.def(t.shared.vao+".getVAO("+r+")")})}return null}(t),!S.drawVAO&&E.program&&!m&&n.angle_instanced_arrays){var C=!0,D=E.program.attributes.map(function(t){var r=e.static[t];return C=C&&!!r,r});if(C&&D.length>0){var I=p.getVAO(p.createVAO(D));S.drawVAO=new ni(null,null,null,function(t,e){return t.link(I)}),S.useVAO=!0}}return m?S.useVAO=!0:S.attributes=function(t,e){var n=t.static,o=t.dynamic,a={};return Object.keys(n).forEach(function(t){var o=n[t],s=r.id(t),c=new h;if(ei(o))c.state=nn,c.buffer=i.getBuffer(i.create(o,no,!1,!0)),c.type=0;else{var u=i.getBuffer(o);if(u)c.state=nn,c.buffer=u,c.type=0;else if(M.command("object"==typeof o&&o,"invalid data for attribute "+t,e.commandStr),"constant"in o){var p=o.constant;c.buffer="null",c.state=on,"number"==typeof p?c.x=p:(M.command(Gt(p)&&p.length>0&&p.length<=4,"invalid constant for attribute "+t,e.commandStr),en.forEach(function(t,e){e<p.length&&(c[t]=p[e])}))}else{u=ei(o.buffer)?i.getBuffer(i.create(o.buffer,no,!1,!0)):i.getBuffer(o.buffer),M.command(!!u,'missing buffer for attribute "'+t+'"',e.commandStr);var l=0|o.offset;M.command(l>=0,'invalid offset for attribute "'+t+'"',e.commandStr);var f=0|o.stride;M.command(f>=0&&f<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',e.commandStr);var _=0|o.size;M.command(!("size"in o)||_>0&&_<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',e.commandStr);var d=!!o.normalized,m=0;"type"in o&&(M.commandParameter(o.type,pt,"invalid type for attribute "+t,e.commandStr),m=pt[o.type]);var y=0|o.divisor;"divisor"in o&&(M.command(0===y||b,'cannot specify divisor for attribute "'+t+'", instancing not supported',e.commandStr),M.command(y>=0,'invalid divisor for attribute "'+t+'"',e.commandStr)),M.optional(function(){var r=e.commandStr,n=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(o).forEach(function(e){M.command(n.indexOf(e)>=0,'unknown parameter "'+e+'" for attribute pointer "'+t+'" (valid parameters are '+n+")",r)})}),c.buffer=u,c.state=nn,c.size=_,c.normalized=d,c.type=m||u.dtype,c.offset=l,c.stride=f,c.divisor=y}}a[t]=ii(function(t,e){var r=t.attribCache;if(s in r)return r[s];var n={isStream:!1};return Object.keys(c).forEach(function(t){n[t]=c[t]}),c.buffer&&(n.buffer=t.link(c.buffer),n.type=n.type||n.buffer+".dtype"),r[s]=n,n})}),Object.keys(o).forEach(function(t){var e=o[t];a[t]=ai(e,function(r,n){var o=r.invoke(n,e),i=r.shared,a=r.constants,s=i.isBufferArgs,c=i.buffer;M.optional(function(){r.assert(n,o+"&&(typeof "+o+'==="object"||typeof '+o+'==="function")&&('+s+"("+o+")||"+c+".getBuffer("+o+")||"+c+".getBuffer("+o+".buffer)||"+s+"("+o+'.buffer)||("constant" in '+o+"&&(typeof "+o+'.constant==="number"||'+i.isArrayLike+"("+o+".constant))))",'invalid dynamic attribute "'+t+'"')});var u={isStream:n.def(!1)},p=new h;p.state=nn,Object.keys(p).forEach(function(t){u[t]=n.def(""+p[t])});var l=u.buffer,f=u.type;function _(t){n(u[t],"=",o,".",t,"|0;")}return n("if(",s,"(",o,")){",u.isStream,"=true;",l,"=",c,".createStream(",no,",",o,");",f,"=",l,".dtype;","}else{",l,"=",c,".getBuffer(",o,");","if(",l,"){",f,"=",l,".dtype;",'}else if("constant" in ',o,"){",u.state,"=",on,";","if(typeof "+o+'.constant === "number"){',u[en[0]],"=",o,".constant;",en.slice(1).map(function(t){return u[t]}).join("="),"=0;","}else{",en.map(function(t,e){return u[t]+"="+o+".constant.length>"+e+"?"+o+".constant["+e+"]:0;"}).join(""),"}}else{","if(",s,"(",o,".buffer)){",l,"=",c,".createStream(",no,",",o,".buffer);","}else{",l,"=",c,".getBuffer(",o,".buffer);","}",f,'="type" in ',o,"?",a.glTypes,"[",o,".type]:",l,".dtype;",u.normalized,"=!!",o,".normalized;"),_("size"),_("offset"),_("stride"),_("divisor"),n("}}"),n.exit("if(",u.isStream,"){",c,".destroyStream(",l,");","}"),u})}),a}(e,f),S.context=function(t){var e=t.static,r=t.dynamic,n={};return Object.keys(e).forEach(function(t){var r=e[t];n[t]=ii(function(t,e){return"number"==typeof r||"boolean"==typeof r?""+r:t.link(r)})}),Object.keys(r).forEach(function(t){var e=r[t];n[t]=ai(e,function(t,r){return t.invoke(r,e)})}),n}(u),S}function F(t,e,r){var n=t.shared,o=n.context,i=t.scope();Object.keys(r).forEach(function(n){e.save(o,"."+n);var a=r[n],s=a.append(t,e);Array.isArray(s)?i(o,".",n,"=[",s.join(),"];"):i(o,".",n,"=",s,";")}),e(i)}function k(t,e,r,n){var o,i=t.shared,a=i.gl,s=i.framebuffer;v&&(o=e.def(i.extensions,".webgl_draw_buffers"));var c,u=t.constants,p=u.drawBuffer,l=u.backBuffer;c=r?r.append(t,e):e.def(s,".next"),n||e("if(",c,"!==",s,".cur){"),e("if(",c,"){",a,".bindFramebuffer(",Qo,",",c,".framebuffer);"),v&&e(o,".drawBuffersWEBGL(",p,"[",c,".colorAttachments.length]);"),e("}else{",a,".bindFramebuffer(",Qo,",null);"),v&&e(o,".drawBuffersWEBGL(",l,");"),e("}",s,".cur=",c,";"),n||e("}")}function R(t,e,r){var n=t.shared,o=n.gl,i=t.current,a=t.next,s=n.current,c=n.next,u=t.cond(s,".dirty");w.forEach(function(e){var n,p,l=O(e);if(!(l in r.state))if(l in a){n=a[l],p=i[l];var f=Q(g[l].length,function(t){return u.def(n,"[",t,"]")});u(t.cond(f.map(function(t,e){return t+"!=="+p+"["+e+"]"}).join("||")).then(o,".",E[l],"(",f,");",f.map(function(t,e){return p+"["+e+"]="+t}).join(";"),";"))}else{n=u.def(c,".",l);var _=t.cond(n,"!==",s,".",l);u(_),l in x?_(t.cond(n).then(o,".enable(",x[l],");").else(o,".disable(",x[l],");"),s,".",l,"=",n,";"):_(o,".",E[l],"(",n,");",s,".",l,"=",n,";")}}),0===Object.keys(r.state).length&&u(s,".dirty=false;"),e(u)}function B(t,e,r,n){var o=t.shared,i=t.current,a=o.current,s=o.gl;ri(Object.keys(r)).forEach(function(o){var c=r[o];if(!n||n(c)){var u=c.append(t,e);if(x[o]){var p=x[o];oi(c)?e(s,u?".enable(":".disable(",p,");"):e(t.cond(u).then(s,".enable(",p,");").else(s,".disable(",p,");")),e(a,".",o,"=",u,";")}else if(Gt(u)){var l=i[o];e(s,".",E[o],"(",u,");",u.map(function(t,e){return l+"["+e+"]="+t}).join(";"),";")}else e(s,".",E[o],"(",u,");",a,".",o,"=",u,";")}})}function z(t,e){b&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function G(t,e,r,n,o){var i,a,s,c=t.shared,u=t.stats,p=c.current,l=c.timer,f=r.profile;function _(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function m(t){i=e.def(),t(i,"=",_(),";"),"string"==typeof o?t(u,".count+=",o,";"):t(u,".count++;"),d&&(n?(a=e.def(),t(a,"=",l,".getNumPendingQueries();")):t(l,".beginQuery(",u,");"))}function h(t){t(u,".cpuTime+=",_(),"-",i,";"),d&&(n?t(l,".pushScopeStats(",a,",",l,".getNumPendingQueries(),",u,");"):t(l,".endQuery();"))}function y(t){var r=e.def(p,".profile");e(p,".profile=",t,";"),e.exit(p,".profile=",r,";")}if(f){if(oi(f))return void(f.enable?(m(e),h(e.exit),y("true")):y("false"));y(s=f.append(t,e))}else s=e.def(p,".profile");var b=t.block();m(b),e("if(",s,"){",b,"}");var v=t.block();h(v),e.exit("if(",s,"){",v,"}")}function N(t,e,r,n,o){var i=t.shared;n.forEach(function(n){var a,s=n.name,c=r.attributes[s];if(c){if(!o(c))return;a=c.append(t,e)}else{if(!o(si))return;var u=t.scopeAttrib(s);M.optional(function(){t.assert(e,u+".state","missing attribute "+s)}),a={},Object.keys(new h).forEach(function(t){a[t]=e.def(u,".",t)})}!function(r,n,o){var a=i.gl,s=e.def(r,".location"),c=e.def(i.attributes,"[",s,"]"),u=o.state,p=o.buffer,l=[o.x,o.y,o.z,o.w],f=["buffer","normalized","offset","stride"];function _(){e("if(!",c,".buffer){",a,".enableVertexAttribArray(",s,");}");var r,i=o.type;if(r=o.size?e.def(o.size,"||",n):n,e("if(",c,".type!==",i,"||",c,".size!==",r,"||",f.map(function(t){return c+"."+t+"!=="+o[t]}).join("||"),"){",a,".bindBuffer(",no,",",p,".buffer);",a,".vertexAttribPointer(",[s,r,i,o.normalized,o.stride,o.offset],");",c,".type=",i,";",c,".size=",r,";",f.map(function(t){return c+"."+t+"="+o[t]+";"}).join(""),"}"),b){var u=o.divisor;e("if(",c,".divisor!==",u,"){",t.instancing,".vertexAttribDivisorANGLE(",[s,u],");",c,".divisor=",u,";}")}}function d(){e("if(",c,".buffer){",a,".disableVertexAttribArray(",s,");",c,".buffer=null;","}if(",en.map(function(t,e){return c+"."+t+"!=="+l[e]}).join("||"),"){",a,".vertexAttrib4f(",s,",",l,");",en.map(function(t,e){return c+"."+t+"="+l[e]+";"}).join(""),"}")}u===nn?_():u===on?d():(e("if(",u,"===",nn,"){"),_(),e("}else{"),d(),e("}"))}(t.link(n),function(t){switch(t){case bo:case wo:case To:return 2;case vo:case xo:case jo:return 3;case go:case Eo:case So:return 4;default:return 1}}(n.info.type),a)})}function U(t,e,n,o,i){for(var a,s=t.shared,c=s.gl,u=0;u<o.length;++u){var p,l=o[u],f=l.name,_=l.info.type,d=n.uniforms[f],m=t.link(l),h=m+".location";if(d){if(!i(d))continue;if(oi(d)){var y=d.value;if(M.command(null!=y,'missing uniform "'+f+'"',t.commandStr),_===Po||_===Mo){M.command("function"==typeof y&&(_===Po&&("texture2d"===y._reglType||"framebuffer"===y._reglType)||_===Mo&&("textureCube"===y._reglType||"framebufferCube"===y._reglType)),"invalid texture for uniform "+f,t.commandStr);var b=t.link(y._texture||y.color[0]._texture);e(c,".uniform1i(",h,",",b+".bind());"),e.exit(b,".unbind();")}else if(_===Co||_===Do||_===Io){M.optional(function(){M.command(Gt(y),"invalid matrix for uniform "+f,t.commandStr),M.command(_===Co&&4===y.length||_===Do&&9===y.length||_===Io&&16===y.length,"invalid length for matrix uniform "+f,t.commandStr)});var v=t.global.def("new Float32Array(["+Array.prototype.slice.call(y)+"])"),g=2;_===Do?g=3:_===Io&&(g=4),e(c,".uniformMatrix",g,"fv(",h,",false,",v,");")}else{switch(_){case yo:M.commandType(y,"number","uniform "+f,t.commandStr),a="1f";break;case bo:M.command(Gt(y)&&2===y.length,"uniform "+f,t.commandStr),a="2f";break;case vo:M.command(Gt(y)&&3===y.length,"uniform "+f,t.commandStr),a="3f";break;case go:M.command(Gt(y)&&4===y.length,"uniform "+f,t.commandStr),a="4f";break;case Oo:M.commandType(y,"boolean","uniform "+f,t.commandStr),a="1i";break;case Ao:M.commandType(y,"number","uniform "+f,t.commandStr),a="1i";break;case To:case wo:M.command(Gt(y)&&2===y.length,"uniform "+f,t.commandStr),a="2i";break;case jo:case xo:M.command(Gt(y)&&3===y.length,"uniform "+f,t.commandStr),a="3i";break;case So:case Eo:M.command(Gt(y)&&4===y.length,"uniform "+f,t.commandStr),a="4i"}e(c,".uniform",a,"(",h,",",Gt(y)?Array.prototype.slice.call(y):y,");")}continue}p=d.append(t,e)}else{if(!i(si))continue;p=e.def(s.uniforms,"[",r.id(f),"]")}_===Po?(M(!Array.isArray(p),"must specify a scalar prop for textures"),e("if(",p,"&&",p,'._reglType==="framebuffer"){',p,"=",p,".color[0];","}")):_===Mo&&(M(!Array.isArray(p),"must specify a scalar prop for cube maps"),e("if(",p,"&&",p,'._reglType==="framebufferCube"){',p,"=",p,".color[0];","}")),M.optional(function(){function r(r,n){t.assert(e,r,'bad data or missing for uniform "'+f+'".  '+n)}function n(t){M(!Array.isArray(p),"must not specify an array type for uniform"),r("typeof "+p+'==="'+t+'"',"invalid type, expected "+t)}function o(e,n){Array.isArray(p)?M(p.length===e,"must have length "+e):r(s.isArrayLike+"("+p+")&&"+p+".length==="+e,"invalid vector, should have length "+e,t.commandStr)}function i(e){M(!Array.isArray(p),"must not specify a value type"),r("typeof "+p+'==="function"&&'+p+'._reglType==="texture'+(e===io?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(_){case Ao:n("number");break;case wo:o(2);break;case xo:o(3);break;case Eo:o(4);break;case yo:n("number");break;case bo:o(2);break;case vo:o(3);break;case go:o(4);break;case Oo:n("boolean");break;case To:o(2);break;case jo:o(3);break;case So:case Co:o(4);break;case Do:o(9);break;case Io:o(16);break;case Po:i(io);break;case Mo:i(ao)}});var A=1;switch(_){case Po:case Mo:var w=e.def(p,"._texture");e(c,".uniform1i(",h,",",w,".bind());"),e.exit(w,".unbind();");continue;case Ao:case Oo:a="1i";break;case wo:case To:a="2i",A=2;break;case xo:case jo:a="3i",A=3;break;case Eo:case So:a="4i",A=4;break;case yo:a="1f";break;case bo:a="2f",A=2;break;case vo:a="3f",A=3;break;case go:a="4f",A=4;break;case Co:a="Matrix2fv";break;case Do:a="Matrix3fv";break;case Io:a="Matrix4fv"}if(e(c,".uniform",a,"(",h,","),"M"===a.charAt(0)){var x=Math.pow(_-Co+2,2),E=t.global.def("new Float32Array(",x,")");Array.isArray(p)?e("false,(",Q(x,function(t){return E+"["+t+"]="+p[t]}),",",E,")"):e("false,(Array.isArray(",p,")||",p," instanceof Float32Array)?",p,":(",Q(x,function(t){return E+"["+t+"]="+p+"["+t+"]"}),",",E,")")}else A>1?e(Q(A,function(t){return Array.isArray(p)?p[t]:p+"["+t+"]"})):(M(!Array.isArray(p),"uniform value must not be an array"),e(p));e(");")}}function W(t,e,r,n){var o=t.shared,i=o.gl,a=o.draw,s=n.draw,c=function(){var o,c=s.elements,u=e;return c?((c.contextDep&&n.contextDynamic||c.propDep)&&(u=r),o=c.append(t,u)):o=u.def(a,".",Hn),o&&u("if("+o+")"+i+".bindBuffer("+oo+","+o+".buffer.buffer);"),o}();function u(o){var i=s[o];return i?i.contextDep&&n.contextDynamic||i.propDep?i.append(t,r):i.append(t,e):e.def(a,".",o)}var p,l,f=u(Vn),_=u(Qn),d=function(){var o,i=s.count,c=e;return i?((i.contextDep&&n.contextDynamic||i.propDep)&&(c=r),o=i.append(t,c),M.optional(function(){i.MISSING&&t.assert(e,"false","missing vertex count"),i.DYNAMIC&&t.assert(c,o+">=0","missing vertex count")})):(o=c.def(a,".",Yn),M.optional(function(){t.assert(c,o+">=0","missing vertex count")})),o}();if("number"==typeof d){if(0===d)return}else r("if(",d,"){"),r.exit("}");b&&(p=u(qn),l=t.instancing);var m=c+".type",h=s.elements&&oi(s.elements);function y(){function t(){r(l,".drawElementsInstancedANGLE(",[f,d,m,_+"<<(("+m+"-"+rn+")>>1)",p],");")}function e(){r(l,".drawArraysInstancedANGLE(",[f,_,d,p],");")}c?h?t():(r("if(",c,"){"),t(),r("}else{"),e(),r("}")):e()}function v(){function t(){r(i+".drawElements("+[f,d,m,_+"<<(("+m+"-"+rn+")>>1)"]+");")}function e(){r(i+".drawArrays("+[f,_,d]+");")}c?h?t():(r("if(",c,"){"),t(),r("}else{"),e(),r("}")):e()}b&&("number"!=typeof p||p>=0)?"string"==typeof p?(r("if(",p,">0){"),y(),r("}else if(",p,"<0){"),v(),r("}")):y():v()}function H(t,e,r,n,o){var i=I(),a=i.proc("body",o);return M.optional(function(){i.commandStr=e.commandStr,i.command=i.link(e.commandStr)}),b&&(i.instancing=a.def(i.shared.extensions,".angle_instanced_arrays")),t(i,a,r,n),i.compile().body}function V(t,e,r,n){z(t,e),r.useVAO?r.drawVAO?e(t.shared.vao,".setVAO(",r.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),N(t,e,r,n.attributes,function(){return!0})),U(t,e,r,n.uniforms,function(){return!0}),W(t,e,e,r)}function Y(t,e,r,n){function o(){return!0}t.batchId="a1",z(t,e),N(t,e,r,n.attributes,o),U(t,e,r,n.uniforms,o),W(t,e,e,r)}function q(t,e,r,n){z(t,e);var o=r.contextDep,i=e.def(),a=e.def();t.shared.props=a,t.batchId=i;var s=t.scope(),c=t.scope();function u(t){return t.contextDep&&o||t.propDep}function p(t){return!u(t)}if(e(s.entry,"for(",i,"=0;",i,"<","a1",";++",i,"){",a,"=","a0","[",i,"];",c,"}",s.exit),r.needsContext&&F(t,c,r.context),r.needsFramebuffer&&k(t,c,r.framebuffer),B(t,c,r.state,u),r.profile&&u(r.profile)&&G(t,c,r,!1,!0),n)r.useVAO?r.drawVAO?u(r.drawVAO)?c(t.shared.vao,".setVAO(",r.drawVAO.append(t,c),");"):s(t.shared.vao,".setVAO(",r.drawVAO.append(t,s),");"):s(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(s(t.shared.vao,".setVAO(null);"),N(t,s,r,n.attributes,p),N(t,c,r,n.attributes,u)),U(t,s,r,n.uniforms,p),U(t,c,r,n.uniforms,u),W(t,s,c,r);else{var l=t.global.def("{}"),f=r.shader.progVar.append(t,c),_=c.def(f,".id"),d=c.def(l,"[",_,"]");c(t.shared.gl,".useProgram(",f,".program);","if(!",d,"){",d,"=",l,"[",_,"]=",t.link(function(e){return H(Y,t,r,e,2)}),"(",f,");}",d,".call(this,a0[",i,"],",i,");")}}function K(t,e,r){var n=e.static[r];if(n&&function(t){if("object"==typeof t&&!Gt(t)){for(var e=Object.keys(t),r=0;r<e.length;++r)if(L.isDynamic(t[e[r]]))return!0;return!1}}(n)){var o=t.global,i=Object.keys(n),a=!1,s=!1,c=!1,u=t.global.def("{}");i.forEach(function(e){var r=n[e];if(L.isDynamic(r)){"function"==typeof r&&(r=n[e]=L.unbox(r));var i=ai(r,null);a=a||i.thisDep,c=c||i.propDep,s=s||i.contextDep}else{switch(o(u,".",e,"="),typeof r){case"number":o(r);break;case"string":o('"',r,'"');break;case"object":Array.isArray(r)&&o("[",r.join(),"]");break;default:o(t.link(r))}o(";")}}),e.dynamic[r]=new L.DynamicVariable(pn,{thisDep:a,contextDep:s,propDep:c,ref:u,append:function(t,e){i.forEach(function(r){var o=n[r];if(L.isDynamic(o)){var i=t.invoke(e,o);e(u,".",r,"=",i,";")}})}}),delete e.static[r]}}return{next:A,current:g,procs:function(){var t=I(),e=t.proc("poll"),r=t.proc("refresh"),i=t.block();e(i),r(i);var a,s=t.shared,c=s.gl,u=s.next,p=s.current;i(p,".dirty=false;"),k(t,e),k(t,r,null,!0),b&&(a=t.link(b)),n.oes_vertex_array_object&&r(t.link(n.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var l=0;l<o.maxAttributes;++l){var f=r.def(s.attributes,"[",l,"]"),_=t.cond(f,".buffer");_.then(c,".enableVertexAttribArray(",l,");",c,".bindBuffer(",no,",",f,".buffer.buffer);",c,".vertexAttribPointer(",l,",",f,".size,",f,".type,",f,".normalized,",f,".stride,",f,".offset);").else(c,".disableVertexAttribArray(",l,");",c,".vertexAttrib4f(",l,",",f,".x,",f,".y,",f,".z,",f,".w);",f,".buffer=null;"),r(_),b&&r(a,".vertexAttribDivisorANGLE(",l,",",f,".divisor);")}return r(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(x).forEach(function(n){var o=x[n],a=i.def(u,".",n),s=t.block();s("if(",a,"){",c,".enable(",o,")}else{",c,".disable(",o,")}",p,".",n,"=",a,";"),r(s),e("if(",a,"!==",p,".",n,"){",s,"}")}),Object.keys(E).forEach(function(n){var o,a,s=E[n],l=g[n],f=t.block();if(f(c,".",s,"("),Gt(l)){var _=l.length;o=t.global.def(u,".",n),a=t.global.def(p,".",n),f(Q(_,function(t){return o+"["+t+"]"}),");",Q(_,function(t){return a+"["+t+"]="+o+"["+t+"];"}).join("")),e("if(",Q(_,function(t){return o+"["+t+"]!=="+a+"["+t+"]"}).join("||"),"){",f,"}")}else o=i.def(u,".",n),a=i.def(p,".",n),f(o,");",p,".",n,"=",o,";"),e("if(",o,"!==",a,"){",f,"}");r(f)}),t.compile()}(),compile:function(t,n,o,i,a){var s=I();s.stats=s.link(a),Object.keys(n.static).forEach(function(t){K(s,n,t)}),ro.forEach(function(e){K(s,t,e)});var c=P(t,n,o,i,s);return function(t,e){var r=t.proc("draw",1);z(t,r),F(t,r,e.context),k(t,r,e.framebuffer),R(t,r,e),B(t,r,e.state),G(t,r,e,!1,!0);var n=e.shader.progVar.append(t,r);if(r(t.shared.gl,".useProgram(",n,".program);"),e.shader.program)V(t,r,e,e.shader.program);else{r(t.shared.vao,".setVAO(null);");var o=t.global.def("{}"),i=r.def(n,".id"),a=r.def(o,"[",i,"]");r(t.cond(a).then(a,".call(this,a0);").else(a,"=",o,"[",i,"]=",t.link(function(r){return H(V,t,e,r,1)}),"(",n,");",a,".call(this,a0);"))}Object.keys(e.state).length>0&&r(t.shared.current,".dirty=true;")}(s,c),function(t,e){var n=t.proc("scope",3);t.batchId="a2";var o=t.shared,i=o.current;function a(r){var i=e.shader[r];i&&n.set(o.shader,"."+r,i.append(t,n))}F(t,n,e.context),e.framebuffer&&e.framebuffer.append(t,n),ri(Object.keys(e.state)).forEach(function(r){var i=e.state[r].append(t,n);Gt(i)?i.forEach(function(e,o){n.set(t.next[r],"["+o+"]",e)}):n.set(o.next,"."+r,i)}),G(t,n,e,!0,!0),[Hn,Qn,Yn,qn,Vn].forEach(function(r){var i=e.draw[r];i&&n.set(o.draw,"."+r,""+i.append(t,n))}),Object.keys(e.uniforms).forEach(function(i){var a=e.uniforms[i].append(t,n);Array.isArray(a)&&(a="["+a.join()+"]"),n.set(o.uniforms,"["+r.id(i)+"]",a)}),Object.keys(e.attributes).forEach(function(r){var o=e.attributes[r].append(t,n),i=t.scopeAttrib(r);Object.keys(new h).forEach(function(t){n.set(i,"."+t,o[t])})}),e.scopeVAO&&n.set(o.vao,".targetVAO",e.scopeVAO.append(t,n)),a(Un),a(Wn),Object.keys(e.state).length>0&&(n(i,".dirty=true;"),n.exit(i,".dirty=true;")),n("a1(",t.shared.context,",a0,",t.batchId,");")}(s,c),function(t,e){var r=t.proc("batch",2);t.batchId="0",z(t,r);var n=!1,o=!0;Object.keys(e.context).forEach(function(t){n=n||e.context[t].propDep}),n||(F(t,r,e.context),o=!1);var i=e.framebuffer,a=!1;function s(t){return t.contextDep&&n||t.propDep}i?(i.propDep?n=a=!0:i.contextDep&&n&&(a=!0),a||k(t,r,i)):k(t,r,null),e.state.viewport&&e.state.viewport.propDep&&(n=!0),R(t,r,e),B(t,r,e.state,function(t){return!s(t)}),e.profile&&s(e.profile)||G(t,r,e,!1,"a1"),e.contextDep=n,e.needsContext=o,e.needsFramebuffer=a;var c=e.shader.progVar;if(c.contextDep&&n||c.propDep)q(t,r,e,null);else{var u=c.append(t,r);if(r(t.shared.gl,".useProgram(",u,".program);"),e.shader.program)q(t,r,e,e.shader.program);else{r(t.shared.vao,".setVAO(null);");var p=t.global.def("{}"),l=r.def(u,".id"),f=r.def(p,"[",l,"]");r(t.cond(f).then(f,".call(this,a0,a1);").else(f,"=",p,"[",l,"]=",t.link(function(r){return H(q,t,e,r,2)}),"(",u,");",f,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&r(t.shared.current,".dirty=true;")}(s,c),e(s.compile(),{destroy:function(){c.shader.program.destroy()}})}}}var ui=34918,pi=34919,li=35007,fi=function(t,e){if(!e.ext_disjoint_timer_query)return null;var r=[];function n(t){r.push(t)}var o=[];function i(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var a=[];function s(t){a.push(t)}var c=[];function u(t,e,r){var n=a.pop()||new i;n.startQueryIndex=t,n.endQueryIndex=e,n.sum=0,n.stats=r,c.push(n)}var p=[],l=[];return{beginQuery:function(t){var n=r.pop()||e.ext_disjoint_timer_query.createQueryEXT();e.ext_disjoint_timer_query.beginQueryEXT(li,n),o.push(n),u(o.length-1,o.length,t)},endQuery:function(){e.ext_disjoint_timer_query.endQueryEXT(li)},pushScopeStats:u,update:function(){var t,r,i=o.length;if(0!==i){l.length=Math.max(l.length,i+1),p.length=Math.max(p.length,i+1),p[0]=0,l[0]=0;var a=0;for(t=0,r=0;r<o.length;++r){var u=o[r];e.ext_disjoint_timer_query.getQueryObjectEXT(u,pi)?(a+=e.ext_disjoint_timer_query.getQueryObjectEXT(u,ui),n(u)):o[t++]=u,p[r+1]=a,l[r+1]=t}for(o.length=t,t=0,r=0;r<c.length;++r){var f=c[r],_=f.startQueryIndex,d=f.endQueryIndex;f.sum+=p[d]-p[_];var m=l[_],h=l[d];h===m?(f.stats.gpuTime+=f.sum/1e6,s(f)):(f.startQueryIndex=m,f.endQueryIndex=h,c[t++]=f)}c.length=t}},getNumPendingQueries:function(){return o.length},clear:function(){r.push.apply(r,o);for(var t=0;t<r.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(r[t]);o.length=0,r.length=0},restore:function(){o.length=0,r.length=0}}},_i=16384,di=256,mi=1024,hi=34962,yi="webglcontextlost",bi="webglcontextrestored",vi=1,gi=2,Ai=3;function wi(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}return function(r){var n=Y(r);if(!n)return null;var o=n.gl,i=o.getContextAttributes(),a=o.isContextLost(),s=function(t,e){var r={};function n(e){M.type(e,"string","extension name must be string");var n,o=e.toLowerCase();try{n=r[o]=t.getExtension(o)}catch(t){}return!!n}for(var o=0;o<e.extensions.length;++o){var i=e.extensions[o];if(!n(i))return e.onDestroy(),e.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(t){if(r[t]&&!n(t))throw new Error("(regl): error restoring extension "+t)})}}}(o,n);if(!s)return null;var c,u,p=(c={"":0},u=[""],{id:function(t){var e=c[t];return e||(e=c[t]=u.length,u.push(t),e)},str:function(t){return u[t]}}),l={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},f=s.extensions,_=fi(o,f),d=W(),m=o.drawingBufferWidth,h=o.drawingBufferHeight,y={tick:0,time:0,viewportWidth:m,viewportHeight:h,framebufferWidth:m,framebufferHeight:h,drawingBufferWidth:m,drawingBufferHeight:h,pixelRatio:n.pixelRatio},b=ot(o,f),v=function(e,r,n,o){var i=0,a={};function s(t){this.id=i++,this.buffer=e.createBuffer(),this.type=t,this.usage=dt,this.byteLength=0,this.dimension=1,this.dtype=ht,this.persistentData=null,n.profile&&(this.stats={size:0})}s.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){l(this)};var c=[];function u(t,r,n){t.byteLength=r.byteLength,e.bufferData(t.type,r,n)}function p(e,r,n,o,i,a){var s,c;if(e.usage=n,Array.isArray(r)){if(e.dtype=o||yt,r.length>0)if(Array.isArray(r[0])){s=_t(r);for(var p=1,l=1;l<s.length;++l)p*=s[l];e.dimension=p,c=ft(r,s,e.dtype),u(e,c,n),a?e.persistentData=c:nt.freeType(c)}else if("number"==typeof r[0]){e.dimension=i;var f=nt.allocType(e.dtype,r.length);gt(f,r),u(e,f,n),a?e.persistentData=f:nt.freeType(f)}else t(r[0])?(e.dimension=r[0].length,e.dtype=o||vt(r[0])||yt,c=ft(r,[r.length,r[0].length],e.dtype),u(e,c,n),a?e.persistentData=c:nt.freeType(c)):M.raise("invalid buffer data")}else if(t(r))e.dtype=o||vt(r),e.dimension=i,u(e,r,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(r.buffer)));else if(it(r)){s=r.shape;var _=r.stride,d=r.offset,m=0,h=0,y=0,b=0;1===s.length?(m=s[0],h=1,y=_[0],b=0):2===s.length?(m=s[0],h=s[1],y=_[0],b=_[1]):M.raise("invalid shape"),e.dtype=o||vt(r.data)||yt,e.dimension=h;var v=nt.allocType(e.dtype,m*h);At(v,r.data,m,h,y,b,d),u(e,v,n),a?e.persistentData=v:nt.freeType(v)}else r instanceof ArrayBuffer?(e.dtype=ht,e.dimension=i,u(e,r,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(r)))):M.raise("invalid buffer data")}function l(t){r.bufferCount--,o(t);var n=t.buffer;M(n,"buffer must not be deleted already"),e.deleteBuffer(n),t.buffer=null,delete a[t.id]}return n.profile&&(r.getTotalBufferSize=function(){var t=0;return Object.keys(a).forEach(function(e){t+=a[e].stats.size}),t}),{create:function(o,i,c,u){r.bufferCount++;var f=new s(i);function _(r){var o=dt,i=null,a=0,s=0,c=1;return Array.isArray(r)||t(r)||it(r)||r instanceof ArrayBuffer?i=r:"number"==typeof r?a=0|r:r&&(M.type(r,"object","buffer arguments must be an object, a number or an array"),"data"in r&&(M(null===i||Array.isArray(i)||t(i)||it(i),"invalid data for buffer"),i=r.data),"usage"in r&&(M.parameter(r.usage,lt,"invalid buffer usage"),o=lt[r.usage]),"type"in r&&(M.parameter(r.type,pt,"invalid buffer type"),s=pt[r.type]),"dimension"in r&&(M.type(r.dimension,"number","invalid dimension"),c=0|r.dimension),"length"in r&&(M.nni(a,"buffer length must be a nonnegative integer"),a=0|r.length)),f.bind(),i?p(f,i,o,s,c,u):(a&&e.bufferData(f.type,a,o),f.dtype=s||ht,f.usage=o,f.dimension=c,f.byteLength=a),n.profile&&(f.stats.size=f.byteLength*bt[f.dtype]),_}function d(t,r){M(r+t.byteLength<=f.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+r+" to a buffer of size "+f.byteLength),e.bufferSubData(f.type,r,t)}return a[f.id]=f,c||_(o),_._reglType="buffer",_._buffer=f,_.subdata=function(e,r){var n,o=0|(r||0);if(f.bind(),t(e)||e instanceof ArrayBuffer)d(e,o);else if(Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var i=nt.allocType(f.dtype,e.length);gt(i,e),d(i,o),nt.freeType(i)}else if(Array.isArray(e[0])||t(e[0])){n=_t(e);var a=ft(e,n,f.dtype);d(a,o),nt.freeType(a)}else M.raise("invalid buffer data")}else if(it(e)){n=e.shape;var s=e.stride,c=0,u=0,p=0,l=0;1===n.length?(c=n[0],u=1,p=s[0],l=0):2===n.length?(c=n[0],u=n[1],p=s[0],l=s[1]):M.raise("invalid shape");var m=Array.isArray(e.data)?f.dtype:vt(e.data),h=nt.allocType(m,c*u);At(h,e.data,c,u,p,l,e.offset),d(h,o),nt.freeType(h)}else M.raise("invalid data for buffer subdata");return _},n.profile&&(_.stats=f.stats),_.destroy=function(){l(f)},_},createStream:function(t,e){var r=c.pop();return r||(r=new s(t)),r.bind(),p(r,e,mt,0,1,!1),r},destroyStream:function(t){c.push(t)},clear:function(){at(a).forEach(l),c.forEach(l)},getBuffer:function(t){return t&&t._buffer instanceof s?t._buffer:null},restore:function(){at(a).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:p}}(o,l,n,function(t){return g.destroyBuffer(t)}),g=function(e,r,n,o,i){for(var a=n.maxAttributes,s=new Array(a),c=0;c<a;++c)s[c]=new Wr;var u=0,p={},l={Record:Wr,scope:{},state:s,currentVAO:null,targetVAO:null,restore:f()?function(){f()&&at(p).forEach(function(t){t.refresh()})}:function(){},createVAO:function(e){var n=new d;function s(e){M(Array.isArray(e),"arguments to vertex array constructor must be an array"),M(e.length<a,"too many attributes"),M(e.length>0,"must specify at least one attribute");var o={},c=n.attributes;c.length=e.length;for(var u=0;u<e.length;++u){var p,l=e[u],f=c[u]=new Wr,_=l.data||l;Array.isArray(_)||t(_)||it(_)?(n.buffers[u]&&(p=n.buffers[u],t(_)&&p._buffer.byteLength>=_.byteLength?p.subdata(_):(p.destroy(),n.buffers[u]=null)),n.buffers[u]||(p=n.buffers[u]=i.create(l,Ur,!1,!0)),f.buffer=i.getBuffer(p),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1,o[u]=1):i.getBuffer(l)?(f.buffer=i.getBuffer(l),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1):i.getBuffer(l.buffer)?(f.buffer=i.getBuffer(l.buffer),f.size=0|(+l.size||f.buffer.dimension),f.normalized=!!l.normalized||!1,"type"in l?(M.parameter(l.type,pt,"invalid buffer type"),f.type=pt[l.type]):f.type=f.buffer.dtype,f.offset=0|(l.offset||0),f.stride=0|(l.stride||0),f.divisor=0|(l.divisor||0),f.state=1,M(f.size>=1&&f.size<=4,"size must be between 1 and 4"),M(f.offset>=0,"invalid offset"),M(f.stride>=0&&f.stride<=255,"stride must be between 0 and 255"),M(f.divisor>=0,"divisor must be positive"),M(!f.divisor||!!r.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in l?(M(u>0,"first attribute must not be a constant"),f.x=+l.x||0,f.y=+l.y||0,f.z=+l.z||0,f.w=+l.w||0,f.state=2):M(!1,"invalid attribute spec for location "+u)}for(var d=0;d<n.buffers.length;++d)!o[d]&&n.buffers[d]&&(n.buffers[d].destroy(),n.buffers[d]=null);return n.refresh(),s}return o.vaoCount+=1,s.destroy=function(){for(var t=0;t<n.buffers.length;++t)n.buffers[t]&&n.buffers[t].destroy();n.buffers.length=0,n.destroy()},s._vao=n,s._reglType="vao",s(e)},getVAO:function(t){return"function"==typeof t&&t._vao?t._vao:null},destroyBuffer:function(t){for(var r=0;r<s.length;++r){var n=s[r];n.buffer===t&&(e.disableVertexAttribArray(r),n.buffer=null)}},setVAO:f()?function(t){if(t!==l.currentVAO){var e=f();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),l.currentVAO=t}}:function(t){if(t!==l.currentVAO){if(t)t.bindAttrs();else for(var r=_(),n=0;n<s.length;++n){var o=s[n];o.buffer?(e.enableVertexAttribArray(n),e.vertexAttribPointer(n,o.size,o.type,o.normalized,o.stride,o.offfset),r&&o.divisor&&r.vertexAttribDivisorANGLE(n,o.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,o.x,o.y,o.z,o.w))}l.currentVAO=t}},clear:f()?function(){at(p).forEach(function(t){t.destroy()})}:function(){}};function f(){return r.oes_vertex_array_object}function _(){return r.angle_instanced_arrays}function d(){this.id=++u,this.attributes=[];var t=f();this.vao=t?t.createVertexArrayOES():null,p[this.id]=this,this.buffers=[]}return d.prototype.bindAttrs=function(){for(var t=_(),r=this.attributes,n=0;n<r.length;++n){var o=r[n];o.buffer?(e.enableVertexAttribArray(n),e.bindBuffer(Ur,o.buffer.buffer),e.vertexAttribPointer(n,o.size,o.type,o.normalized,o.stride,o.offset),t&&o.divisor&&t.vertexAttribDivisorANGLE(n,o.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,o.x,o.y,o.z,o.w))}for(var i=r.length;i<a;++i)e.disableVertexAttribArray(i)},d.prototype.refresh=function(){var t=f();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),l.currentVAO=this)},d.prototype.destroy=function(){if(this.vao){var t=f();this===l.currentVAO&&(l.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}p[this.id]&&(delete p[this.id],o.vaoCount-=1)},l}(o,f,b,l,v),A=function(e,r,n,o){var i={},a=0,s={uint8:jt,uint16:Ct};function c(t){this.id=a++,i[this.id]=this,this.buffer=t,this.primType=Ot,this.vertCount=0,this.type=0}r.oes_element_index_uint&&(s.uint32=It),c.prototype.bind=function(){this.buffer.bind()};var u=[];function p(o,i,a,s,c,u,p){var l;if(o.buffer.bind(),i){var f=p;p||t(i)&&(!it(i)||t(i.data))||(f=r.oes_element_index_uint?It:Ct),n._initBuffer(o.buffer,i,a,f,3)}else e.bufferData(Pt,u,a),o.buffer.dtype=l||jt,o.buffer.usage=a,o.buffer.dimension=3,o.buffer.byteLength=u;if(l=p,!p){switch(o.buffer.dtype){case jt:case Tt:l=jt;break;case Ct:case St:l=Ct;break;case It:case Dt:l=It;break;default:M.raise("unsupported type for element array")}o.buffer.dtype=l}o.type=l,M(l!==It||!!r.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var _=c;_<0&&(_=o.buffer.byteLength,l===Ct?_>>=1:l===It&&(_>>=2)),o.vertCount=_;var d=s;if(s<0){d=Ot;var m=o.buffer.dimension;1===m&&(d=xt),2===m&&(d=Et),3===m&&(d=Ot)}o.primType=d}function l(t){o.elementsCount--,M(null!==t.buffer,"must not double destroy elements"),delete i[t.id],t.buffer.destroy(),t.buffer=null}return{create:function(e,r){var i=n.create(null,Pt,!0),a=new c(i._buffer);function u(e){if(e)if("number"==typeof e)i(e),a.primType=Ot,a.vertCount=0|e,a.type=jt;else{var r=null,n=Ft,o=-1,c=-1,l=0,f=0;Array.isArray(e)||t(e)||it(e)?r=e:(M.type(e,"object","invalid arguments for elements"),"data"in e&&(r=e.data,M(Array.isArray(r)||t(r)||it(r),"invalid data for element buffer")),"usage"in e&&(M.parameter(e.usage,lt,"invalid element buffer usage"),n=lt[e.usage]),"primitive"in e&&(M.parameter(e.primitive,wt,"invalid element buffer primitive"),o=wt[e.primitive]),"count"in e&&(M("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),c=0|e.count),"type"in e&&(M.parameter(e.type,s,"invalid buffer type"),f=s[e.type]),"length"in e?l=0|e.length:(l=c,f===Ct||f===St?l*=2:f!==It&&f!==Dt||(l*=4))),p(a,r,n,o,c,l,f)}else i(),a.primType=Ot,a.vertCount=0,a.type=jt;return u}return o.elementsCount++,u(e),u._reglType="elements",u._elements=a,u.subdata=function(t,e){return i.subdata(t,e),u},u.destroy=function(){l(a)},u},createStream:function(t){var e=u.pop();return e||(e=new c(n.create(null,Pt,!0,!1)._buffer)),p(e,t,Mt,-1,-1,0,0),e},destroyStream:function(t){u.push(t)},getElements:function(t){return"function"==typeof t&&t._elements instanceof c?t._elements:null},clear:function(){at(i).forEach(l)}}}(o,f,v,l),w=function(t,r,n,o){var i={},a={};function s(t,e,r,n){this.name=t,this.id=e,this.location=r,this.info=n}function c(t,e){for(var r=0;r<t.length;++r)if(t[r].id===e.id)return void(t[r].location=e.location);t.push(e)}function u(e,n,o){var s=e===Hr?i:a,c=s[n];if(!c){var u=r.str(n);c=t.createShader(e),t.shaderSource(c,u),t.compileShader(c),M.shaderError(t,c,u,e,o),s[n]=c}return c}var p={},l=[],f=0;function _(t,e){this.id=f++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,o.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function d(e,n,i){var a,p,l=u(Hr,e.fragId),f=u(Vr,e.vertId),_=e.program=t.createProgram();if(t.attachShader(_,l),t.attachShader(_,f),i)for(a=0;a<i.length;++a){var d=i[a];t.bindAttribLocation(_,d[0],d[1])}t.linkProgram(_),M.linkError(t,_,r.str(e.fragId),r.str(e.vertId),n);var m=t.getProgramParameter(_,Yr);o.profile&&(e.stats.uniformsCount=m);var h=e.uniforms;for(a=0;a<m;++a)if(p=t.getActiveUniform(_,a))if(p.size>1)for(var y=0;y<p.size;++y){var b=p.name.replace("[0]","["+y+"]");c(h,new s(b,r.id(b),t.getUniformLocation(_,b),p))}else c(h,new s(p.name,r.id(p.name),t.getUniformLocation(_,p.name),p));var v=t.getProgramParameter(_,Qr);o.profile&&(e.stats.attributesCount=v);var g=e.attributes;for(a=0;a<v;++a)(p=t.getActiveAttrib(_,a))&&c(g,new s(p.name,r.id(p.name),t.getAttribLocation(_,p.name),p))}return o.profile&&(n.getMaxUniformsCount=function(){var t=0;return l.forEach(function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)}),t},n.getMaxAttributesCount=function(){var t=0;return l.forEach(function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)}),t}),{clear:function(){var e=t.deleteShader.bind(t);at(i).forEach(e),i={},at(a).forEach(e),a={},l.forEach(function(e){t.deleteProgram(e.program)}),l.length=0,p={},n.shaderCount=0},program:function(r,o,s,c){M.command(r>=0,"missing vertex shader",s),M.command(o>=0,"missing fragment shader",s);var u=p[o];u||(u=p[o]={});var f=u[r];if(f&&(f.refCount++,!c))return f;var m=new _(o,r);return n.shaderCount++,d(m,s,c),f||(u[r]=m),l.push(m),e(m,{destroy:function(){if(m.refCount--,m.refCount<=0){t.deleteProgram(m.program);var e=l.indexOf(m);l.splice(e,1),n.shaderCount--}u[m.vertId].refCount<=0&&(t.deleteShader(a[m.vertId]),delete a[m.vertId],delete p[m.fragId][m.vertId]),Object.keys(p[m.fragId]).length||(t.deleteShader(i[m.fragId]),delete i[m.fragId],delete p[m.fragId])}})},restore:function(){i={},a={};for(var t=0;t<l.length;++t)d(l[t],null,l[t].attributes.map(function(t){return[t.location,t.name]}))},shader:u,frag:-1,vert:-1}}(o,p,l,n),x=yr(o,f,b,function(){T.procs.poll()},y,l,n),E=wr(o,f,b,l,n),O=function(t,r,n,o,i,a){var s={cur:null,next:null,dirty:!1,setFBO:null},c=["rgba"],u=["rgba4","rgb565","rgb5 a1"];r.ext_srgb&&u.push("srgba"),r.ext_color_buffer_half_float&&u.push("rgba16f","rgb16f"),r.webgl_color_buffer_float&&u.push("rgba32f");var p=["uint8"];function l(t,e,r){this.target=t,this.texture=e,this.renderbuffer=r;var n=0,o=0;e?(n=e.width,o=e.height):r&&(n=r.width,o=r.height),this.width=n,this.height=o}function f(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function _(t,e,r){if(t)if(t.texture){var n=t.texture._texture,o=Math.max(1,n.width),i=Math.max(1,n.height);M(o===e&&i===r,"inconsistent width/height for supplied texture"),n.refCount+=1}else{var a=t.renderbuffer._renderbuffer;M(a.width===e&&a.height===r,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function d(e,r){r&&(r.texture?t.framebufferTexture2D(xr,e,r.target,r.texture._texture.texture,0):t.framebufferRenderbuffer(xr,e,Er,r.renderbuffer._renderbuffer.renderbuffer))}function m(t){var e=Or,r=null,n=null,o=t;"object"==typeof t&&(o=t.data,"target"in t&&(e=0|t.target)),M.type(o,"function","invalid attachment data");var i=o._reglType;return"texture2d"===i?(r=o,M(e===Or)):"textureCube"===i?(r=o,M(e>=Tr&&e<Tr+6,"invalid cube map target")):"renderbuffer"===i?(n=o,e=Er):M.raise("invalid regl object for attachment"),new l(e,r,n)}function h(t,e,r,n,a){if(r){var s=o.create2D({width:t,height:e,format:n,type:a});return s._texture.refCount=0,new l(Or,s,null)}var c=i.create({width:t,height:e,format:n});return c._renderbuffer.refCount=0,new l(Er,null,c)}function y(t){return t&&(t.texture||t.renderbuffer)}function b(t,e,r){t&&(t.texture?t.texture.resize(e,r):t.renderbuffer&&t.renderbuffer.resize(e,r),t.width=e,t.height=r)}r.oes_texture_half_float&&p.push("half float","float16"),r.oes_texture_float&&p.push("float","float32");var v=0,g={};function A(){this.id=v++,g[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function w(t){t.colorAttachments.forEach(f),f(t.depthAttachment),f(t.stencilAttachment),f(t.depthStencilAttachment)}function x(e){var r=e.framebuffer;M(r,"must not double destroy framebuffer"),t.deleteFramebuffer(r),e.framebuffer=null,a.framebufferCount--,delete g[e.id]}function E(e){var r;t.bindFramebuffer(xr,e.framebuffer);var o=e.colorAttachments;for(r=0;r<o.length;++r)d(jr+r,o[r]);for(r=o.length;r<n.maxColorAttachments;++r)t.framebufferTexture2D(xr,jr+r,Or,null,0);t.framebufferTexture2D(xr,Dr,Or,null,0),t.framebufferTexture2D(xr,Sr,Or,null,0),t.framebufferTexture2D(xr,Cr,Or,null,0),d(Sr,e.depthAttachment),d(Cr,e.stencilAttachment),d(Dr,e.depthStencilAttachment);var i=t.checkFramebufferStatus(xr);t.isContextLost()||i===Ir||M.raise("framebuffer configuration not supported, status = "+Nr[i]),t.bindFramebuffer(xr,s.next?s.next.framebuffer:null),s.cur=s.next,t.getError()}function O(t,o){var i=new A;function l(t,e){var o;M(s.next!==i,"can not update framebuffer which is currently in use");var a=0,f=0,d=!0,b=!0,v=null,g=!0,A="rgba",x="uint8",O=1,T=null,j=null,S=null,C=!1;if("number"==typeof t)a=0|t,f=0|e||a;else if(t){M.type(t,"object","invalid arguments for framebuffer");var D=t;if("shape"in D){var I=D.shape;M(Array.isArray(I)&&I.length>=2,"invalid shape for framebuffer"),a=I[0],f=I[1]}else"radius"in D&&(a=f=D.radius),"width"in D&&(a=D.width),"height"in D&&(f=D.height);("color"in D||"colors"in D)&&(v=D.color||D.colors,Array.isArray(v)&&M(1===v.length||r.webgl_draw_buffers,"multiple render targets not supported")),v||("colorCount"in D&&(O=0|D.colorCount,M(O>0,"invalid color buffer count")),"colorTexture"in D&&(g=!!D.colorTexture,A="rgba4"),"colorType"in D&&(x=D.colorType,g?(M(r.oes_texture_float||!("float"===x||"float32"===x),"you must enable OES_texture_float in order to use floating point framebuffer objects"),M(r.oes_texture_half_float||!("half float"===x||"float16"===x),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===x||"float16"===x?(M(r.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),A="rgba16f"):"float"!==x&&"float32"!==x||(M(r.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),A="rgba32f"),M.oneOf(x,p,"invalid color type")),"colorFormat"in D&&(A=D.colorFormat,c.indexOf(A)>=0?g=!0:u.indexOf(A)>=0?g=!1:g?M.oneOf(D.colorFormat,c,"invalid color format for texture"):M.oneOf(D.colorFormat,u,"invalid color format for renderbuffer"))),("depthTexture"in D||"depthStencilTexture"in D)&&(C=!(!D.depthTexture&&!D.depthStencilTexture),M(!C||r.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in D&&("boolean"==typeof D.depth?d=D.depth:(T=D.depth,b=!1)),"stencil"in D&&("boolean"==typeof D.stencil?b=D.stencil:(j=D.stencil,d=!1)),"depthStencil"in D&&("boolean"==typeof D.depthStencil?d=b=D.depthStencil:(S=D.depthStencil,d=!1,b=!1))}else a=f=1;var P=null,F=null,k=null,R=null;if(Array.isArray(v))P=v.map(m);else if(v)P=[m(v)];else for(P=new Array(O),o=0;o<O;++o)P[o]=h(a,f,g,A,x);M(r.webgl_draw_buffers||P.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),M(P.length<=n.maxColorAttachments,"too many color attachments, not supported"),a=a||P[0].width,f=f||P[0].height,T?F=m(T):d&&!b&&(F=h(a,f,C,"depth","uint32")),j?k=m(j):b&&!d&&(k=h(a,f,!1,"stencil","uint8")),S?R=m(S):!T&&!j&&b&&d&&(R=h(a,f,C,"depth stencil","depth stencil")),M(!!T+!!j+!!S<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var B=null;for(o=0;o<P.length;++o)if(_(P[o],a,f),M(!P[o]||P[o].texture&&Mr.indexOf(P[o].texture._texture.format)>=0||P[o].renderbuffer&&Gr.indexOf(P[o].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+o+" is invalid"),P[o]&&P[o].texture){var z=Fr[P[o].texture._texture.format]*kr[P[o].texture._texture.type];null===B?B=z:M(B===z,"all color attachments much have the same number of bits per pixel.")}return _(F,a,f),M(!F||F.texture&&F.texture._texture.format===Pr||F.renderbuffer&&F.renderbuffer._renderbuffer.format===Rr,"invalid depth attachment for framebuffer object"),_(k,a,f),M(!k||k.renderbuffer&&k.renderbuffer._renderbuffer.format===Br,"invalid stencil attachment for framebuffer object"),_(R,a,f),M(!R||R.texture&&R.texture._texture.format===zr||R.renderbuffer&&R.renderbuffer._renderbuffer.format===zr,"invalid depth-stencil attachment for framebuffer object"),w(i),i.width=a,i.height=f,i.colorAttachments=P,i.depthAttachment=F,i.stencilAttachment=k,i.depthStencilAttachment=R,l.color=P.map(y),l.depth=y(F),l.stencil=y(k),l.depthStencil=y(R),l.width=i.width,l.height=i.height,E(i),l}return a.framebufferCount++,l(t,o),e(l,{resize:function(t,e){M(s.next!==i,"can not resize a framebuffer which is currently in use");var r=Math.max(0|t,1),n=Math.max(0|e||r,1);if(r===i.width&&n===i.height)return l;for(var o=i.colorAttachments,a=0;a<o.length;++a)b(o[a],r,n);return b(i.depthAttachment,r,n),b(i.stencilAttachment,r,n),b(i.depthStencilAttachment,r,n),i.width=l.width=r,i.height=l.height=n,E(i),l},_reglType:"framebuffer",_framebuffer:i,destroy:function(){x(i),w(i)},use:function(t){s.setFBO({framebuffer:l},t)}})}return e(s,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof A)return e}return null},create:O,createCube:function(t){var i=Array(6);function a(t){var n;M(i.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var u,l={color:null},f=0,_=null,d="rgba",m="uint8",h=1;if("number"==typeof t)f=0|t;else if(t){M.type(t,"object","invalid arguments for framebuffer");var y=t;if("shape"in y){var b=y.shape;M(Array.isArray(b)&&b.length>=2,"invalid shape for framebuffer"),M(b[0]===b[1],"cube framebuffer must be square"),f=b[0]}else"radius"in y&&(f=0|y.radius),"width"in y?(f=0|y.width,"height"in y&&M(y.height===f,"must be square")):"height"in y&&(f=0|y.height);("color"in y||"colors"in y)&&(_=y.color||y.colors,Array.isArray(_)&&M(1===_.length||r.webgl_draw_buffers,"multiple render targets not supported")),_||("colorCount"in y&&(h=0|y.colorCount,M(h>0,"invalid color buffer count")),"colorType"in y&&(M.oneOf(y.colorType,p,"invalid color type"),m=y.colorType),"colorFormat"in y&&(d=y.colorFormat,M.oneOf(y.colorFormat,c,"invalid color format for texture"))),"depth"in y&&(l.depth=y.depth),"stencil"in y&&(l.stencil=y.stencil),"depthStencil"in y&&(l.depthStencil=y.depthStencil)}else f=1;if(_)if(Array.isArray(_))for(u=[],n=0;n<_.length;++n)u[n]=_[n];else u=[_];else{u=Array(h);var v={radius:f,format:d,type:m};for(n=0;n<h;++n)u[n]=o.createCube(v)}for(l.color=Array(u.length),n=0;n<u.length;++n){var g=u[n];M("function"==typeof g&&"textureCube"===g._reglType,"invalid cube map"),f=f||g.width,M(g.width===f&&g.height===f,"invalid cube map shape"),l.color[n]={target:Tr,data:u[n]}}for(n=0;n<6;++n){for(var A=0;A<u.length;++A)l.color[A].target=Tr+n;n>0&&(l.depth=i[0].depth,l.stencil=i[0].stencil,l.depthStencil=i[0].depthStencil),i[n]?i[n](l):i[n]=O(l)}return e(a,{width:f,height:f,color:u})}return a(t),e(a,{faces:i,resize:function(t){var e,r=0|t;if(M(r>0&&r<=n.maxCubeMapSize,"invalid radius for cube fbo"),r===a.width)return a;var o=a.color;for(e=0;e<o.length;++e)o[e].resize(r);for(e=0;e<6;++e)i[e].resize(r);return a.width=a.height=r,a},_reglType:"framebufferCube",destroy:function(){i.forEach(function(t){t.destroy()})}})},clear:function(){at(g).forEach(x)},restore:function(){s.cur=null,s.next=null,s.dirty=!0,at(g).forEach(function(e){e.framebuffer=t.createFramebuffer(),E(e)})}})}(o,f,b,x,E,l),T=ci(o,p,f,b,v,A,0,O,{},g,w,{elements:null,primitive:4,count:-1,offset:0,instances:-1},y,_,n),j=Zr(o,O,T.procs.poll,y,i,f,b),S=T.next,C=o.canvas,D=[],I=[],P=[],F=[n.onDestroy],k=null;function R(){if(0===D.length)return _&&_.update(),void(k=null);k=U.next(R),$();for(var t=D.length-1;t>=0;--t){var e=D[t];e&&e(y,null,0)}o.flush(),_&&_.update()}function B(){!k&&D.length>0&&(k=U.next(R))}function z(){k&&(U.cancel(R),k=null)}function G(t){t.preventDefault(),a=!0,z(),I.forEach(function(t){t()})}function N(t){o.getError(),a=!1,s.restore(),w.restore(),v.restore(),x.restore(),E.restore(),O.restore(),g.restore(),_&&_.restore(),T.procs.refresh(),B(),P.forEach(function(t){t()})}function H(t){function r(t,e){var r={},n={};return Object.keys(t).forEach(function(o){var i=t[o];if(L.isDynamic(i))n[o]=L.unbox(i,o);else{if(e&&Array.isArray(i))for(var a=0;a<i.length;++a)if(L.isDynamic(i[a]))return void(n[o]=L.unbox(i,o));r[o]=i}}),{dynamic:n,static:r}}M(!!t,"invalid args to regl({...})"),M.type(t,"object","invalid args to regl({...})");var n=r(t.context||{},!0),o=r(t.uniforms||{},!0),i=r(t.attributes||{},!1),s=r(function(t){var r=e({},t);function n(t){if(t in r){var e=r[t];delete r[t],Object.keys(e).forEach(function(n){r[t+"."+n]=e[n]})}}return delete r.uniforms,delete r.attributes,delete r.context,delete r.vao,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),n("blend"),n("depth"),n("cull"),n("stencil"),n("polygonOffset"),n("scissor"),n("sample"),"vao"in t&&(r.vao=t.vao),r}(t),!1),c={gpuTime:0,cpuTime:0,count:0},u=T.compile(s,i,o,n,c),p=u.draw,l=u.batch,f=u.scope,_=[];return e(function(t,e){var r;if(a&&M.raise("context lost"),"function"==typeof t)return f.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(r=0;r<t;++r)f.call(this,null,e,r);else{if(!Array.isArray(t))return f.call(this,t,e,0);for(r=0;r<t.length;++r)f.call(this,t[r],e,r)}else if("number"==typeof t){if(t>0)return l.call(this,function(t){for(;_.length<t;)_.push(null);return _}(0|t),0|t)}else{if(!Array.isArray(t))return p.call(this,t);if(t.length)return l.call(this,t,t.length)}},{stats:c,destroy:function(){u.destroy()}})}C&&(C.addEventListener(yi,G,!1),C.addEventListener(bi,N,!1));var V=O.setFBO=H({framebuffer:L.define.call(null,vi,"framebuffer")});function Q(t,e){var r=0;T.procs.poll();var n=e.color;n&&(o.clearColor(+n[0]||0,+n[1]||0,+n[2]||0,+n[3]||0),r|=_i),"depth"in e&&(o.clearDepth(+e.depth),r|=di),"stencil"in e&&(o.clearStencil(0|e.stencil),r|=mi),M(!!r,"called regl.clear with no buffer specified"),o.clear(r)}function q(t){return M.type(t,"function","regl.frame() callback must be a function"),D.push(t),B(),{cancel:function(){var e=wi(D,t);M(e>=0,"cannot cancel a frame twice"),D[e]=function t(){var e=wi(D,t);D[e]=D[D.length-1],D.length-=1,D.length<=0&&z()}}}}function K(){var t=S.viewport,e=S.scissor_box;t[0]=t[1]=e[0]=e[1]=0,y.viewportWidth=y.framebufferWidth=y.drawingBufferWidth=t[2]=e[2]=o.drawingBufferWidth,y.viewportHeight=y.framebufferHeight=y.drawingBufferHeight=t[3]=e[3]=o.drawingBufferHeight}function $(){y.tick+=1,y.time=Z(),K(),T.procs.poll()}function X(){x.refresh(),K(),T.procs.refresh(),_&&_.update()}function Z(){return(W()-d)/1e3}X();var J=e(H,{clear:function(t){if(M("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var r=0;r<6;++r)V(e({framebuffer:t.framebuffer.faces[r]},t),Q);else V(t,Q);else Q(null,t)},prop:L.define.bind(null,vi),context:L.define.bind(null,gi),this:L.define.bind(null,Ai),draw:H({}),buffer:function(t){return v.create(t,hi,!1,!1)},elements:function(t){return A.create(t,!1)},texture:x.create2D,cube:x.createCube,renderbuffer:E.create,framebuffer:O.create,framebufferCube:O.createCube,vao:g.createVAO,attributes:i,frame:q,on:function(t,e){var r;switch(M.type(e,"function","listener callback must be a function"),t){case"frame":return q(e);case"lost":r=I;break;case"restore":r=P;break;case"destroy":r=F;break;default:M.raise("invalid event, must be one of frame,lost,restore,destroy")}return r.push(e),{cancel:function(){for(var t=0;t<r.length;++t)if(r[t]===e)return r[t]=r[r.length-1],void r.pop()}}},limits:b,hasExtension:function(t){return b.extensions.indexOf(t.toLowerCase())>=0},read:j,destroy:function(){D.length=0,z(),C&&(C.removeEventListener(yi,G),C.removeEventListener(bi,N)),w.clear(),O.clear(),E.clear(),x.clear(),A.clear(),v.clear(),g.clear(),_&&_.clear(),F.forEach(function(t){t()})},_gl:o,_refresh:X,poll:function(){$(),_&&_.update()},now:Z,stats:l});return n.onDone(null,J),J}}()}),Xi=function(t,e,r,n){var o=r?r.call(n,t,e):void 0;if(void 0!==o)return!!o;if(t===e)return!0;if("object"!=typeof t||!t||"object"!=typeof e||!e)return!1;var i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(e),c=0;c<i.length;c++){var u=i[c];if(!s(u))return!1;var p=t[u],l=e[u];if(!1===(o=r?r.call(n,p,l,u):void 0)||void 0===o&&p!==l)return!1}return!0};var Zi=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};class Ji{constructor(){l(this,"_objectsByObjectHitmapIdMap",{}),l(this,"_commandsByObjectMap",new Map),l(this,"_nextObjectHitmapId",1),l(this,"_instanceIndexByObjectHitmapIdMap",{}),l(this,"assignNextColors",(t,e,r)=>{if(r<1)throw new Error("Must get at least 1 id");const n=function(t,e){return new Array(e).fill(0).map((e,r)=>t+r)}(this._nextObjectHitmapId,r);this._nextObjectHitmapId=Zi(n)+1,r>1&&n.forEach((t,e)=>{this._instanceIndexByObjectHitmapIdMap[t]=e});for(const t of n)this._objectsByObjectHitmapIdMap[t]=e;return this._commandsByObjectMap.set(e,t),n.map(t=>ko(t))}),l(this,"getObjectByObjectHitmapId",t=>({object:this._objectsByObjectHitmapIdMap[t],instanceIndex:this._instanceIndexByObjectHitmapIdMap[t]})),l(this,"getCommandForObject",t=>this._commandsByObjectMap.get(t))}}function ta(t){let e=!1;const r=[];function n(...o){if(e){const t=function(){let t,e;const r=new Promise((r,n)=>{t=r,e=n});return r.resolve=t,r.reject=e,r}();return r.push({args:o,promise:t}),t}return function o(...i){e=!0;const a=t(...i).finally(()=>{if(e=!1,n.currentPromise=void 0,r.length){const{promise:t,args:e}=r.shift();o(...e).then(e=>t.resolve(e)).catch(e=>t.reject(e))}});n.currentPromise=a;return a}(...o)}return n}function ea(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function ra(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ea(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ea(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function na(t,e){const r=e(t);return"function"==typeof r?r:t(r)}class oa{constructor({dimension:t,canvasBackgroundColor:e,cameraState:r,onCameraStateChange:n,contextAttributes:o}){l(this,"_commands",new Set),l(this,"_compiled",new Map),l(this,"_drawCalls",new Map),l(this,"_frame",void 0),l(this,"_needsPaint",!1),l(this,"_paintCalls",new Map),l(this,"_hitmapObjectIdManager",new Ji),l(this,"_cachedReadHitmapCall",void 0),l(this,"reglCommandObjects",[]),l(this,"counters",{}),l(this,"dimension",void 0),l(this,"onDirty",void 0),l(this,"cameraStore",void 0),l(this,"canvasBackgroundColor",[0,0,0,1]),l(this,"initializedData",void 0),l(this,"contextAttributes",void 0),l(this,"destroyed",!1),l(this,"raycast",(t,e)=>{if(!this.initializedData)return;const{width:r,height:n}=this.dimension;return Vi(this.initializedData.camera,{clientX:t,clientY:e,width:r,height:n})}),l(this,"onDirty",()=>{void 0===this._frame?this._frame=requestAnimationFrame(()=>this.paint()):this._needsPaint=!0}),l(this,"readHitmap",ta((t,e,r,n)=>{if(!this.initializedData)return Promise.reject(new Error("regl data not initialized yet"));const o=[t,e,r,n],i=this._cachedReadHitmapCall;if(i){if(Xi(i.arguments,o)){const t=i.result.map(([t,e])=>[ra({},t),e]);return Promise.resolve(t)}this._cachedReadHitmapCall=void 0}const{regl:a,camera:s,_fbo:c}=this.initializedData,{width:u,height:p}=this.dimension,l=t,f=p-e;return c.resize(Math.floor(u),Math.floor(p)),new Promise(t=>{a({framebuffer:c})(()=>{a.clear({color:ko(0),depth:1});let e=0;const i=[],c=[];let _=0;s.draw(this.cameraStore.state,()=>{do{if(_>=n){console.error(`Hit ${n} iterations. There is either a bug or that number of rendered hitmap layers under the mouse cursor.`);break}if(_++,a.clear({color:ko(0),depth:1}),this._drawInput(!0,i),l<Math.floor(u)&&f<Math.floor(p)&&l>=0&&f>=0){const t=new Uint8Array(4);a.read({x:l,y:f,width:1,height:1,data:t}),e=Ro(t);const r=this._hitmapObjectIdManager.getObjectByObjectHitmapId(e);if(e>0&&!r&&console.error(`Clicked on an unknown object with id ${e}. This likely means that a command is painting an incorrect color into the hitmap.`),i.some(({object:t,instanceIndex:e})=>t===r.object&&e===r.instanceIndex)){console.error("Saw object twice when reading from hitmap. There is likely an error in getHitmapFromChildren",r);break}if(e>0&&r.object){const t=this._hitmapObjectIdManager.getCommandForObject(r.object);i.push(r),t&&c.push([r,t])}}}while(0!==e&&r);this._cachedReadHitmapCall={arguments:o,result:c},t(c)})})})})),l(this,"_drawInput",(t,e)=>{t&&(this._hitmapObjectIdManager=new Ji),Array.from(this._drawCalls.values()).sort((t,e)=>(t.layerIndex||0)-(e.layerIndex||0)).forEach(r=>{const{reglCommand:n,children:o,instance:i,getChildrenForHitmap:a}=r;if(!o)return console.debug(`${t?"hitmap":""} draw skipped, props was falsy`,r);const s=this._compiled.get(n);if(!s)return console.warn("could not find draw command for",i?i.constructor.displayName:"Unknown");if(t&&a){const t=a(o,(...t)=>this._hitmapObjectIdManager.assignNextColors(i,...t),e||[]);t&&s(t,!0)}else t||s(o,!1)})}),l(this,"_clearCanvas",t=>{t.poll(),t.clear({color:this.canvasBackgroundColor,depth:1})}),this.dimension=t,this.canvasBackgroundColor=e,this.contextAttributes=o,this.cameraStore=new ni(t=>{n?n(t):this.paint()},r)}initialize(t){if(this.initializedData)throw new Error("can not initialize regl twice");const e=this._instrumentCommands($i({canvas:t,attributes:this.contextAttributes||{},extensions:["angle_instanced_arrays","oes_texture_float","oes_element_index_uint","oes_standard_derivatives"],profile:"production"!==Li()}));if(!e)throw new Error("Cannot initialize regl");this._commands.forEach(t=>{const r=na(e,t);this._compiled.set(t,r)});const r=new(na(e,gi)),n=e.framebuffer({width:Math.round(this.dimension.width),height:Math.round(this.dimension.height)});this.initializedData={_fbo:n,camera:r,regl:e}}destroy(){this.destroyed=!0,this.initializedData&&this.initializedData.regl.destroy(),this._frame&&cancelAnimationFrame(this._frame)}onMount(t,e){const{initializedData:r}=this;r&&!this._commands.has(e)&&(this._commands.add(e),this._compiled.set(e,na(r.regl,e)))}onUnmount(t){this._drawCalls.delete(t)}unregisterPaintCallback(t){this._paintCalls.delete(t)}registerDrawCall(t){this._drawCalls.set(t.instance,t)}registerPaintCallback(t){this._paintCalls.set(t,t)}setDimension(t){this.dimension=t}paint(){try{this._paint()}catch(t){if("(regl) context lost"!==t.message)throw t;console.warn(t)}}_paint(){this._needsPaint=!1;const t=Date.now();if(this.reglCommandObjects.forEach(t=>t.stats.count=0),!this.initializedData)return;this._cachedReadHitmapCall=null;const{regl:e,camera:r}=this.initializedData;this._clearCanvas(e),r.draw(this.cameraStore.state,()=>{const t=Date.now();this._drawInput(),this.counters.paint=Date.now()-t}),this._paintCalls.forEach(t=>{t()}),this.counters.render=Date.now()-t,this._needsPaint?this._frame=requestAnimationFrame(()=>this.paint()):this._frame=void 0}_instrumentCommands(t){return"production"===Li()?t:new Proxy(t,{apply:(t,e,r)=>{const n=t(...r);return"object"==typeof n.stats&&this.reglCommandObjects.push(n),n}})}}function ia(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function aa(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ia(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ia(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}const sa=[0,0,0,1],ca=3;function ua(t,e,r,n){const o={ray:e,objects:t};try{n(r,o)}catch(t){console.error("Error during mouse handler",t)}}class pa extends a.Component{constructor(t){super(t),l(this,"_canvas",a.createRef()),l(this,"_cameraListener",a.createRef()),l(this,"_tick",void 0),l(this,"_dragStartPos",null),l(this,"handleOffscreenMouseEvent",(t,e)=>{"onDoubleClick"===e?this._onDoubleClick(t,!0):"onMouseDown"===e?this._onMouseDown(t,!0):"onMouseMove"===e?this._onMouseMove(t,!0):"onMouseUp"===e&&this._onMouseUp(t,!0)}),l(this,"_handleContextLost",t=>{const{width:e,height:r,top:n,left:o,backgroundColor:i,onCameraStateChange:a,cameraState:s,defaultCameraState:c,contextAttributes:u}=this.props;this._tick&&cancelAnimationFrame(this._tick),this.state.worldviewContext.destroy(),this.setState({worldviewContext:new oa({dimension:{width:e,height:r,top:n,left:o},canvasBackgroundColor:i||sa,cameraState:s||c||ri,onCameraStateChange:a||void 0,contextAttributes:u||{}})}),t.preventDefault()}),l(this,"_handleContextRestored",t=>{this.state.worldviewContext.initialize(this._canvas.current),this.state.worldviewContext.paint(),this.setState({})}),l(this,"_onDoubleClick",(t,e)=>{this._onMouseInteraction(t,"onDoubleClick",e)}),l(this,"_onMouseDown",(t,e)=>{this._dragStartPos={x:t.clientX,y:t.clientY},this._onMouseInteraction(t,"onMouseDown",e)}),l(this,"_onMouseMove",(t,e)=>{this._onMouseInteraction(t,"onMouseMove",e)}),l(this,"_onMouseUp",(t,e)=>{this._onMouseInteraction(t,"onMouseUp",e);const{_dragStartPos:r}=this;if(r){const n=t.clientX-r.x,o=t.clientY-r.y;Math.sqrt(n*n+o*o)<ca&&this._onMouseInteraction(t,"onClick",e),this._dragStartPos=null}}),l(this,"_onMouseInteraction",(t,e,r)=>{const{worldviewContext:n}=this.state,o=this.props[e];if(!(r||t.target instanceof window.HTMLElement&&0===t.button))return;const{top:i,left:a}=t.target.getBoundingClientRect(),{clientX:s,clientY:c}=t,u=s-a,p=c-i,l=n.raycast(u,p);if(!l)return;const{hitmapOnMouseMove:f,disableHitmapForEvents:_=(f?[]:["onMouseMove"])}=this.props;if(_.includes(e))return o?ua([],l,t,o):void 0;t.persist(),n.readHitmap(u,p,!!this.props.enableStackedObjectEvents,this.props.maxStackedObjectCount).then(r=>{const n=function(t){const e=new Map;return t.forEach(([t,r])=>{const n=e.get(r)||[];n.push(t),e.has(r)||e.set(r,n)}),e}(r);for(const[r,o]of n.entries())if(r.handleMouseEvent(o,l,t,e),t.isPropagationStopped())break;if(o&&!t.isPropagationStopped()){ua(r.map(([t])=>t),l,t,o)}}).catch(t=>{console.error(t)})});const{width:e,height:r,top:n,left:o,backgroundColor:i,onCameraStateChange:s,cameraState:c,defaultCameraState:u,hitmapOnMouseMove:p,disableHitmapForEvents:f,canvas:_}=t;if(_&&(this._canvas.current=_),s?(c||console.warn("You provided `onCameraStateChange` without `cameraState`. Use Worldview as a controlled component with `cameraState` and `onCameraStateChange`, or uncontrolled with `defaultCameraState`."),c&&u&&console.warn("You provided both `cameraState` and `defaultCameraState`. `defaultCameraState` will be ignored.")):c&&console.warn("You provided `cameraState` without an `onCameraStateChange` handler. This will prevent moving the camera. If the camera should be movable, use `defaultCameraState`, otherwise set `onCameraStateChange`."),p){if(f)throw new Error("Property 'hitmapOnMouseMove' is deprectated and will be ignored when used along with 'disableHitmapForEvents'.");console.warn("Property 'hitmapOnMouseMove' is deprectated. Please use 'disableHitmapForEvents' property instead.")}this.state={worldviewContext:new oa({dimension:{width:e,height:r,top:n,left:o},canvasBackgroundColor:i||sa,cameraState:t.cameraState||t.defaultCameraState||ri,onCameraStateChange:t.onCameraStateChange||void 0,contextAttributes:t.contextAttributes||{}})}}static getDerivedStateFromProps({width:t,height:e,top:r,left:n},{worldviewContext:o}){return o.setDimension({width:t,height:e,top:r,left:n}),null}componentDidMount(){if(!this._canvas.current)return console.warn("missing canvas element");this._canvas.current.addEventListener("webglcontextlost",this._handleContextLost),this._canvas.current.addEventListener("webglcontextrestored",this._handleContextRestored);const t=()=>{const{worldviewContext:t}=this.state;t.initialize(this._canvas.current),this.setState({}),t.paint()};if(this.state.worldviewContext.destroyed){const{width:e,height:r,top:n,left:o,backgroundColor:i,cameraState:a,defaultCameraState:s,onCameraStateChange:c,contextAttributes:u}=this.props;this.setState({worldviewContext:new oa({dimension:{width:e,height:r,top:n,left:o},canvasBackgroundColor:i||sa,cameraState:a||s||ri,onCameraStateChange:c||void 0,contextAttributes:u||{}})},t)}else t()}componentWillUnmount(){this._tick&&cancelAnimationFrame(this._tick),this._canvas.current.removeEventListener("webglcontextlost",this._handleContextLost),this._canvas.current.removeEventListener("webglcontextrestored",this._handleContextRestored),this.state.worldviewContext.destroy()}componentDidUpdate(){const{worldviewContext:t}=this.state;this.props.cameraState&&t.cameraStore.setCameraState(this.props.cameraState),t.canvasBackgroundColor=this.props.backgroundColor||sa,t.onDirty()}focus(){this._cameraListener.current&&this._cameraListener.current.focus()}_renderDebug(){const{worldviewContext:t}=this.state,e=t.initializedData;if("production"===Li()||!e)return null;const{regl:r}=e,n=window.performance.memory,{counters:o,reglCommandObjects:i}=t,s=pn(o,t=>`${t} ms`);if(s["draw calls"]=i.reduce((t,e)=>t+e.stats.count,0),n&&(s["heap used"]=`${(n.usedJSHeapSize/n.jsHeapSizeLimit*100).toFixed(3)}%`),Object.assign(s,wn(r.stats,t=>"number"==typeof t&&0!==t)),r.stats.bufferCount>1e3)throw new Error("Memory leak: Buffer count > 1000.");const c=Object.keys(s).map(t=>a.createElement("tr",{key:t,style:{backgroundColor:"transparent",border:"none"}},a.createElement("td",{style:{paddingRight:10,border:"none"}},t),a.createElement("td",{style:{width:"100%",border:"none"}},s[t])));return a.createElement("table",{style:{bottom:5,right:10,width:200,position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",fontFamily:"monospace",fontSize:10}},a.createElement("tbody",null,c))}render(){const{width:t,height:e,showDebug:r,keyMap:n,shiftKeys:o,style:i,cameraState:s,onCameraStateChange:c,resolutionScale:u,canvas:p}=this.props,{worldviewContext:l}=this.state,f=s&&!c,_=u||1,d=p?null:a.createElement(a.Fragment,null,a.createElement("canvas",{style:{width:t,height:e,maxWidth:"100%",maxHeight:"100%"},width:t*_,height:e*_,ref:this._canvas,onMouseUp:this._onMouseUp,onMouseDown:this._onMouseDown,onDoubleClick:this._onDoubleClick,onMouseMove:this._onMouseMove}),r&&this._renderDebug());return a.createElement("div",{style:aa({position:"relative",overflow:"hidden"},i)},f?d:a.createElement(Ni,{cameraStore:l.cameraStore,keyMap:n,shiftKeys:o,ref:t=>this._cameraListener.current=t},d),l.initializedData&&a.createElement(Yi.Provider,{value:l},this.props.children))}}l(pa,"defaultProps",{maxStackedObjectCount:100,backgroundColor:sa,shiftKeys:!0,style:{},resolutionScale:1});const la=a.forwardRef((t,e)=>a.createElement(Ki,null,({width:r,height:n,left:o,top:i})=>a.createElement(pa,p({width:r,height:n,left:o,top:i,ref:e},t))));la.displayName="Worldview";class fa{constructor(){l(this,"min",void 0),l(this,"max",void 0),this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER}update(t){this.min=Math.min(this.min,t),this.max=Math.max(this.max,t)}}const _a=[0,0,0,0,0,0,0,0,0];var da=(t,e)=>r=>{const n=Float32Array.from([].concat(...t));if(e.some(t=>t.some(t=>t<0||t>=65536)))throw new Error("Element index out of bounds for Uint16");const o=Uint16Array.from([].concat(...e)),i=r.buffer({usage:"dynamic",data:[]}),a=Mo(r);return Io({vert:"\n    precision mediump float;\n    attribute vec3 point;\n    attribute vec3 offset;\n    attribute vec4 color;\n    uniform mat4 projection, view;\n    uniform vec3 scale;\n    varying vec4 vColor;\n\n    #WITH_POSE\n\n    void main () {\n      vec3 p = applyPose(scale * point + offset);\n      vColor = color;\n      gl_Position = projection * view * vec4(p, 1);\n    }\n    ",frag:"\n    precision mediump float;\n    varying vec4 vColor;\n    void main () {\n      gl_FragColor = vColor;\n    }",attributes:{point:n,color:(t,e)=>a(e.color,e.colors,e.points?e.points.length:1),offset:(t,e)=>{const r=Fo(e.points)?e.points.map(mo):e.points||[0,0,0];return{buffer:i({usage:"dynamic",data:r}),divisor:1}}},elements:o,depth:So,blend:Co,uniforms:{scale:(t,e)=>Fo(e.scale)?mo(e.scale):e.scale},count:o.length,instances:(t,e)=>e.points?e.points.length:1})},ma=_(function(t,e){var r=r||{};r.scope={},r.arrayIteratorImpl=function(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}},r.arrayIterator=function(t){return{next:r.arrayIteratorImpl(t)}},r.makeIterator=function(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):r.arrayIterator(t)},r.ASSUME_ES5=!1,r.ASSUME_NO_NATIVE_MAP=!1,r.ASSUME_NO_NATIVE_SET=!1,r.SIMPLE_FROUND_POLYFILL=!1,r.ISOLATE_POLYFILLS=!1,r.FORCE_POLYFILL_PROMISE=!1,r.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,r.getGlobal=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof f&&f];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},r.global=r.getGlobal(f),r.defineProperty=r.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,r){return t==Array.prototype||t==Object.prototype?t:(t[e]=r.value,t)},r.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),r.TRUST_ES6_POLYFILLS=!r.ISOLATE_POLYFILLS||r.IS_SYMBOL_NATIVE,r.polyfills={},r.propertyToPolyfillSymbol={},r.POLYFILL_PREFIX="$jscp$",r.polyfill=function(t,e,n,o){e&&(r.ISOLATE_POLYFILLS?r.polyfillIsolated(t,e,n,o):r.polyfillUnisolated(t,e,n,o))},r.polyfillUnisolated=function(t,e,n,o){for(n=r.global,t=t.split("."),o=0;o<t.length-1;o++){var i=t[o];if(!(i in n))return;n=n[i]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r.defineProperty(n,t,{configurable:!0,writable:!0,value:e})},r.polyfillIsolated=function(t,e,n,o){var i=t.split(".");t=1===i.length,o=i[0],o=!t&&o in r.polyfills?r.polyfills:r.global;for(var a=0;a<i.length-1;a++){var s=i[a];if(!(s in o))return;o=o[s]}i=i[i.length-1],null!=(e=e(n=r.IS_SYMBOL_NATIVE&&"es6"===n?o[i]:null))&&(t?r.defineProperty(r.polyfills,i,{configurable:!0,writable:!0,value:e}):e!==n&&(r.propertyToPolyfillSymbol[i]=r.IS_SYMBOL_NATIVE?r.global.Symbol(i):r.POLYFILL_PREFIX+i,i=r.propertyToPolyfillSymbol[i],r.defineProperty(o,i,{configurable:!0,writable:!0,value:e})))},r.polyfill("Promise",function(t){function e(){this.batch_=null}function n(t){return t instanceof i?t:new i(function(e,r){e(t)})}if(t&&(!(r.FORCE_POLYFILL_PROMISE||r.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&void 0===r.global.PromiseRejectionEvent)||!r.global.Promise||-1===r.global.Promise.toString().indexOf("[native code]")))return t;e.prototype.asyncExecute=function(t){if(null==this.batch_){this.batch_=[];var e=this;this.asyncExecuteFunction(function(){e.executeBatch_()})}this.batch_.push(t)};var o=r.global.setTimeout;e.prototype.asyncExecuteFunction=function(t){o(t,0)},e.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var t=this.batch_;this.batch_=[];for(var e=0;e<t.length;++e){var r=t[e];t[e]=null;try{r()}catch(t){this.asyncThrow_(t)}}}this.batch_=null},e.prototype.asyncThrow_=function(t){this.asyncExecuteFunction(function(){throw t})};var i=function(t){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[],this.isRejectionHandled_=!1;var e=this.createResolveAndReject_();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}};i.prototype.createResolveAndReject_=function(){function t(t){return function(n){r||(r=!0,t.call(e,n))}}var e=this,r=!1;return{resolve:t(this.resolveTo_),reject:t(this.reject_)}},i.prototype.resolveTo_=function(t){if(t===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof i)this.settleSameAsPromise_(t);else{t:switch(typeof t){case"object":var e=null!=t;break t;case"function":e=!0;break t;default:e=!1}e?this.resolveToNonPromiseObj_(t):this.fulfill_(t)}},i.prototype.resolveToNonPromiseObj_=function(t){var e=void 0;try{e=t.then}catch(t){return void this.reject_(t)}"function"==typeof e?this.settleSameAsThenable_(e,t):this.fulfill_(t)},i.prototype.reject_=function(t){this.settle_(2,t)},i.prototype.fulfill_=function(t){this.settle_(1,t)},i.prototype.settle_=function(t,e){if(0!=this.state_)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.state_);this.state_=t,this.result_=e,2===this.state_&&this.scheduleUnhandledRejectionCheck_(),this.executeOnSettledCallbacks_()},i.prototype.scheduleUnhandledRejectionCheck_=function(){var t=this;o(function(){if(t.notifyUnhandledRejection_()){var e=r.global.console;void 0!==e&&e.error(t.result_)}},1)},i.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var t=r.global.CustomEvent,e=r.global.Event,n=r.global.dispatchEvent;return void 0===n||("function"==typeof t?t=new t("unhandledrejection",{cancelable:!0}):"function"==typeof e?t=new e("unhandledrejection",{cancelable:!0}):(t=r.global.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,t),t.promise=this,t.reason=this.result_,n(t))},i.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var t=0;t<this.onSettledCallbacks_.length;++t)a.asyncExecute(this.onSettledCallbacks_[t]);this.onSettledCallbacks_=null}};var a=new e;return i.prototype.settleSameAsPromise_=function(t){var e=this.createResolveAndReject_();t.callWhenSettled_(e.resolve,e.reject)},i.prototype.settleSameAsThenable_=function(t,e){var r=this.createResolveAndReject_();try{t.call(e,r.resolve,r.reject)}catch(t){r.reject(t)}},i.prototype.then=function(t,e){function r(t,e){return"function"==typeof t?function(e){try{n(t(e))}catch(t){o(t)}}:e}var n,o,a=new i(function(t,e){n=t,o=e});return this.callWhenSettled_(r(t,n),r(e,o)),a},i.prototype.catch=function(t){return this.then(void 0,t)},i.prototype.callWhenSettled_=function(t,e){function r(){switch(n.state_){case 1:t(n.result_);break;case 2:e(n.result_);break;default:throw Error("Unexpected state: "+n.state_)}}var n=this;null==this.onSettledCallbacks_?a.asyncExecute(r):this.onSettledCallbacks_.push(r),this.isRejectionHandled_=!0},i.resolve=n,i.reject=function(t){return new i(function(e,r){r(t)})},i.race=function(t){return new i(function(e,o){for(var i=r.makeIterator(t),a=i.next();!a.done;a=i.next())n(a.value).callWhenSettled_(e,o)})},i.all=function(t){var e=r.makeIterator(t),o=e.next();return o.done?n([]):new i(function(t,r){function i(e){return function(r){a[e]=r,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,n(o.value).callWhenSettled_(i(a.length-1),r),o=e.next()}while(!o.done)})},i},"es6","es3"),r.checkEs6ConformanceViaProxy=function(){try{var t={},e=Object.create(new r.global.Proxy(t,{get:function(r,n,o){return r==t&&"q"==n&&o==e}}));return!0===e.q}catch(t){return!1}},r.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,r.ES6_CONFORMANCE=r.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&r.checkEs6ConformanceViaProxy(),r.owns=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.polyfill("Array.prototype.copyWithin",function(t){function e(t){return 1/0===(t=Number(t))||-1/0===t?t:0|t}return t||function(t,r,n){var o=this.length;if(t=e(t),r=e(r),n=void 0===n?o:e(n),t=0>t?Math.max(o+t,0):Math.min(t,o),r=0>r?Math.max(o+r,0):Math.min(r,o),n=0>n?Math.max(o+n,0):Math.min(n,o),t<r)for(;r<n;)r in this?this[t++]=this[r++]:(delete this[t++],r++);else for(t+=(n=Math.min(n,o+r-t))-r;n>r;)--n in this?this[--t]=this[n]:delete this[--t];return this}},"es6","es3"),r.typedArrayCopyWithin=function(t){return t||Array.prototype.copyWithin},r.polyfill("Int8Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Uint8Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Uint8ClampedArray.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Int16Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Uint16Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Int32Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Uint32Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Float32Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Float64Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5");var n,o=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(n=n||__filename),function(t){function e(t,e){t||i("Assertion failed: "+e)}function r(t,e){return 0<t%e&&(t+=e-t%e),t}function o(t){it=t,k.HEAP8=J=new Int8Array(t),k.HEAP16=et=new Int16Array(t),k.HEAP32=rt=new Int32Array(t),k.HEAPU8=tt=new Uint8Array(t),k.HEAPU16=new Uint16Array(t),k.HEAPU32=new Uint32Array(t),k.HEAPF32=nt=new Float32Array(t),k.HEAPF64=new Float64Array(t)}function i(t){throw k.onAbort&&k.onAbort(t),$(t+=""),Z=!0,t=new WebAssembly.RuntimeError("abort("+t+"). Build with -s ASSERTIONS=1 for more info."),F(t),t}function a(t,e){return String.prototype.startsWith?t.startsWith(e):0===t.indexOf(e)}function s(){try{if(K)return new Uint8Array(K);if(q)return q(mt);throw"both async and sync fetching of the wasm failed"}catch(t){i(t)}}function p(t){for(;0<t.length;){var e=t.shift();if("function"==typeof e)e(k);else{var r=e.func;"number"==typeof r?void 0===e.arg?at.get(r)():at.get(r)(e.arg):r(void 0===e.arg?null:e.arg)}}}function l(t){this.excPtr=t,this.ptr=t-ht.SIZE,this.set_type=function(t){rt[this.ptr+ht.TYPE_OFFSET>>2]=t},this.get_type=function(){return rt[this.ptr+ht.TYPE_OFFSET>>2]},this.set_destructor=function(t){rt[this.ptr+ht.DESTRUCTOR_OFFSET>>2]=t},this.get_destructor=function(){return rt[this.ptr+ht.DESTRUCTOR_OFFSET>>2]},this.set_refcount=function(t){rt[this.ptr+ht.REFCOUNT_OFFSET>>2]=t},this.set_caught=function(t){J[this.ptr+ht.CAUGHT_OFFSET>>0]=t?1:0},this.get_caught=function(){return 0!=J[this.ptr+ht.CAUGHT_OFFSET>>0]},this.set_rethrown=function(t){J[this.ptr+ht.RETHROWN_OFFSET>>0]=t?1:0},this.get_rethrown=function(){return 0!=J[this.ptr+ht.RETHROWN_OFFSET>>0]},this.init=function(t,e){this.set_type(t),this.set_destructor(e),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){rt[this.ptr+ht.REFCOUNT_OFFSET>>2]+=1},this.release_ref=function(){var t=rt[this.ptr+ht.REFCOUNT_OFFSET>>2];return rt[this.ptr+ht.REFCOUNT_OFFSET>>2]=t-1,1===t}}function f(t){function e(){if(!or&&(or=!0,k.calledRun=!0,!Z)){if(lt=!0,p(ct),p(ut),M(k),k.onRuntimeInitialized&&k.onRuntimeInitialized(),k.postRun)for("function"==typeof k.postRun&&(k.postRun=[k.postRun]);k.postRun.length;)pt.unshift(k.postRun.shift());p(pt)}}if(!(0<ft)){if(k.preRun)for("function"==typeof k.preRun&&(k.preRun=[k.preRun]);k.preRun.length;)st.unshift(k.preRun.shift());p(st),0<ft||(k.setStatus?(k.setStatus("Running..."),setTimeout(function(){setTimeout(function(){k.setStatus("")},1),e()},1)):e())}}function _(){}function d(t){return(t||_).__cache__}function m(t,e){var r=d(e),n=r[t];return n||((n=Object.create((e||_).prototype)).ptr=t,r[t]=n)}function h(t){if("string"==typeof t){for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);55296<=n&&57343>=n&&(n=65536+((1023&n)<<10)|1023&t.charCodeAt(++r)),127>=n?++e:e=2047>=n?e+2:65535>=n?e+3:e+4}if(r=0,0<(n=(e=Array(e+1)).length)){n=r+n-1;for(var o=0;o<t.length;++o){var i=t.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++o)),127>=i){if(r>=n)break;e[r++]=i}else{if(2047>=i){if(r+1>=n)break;e[r++]=192|i>>6}else{if(65535>=i){if(r+2>=n)break;e[r++]=224|i>>12}else{if(r+3>=n)break;e[r++]=240|i>>18,e[r++]=128|i>>12&63}e[r++]=128|i>>6&63}e[r++]=128|63&i}}e[r]=0}return t=ar.alloc(e,J),ar.copy(e,J,t),t}return t}function y(t){if("object"==typeof t){var e=ar.alloc(t,J);return ar.copy(t,J,e),e}return t}function b(t){if("object"==typeof t){var e=ar.alloc(t,et);return ar.copy(t,et,e),e}return t}function v(t){if("object"==typeof t){var e=ar.alloc(t,rt);return ar.copy(t,rt,e),e}return t}function g(t){if("object"==typeof t){var e=ar.alloc(t,nt);return ar.copy(t,nt,e),e}return t}function A(){throw"cannot construct a VoidPtr, no constructor in IDL"}function w(){this.ptr=gt(),d(w)[this.ptr]=this}function x(){this.ptr=wt(),d(x)[this.ptr]=this}function E(){this.ptr=Pt(),d(E)[this.ptr]=this}function O(){this.ptr=Rt(),d(O)[this.ptr]=this}function T(){this.ptr=Ut(),d(T)[this.ptr]=this}function j(){this.ptr=Ht(),d(j)[this.ptr]=this}function S(){this.ptr=qt(),d(S)[this.ptr]=this}function C(){this.ptr=te(),d(C)[this.ptr]=this}function D(){this.ptr=le(),d(D)[this.ptr]=this}function I(){this.ptr=Te(),d(I)[this.ptr]=this}function P(t){t&&"object"==typeof t&&(t=t.ptr),this.ptr=Be(t),d(P)[this.ptr]=this}var M,F,k=void 0!==(t=t||{})?t:{};k.ready=new Promise(function(t,e){M=t,F=e});var R=!1,B=!1;k.onRuntimeInitialized=function(){R=!0,B&&"function"==typeof k.onModuleLoaded&&k.onModuleLoaded(k)},k.onModuleParsed=function(){B=!0,R&&"function"==typeof k.onModuleLoaded&&k.onModuleLoaded(k)},k.isVersionSupported=function(t){return"string"==typeof t&&!(2>(t=t.split(".")).length||3<t.length)&&(1==t[0]&&0<=t[1]&&4>=t[1]||!(0!=t[0]||10<t[1]))};var z,G={};for(z in k)k.hasOwnProperty(z)&&(G[z]=k[z]);var N,L,U=!1,W=!1;U="object"==typeof window,W="function"==typeof importScripts,N="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,L=!U&&!N&&!W;var H,V,Y="";if(N){Y=W?c.default.dirname(Y)+"/":__dirname+"/";var Q=function(t,e){return H||(H=u.default),V||(V=c.default),t=V.normalize(t),H.readFileSync(t,e?null:"utf8")},q=function(t){return(t=Q(t,!0)).buffer||(t=new Uint8Array(t)),e(t.buffer),t};1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),k.inspect=function(){return"[Emscripten Module object]"}}else L?("undefined"!=typeof read&&(Q=function(t){return read(t)}),q=function(t){return"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(e("object"==typeof(t=read(t,"binary"))),t)},"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(U||W)&&(W?Y=self.location.href:"undefined"!=typeof document&&document.currentScript&&(Y=document.currentScript.src),n&&(Y=n),Y=0!==Y.indexOf("blob:")?Y.substr(0,Y.lastIndexOf("/")+1):"",Q=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},W&&(q=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}));k.print||console.log.bind(console);var K,$=k.printErr||console.warn.bind(console);for(z in G)G.hasOwnProperty(z)&&(k[z]=G[z]);G=null,k.wasmBinary&&(K=k.wasmBinary),"object"!=typeof WebAssembly&&i("no native wasm support detected");var X,Z=!1;"undefined"!=typeof TextDecoder&&new TextDecoder("utf8"),"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var J,tt,et,rt,nt,ot=k.INITIAL_MEMORY||16777216;if(X=k.wasmMemory?k.wasmMemory:new WebAssembly.Memory({initial:ot/65536,maximum:32768}))var it=X.buffer;ot=it.byteLength,o(it);var at,st=[],ct=[],ut=[],pt=[],lt=!1,ft=0,_t=null;k.preloadedImages={},k.preloadedAudios={};var dt,mt="draco_encoder.wasm";a(mt,"data:application/octet-stream;base64,")||(dt=mt,mt=k.locateFile?k.locateFile(dt,Y):Y+dt);var ht={DESTRUCTOR_OFFSET:0,REFCOUNT_OFFSET:4,TYPE_OFFSET:8,CAUGHT_OFFSET:12,RETHROWN_OFFSET:13,SIZE:16};ct.push({func:function(){bt()}});var yt={__cxa_allocate_exception:function(t){return ir(t+ht.SIZE)+ht.SIZE},__cxa_throw:function(t,e,r){throw new l(t).init(e,r),t},abort:function(){i()},array_bounds_check_error:function(t,e){throw"Array index "+t+" out of bounds: [0,"+e+")"},emscripten_memcpy_big:function(t,e,r){tt.copyWithin(t,e,e+r)},emscripten_resize_heap:function(t){t>>>=0;var e=tt.length;if(2147483648<t)return!1;for(var n=1;4>=n;n*=2){var i=e*(1+.2/n);i=Math.min(i,t+100663296),i=Math.min(2147483648,r(Math.max(16777216,t,i),65536));t:{try{X.grow(i-it.byteLength+65535>>>16),o(X.buffer);var a=1;break t}catch(t){}a=void 0}if(a)return!0}return!1},memory:X};!function(){function t(t,e){k.asm=t.exports,at=k.asm.__indirect_function_table,ft--,k.monitorRunDependencies&&k.monitorRunDependencies(ft),0==ft&&_t&&(t=_t,_t=null,t())}function e(e){t(e.instance)}function r(t){return(K||!U&&!W||"function"!=typeof fetch||a(mt,"file://")?Promise.resolve().then(s):fetch(mt,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+mt+"'";return t.arrayBuffer()}).catch(function(){return s()})).then(function(t){return WebAssembly.instantiate(t,n)}).then(t,function(t){$("failed to asynchronously prepare wasm: "+t),i(t)})}var n={env:yt,wasi_snapshot_preview1:yt};if(ft++,k.monitorRunDependencies&&k.monitorRunDependencies(ft),k.instantiateWasm)try{return k.instantiateWasm(n,t)}catch(t){return $("Module.instantiateWasm callback failed with error: "+t),!1}(K||"function"!=typeof WebAssembly.instantiateStreaming||a(mt,"data:application/octet-stream;base64,")||a(mt,"file://")||"function"!=typeof fetch?r(e):fetch(mt,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,n).then(e,function(t){return $("wasm streaming compile failed: "+t),$("falling back to ArrayBuffer instantiation"),r(e)})})).catch(F)}();var bt=k.___wasm_call_ctors=function(){return(bt=k.___wasm_call_ctors=k.asm.__wasm_call_ctors).apply(null,arguments)};k.___em_js__array_bounds_check_error=function(){return(k.___em_js__array_bounds_check_error=k.asm.__em_js__array_bounds_check_error).apply(null,arguments)};var vt=k._emscripten_bind_VoidPtr___destroy___0=function(){return(vt=k._emscripten_bind_VoidPtr___destroy___0=k.asm.emscripten_bind_VoidPtr___destroy___0).apply(null,arguments)},gt=k._emscripten_bind_GeometryAttribute_GeometryAttribute_0=function(){return(gt=k._emscripten_bind_GeometryAttribute_GeometryAttribute_0=k.asm.emscripten_bind_GeometryAttribute_GeometryAttribute_0).apply(null,arguments)},At=k._emscripten_bind_GeometryAttribute___destroy___0=function(){return(At=k._emscripten_bind_GeometryAttribute___destroy___0=k.asm.emscripten_bind_GeometryAttribute___destroy___0).apply(null,arguments)},wt=k._emscripten_bind_PointAttribute_PointAttribute_0=function(){return(wt=k._emscripten_bind_PointAttribute_PointAttribute_0=k.asm.emscripten_bind_PointAttribute_PointAttribute_0).apply(null,arguments)},xt=k._emscripten_bind_PointAttribute_size_0=function(){return(xt=k._emscripten_bind_PointAttribute_size_0=k.asm.emscripten_bind_PointAttribute_size_0).apply(null,arguments)},Et=k._emscripten_bind_PointAttribute_attribute_type_0=function(){return(Et=k._emscripten_bind_PointAttribute_attribute_type_0=k.asm.emscripten_bind_PointAttribute_attribute_type_0).apply(null,arguments)},Ot=k._emscripten_bind_PointAttribute_data_type_0=function(){return(Ot=k._emscripten_bind_PointAttribute_data_type_0=k.asm.emscripten_bind_PointAttribute_data_type_0).apply(null,arguments)},Tt=k._emscripten_bind_PointAttribute_num_components_0=function(){return(Tt=k._emscripten_bind_PointAttribute_num_components_0=k.asm.emscripten_bind_PointAttribute_num_components_0).apply(null,arguments)},jt=k._emscripten_bind_PointAttribute_normalized_0=function(){return(jt=k._emscripten_bind_PointAttribute_normalized_0=k.asm.emscripten_bind_PointAttribute_normalized_0).apply(null,arguments)},St=k._emscripten_bind_PointAttribute_byte_stride_0=function(){return(St=k._emscripten_bind_PointAttribute_byte_stride_0=k.asm.emscripten_bind_PointAttribute_byte_stride_0).apply(null,arguments)},Ct=k._emscripten_bind_PointAttribute_byte_offset_0=function(){return(Ct=k._emscripten_bind_PointAttribute_byte_offset_0=k.asm.emscripten_bind_PointAttribute_byte_offset_0).apply(null,arguments)},Dt=k._emscripten_bind_PointAttribute_unique_id_0=function(){return(Dt=k._emscripten_bind_PointAttribute_unique_id_0=k.asm.emscripten_bind_PointAttribute_unique_id_0).apply(null,arguments)},It=k._emscripten_bind_PointAttribute___destroy___0=function(){return(It=k._emscripten_bind_PointAttribute___destroy___0=k.asm.emscripten_bind_PointAttribute___destroy___0).apply(null,arguments)},Pt=k._emscripten_bind_PointCloud_PointCloud_0=function(){return(Pt=k._emscripten_bind_PointCloud_PointCloud_0=k.asm.emscripten_bind_PointCloud_PointCloud_0).apply(null,arguments)},Mt=k._emscripten_bind_PointCloud_num_attributes_0=function(){return(Mt=k._emscripten_bind_PointCloud_num_attributes_0=k.asm.emscripten_bind_PointCloud_num_attributes_0).apply(null,arguments)},Ft=k._emscripten_bind_PointCloud_num_points_0=function(){return(Ft=k._emscripten_bind_PointCloud_num_points_0=k.asm.emscripten_bind_PointCloud_num_points_0).apply(null,arguments)},kt=k._emscripten_bind_PointCloud___destroy___0=function(){return(kt=k._emscripten_bind_PointCloud___destroy___0=k.asm.emscripten_bind_PointCloud___destroy___0).apply(null,arguments)},Rt=k._emscripten_bind_Mesh_Mesh_0=function(){return(Rt=k._emscripten_bind_Mesh_Mesh_0=k.asm.emscripten_bind_Mesh_Mesh_0).apply(null,arguments)},Bt=k._emscripten_bind_Mesh_num_faces_0=function(){return(Bt=k._emscripten_bind_Mesh_num_faces_0=k.asm.emscripten_bind_Mesh_num_faces_0).apply(null,arguments)},zt=k._emscripten_bind_Mesh_num_attributes_0=function(){return(zt=k._emscripten_bind_Mesh_num_attributes_0=k.asm.emscripten_bind_Mesh_num_attributes_0).apply(null,arguments)},Gt=k._emscripten_bind_Mesh_num_points_0=function(){return(Gt=k._emscripten_bind_Mesh_num_points_0=k.asm.emscripten_bind_Mesh_num_points_0).apply(null,arguments)},Nt=k._emscripten_bind_Mesh_set_num_points_1=function(){return(Nt=k._emscripten_bind_Mesh_set_num_points_1=k.asm.emscripten_bind_Mesh_set_num_points_1).apply(null,arguments)},Lt=k._emscripten_bind_Mesh___destroy___0=function(){return(Lt=k._emscripten_bind_Mesh___destroy___0=k.asm.emscripten_bind_Mesh___destroy___0).apply(null,arguments)},Ut=k._emscripten_bind_Metadata_Metadata_0=function(){return(Ut=k._emscripten_bind_Metadata_Metadata_0=k.asm.emscripten_bind_Metadata_Metadata_0).apply(null,arguments)},Wt=k._emscripten_bind_Metadata___destroy___0=function(){return(Wt=k._emscripten_bind_Metadata___destroy___0=k.asm.emscripten_bind_Metadata___destroy___0).apply(null,arguments)},Ht=k._emscripten_bind_DracoInt8Array_DracoInt8Array_0=function(){return(Ht=k._emscripten_bind_DracoInt8Array_DracoInt8Array_0=k.asm.emscripten_bind_DracoInt8Array_DracoInt8Array_0).apply(null,arguments)},Vt=k._emscripten_bind_DracoInt8Array_GetValue_1=function(){return(Vt=k._emscripten_bind_DracoInt8Array_GetValue_1=k.asm.emscripten_bind_DracoInt8Array_GetValue_1).apply(null,arguments)},Yt=k._emscripten_bind_DracoInt8Array_size_0=function(){return(Yt=k._emscripten_bind_DracoInt8Array_size_0=k.asm.emscripten_bind_DracoInt8Array_size_0).apply(null,arguments)},Qt=k._emscripten_bind_DracoInt8Array___destroy___0=function(){return(Qt=k._emscripten_bind_DracoInt8Array___destroy___0=k.asm.emscripten_bind_DracoInt8Array___destroy___0).apply(null,arguments)},qt=k._emscripten_bind_MetadataBuilder_MetadataBuilder_0=function(){return(qt=k._emscripten_bind_MetadataBuilder_MetadataBuilder_0=k.asm.emscripten_bind_MetadataBuilder_MetadataBuilder_0).apply(null,arguments)},Kt=k._emscripten_bind_MetadataBuilder_AddStringEntry_3=function(){return(Kt=k._emscripten_bind_MetadataBuilder_AddStringEntry_3=k.asm.emscripten_bind_MetadataBuilder_AddStringEntry_3).apply(null,arguments)},$t=k._emscripten_bind_MetadataBuilder_AddIntEntry_3=function(){return($t=k._emscripten_bind_MetadataBuilder_AddIntEntry_3=k.asm.emscripten_bind_MetadataBuilder_AddIntEntry_3).apply(null,arguments)},Xt=k._emscripten_bind_MetadataBuilder_AddIntEntryArray_4=function(){return(Xt=k._emscripten_bind_MetadataBuilder_AddIntEntryArray_4=k.asm.emscripten_bind_MetadataBuilder_AddIntEntryArray_4).apply(null,arguments)},Zt=k._emscripten_bind_MetadataBuilder_AddDoubleEntry_3=function(){return(Zt=k._emscripten_bind_MetadataBuilder_AddDoubleEntry_3=k.asm.emscripten_bind_MetadataBuilder_AddDoubleEntry_3).apply(null,arguments)},Jt=k._emscripten_bind_MetadataBuilder___destroy___0=function(){return(Jt=k._emscripten_bind_MetadataBuilder___destroy___0=k.asm.emscripten_bind_MetadataBuilder___destroy___0).apply(null,arguments)},te=k._emscripten_bind_PointCloudBuilder_PointCloudBuilder_0=function(){return(te=k._emscripten_bind_PointCloudBuilder_PointCloudBuilder_0=k.asm.emscripten_bind_PointCloudBuilder_PointCloudBuilder_0).apply(null,arguments)},ee=k._emscripten_bind_PointCloudBuilder_AddFloatAttribute_5=function(){return(ee=k._emscripten_bind_PointCloudBuilder_AddFloatAttribute_5=k.asm.emscripten_bind_PointCloudBuilder_AddFloatAttribute_5).apply(null,arguments)},re=k._emscripten_bind_PointCloudBuilder_AddInt8Attribute_5=function(){return(re=k._emscripten_bind_PointCloudBuilder_AddInt8Attribute_5=k.asm.emscripten_bind_PointCloudBuilder_AddInt8Attribute_5).apply(null,arguments)},ne=k._emscripten_bind_PointCloudBuilder_AddUInt8Attribute_5=function(){return(ne=k._emscripten_bind_PointCloudBuilder_AddUInt8Attribute_5=k.asm.emscripten_bind_PointCloudBuilder_AddUInt8Attribute_5).apply(null,arguments)},oe=k._emscripten_bind_PointCloudBuilder_AddInt16Attribute_5=function(){return(oe=k._emscripten_bind_PointCloudBuilder_AddInt16Attribute_5=k.asm.emscripten_bind_PointCloudBuilder_AddInt16Attribute_5).apply(null,arguments)},ie=k._emscripten_bind_PointCloudBuilder_AddUInt16Attribute_5=function(){return(ie=k._emscripten_bind_PointCloudBuilder_AddUInt16Attribute_5=k.asm.emscripten_bind_PointCloudBuilder_AddUInt16Attribute_5).apply(null,arguments)},ae=k._emscripten_bind_PointCloudBuilder_AddInt32Attribute_5=function(){return(ae=k._emscripten_bind_PointCloudBuilder_AddInt32Attribute_5=k.asm.emscripten_bind_PointCloudBuilder_AddInt32Attribute_5).apply(null,arguments)},se=k._emscripten_bind_PointCloudBuilder_AddUInt32Attribute_5=function(){return(se=k._emscripten_bind_PointCloudBuilder_AddUInt32Attribute_5=k.asm.emscripten_bind_PointCloudBuilder_AddUInt32Attribute_5).apply(null,arguments)},ce=k._emscripten_bind_PointCloudBuilder_AddMetadata_2=function(){return(ce=k._emscripten_bind_PointCloudBuilder_AddMetadata_2=k.asm.emscripten_bind_PointCloudBuilder_AddMetadata_2).apply(null,arguments)},ue=k._emscripten_bind_PointCloudBuilder_SetMetadataForAttribute_3=function(){return(ue=k._emscripten_bind_PointCloudBuilder_SetMetadataForAttribute_3=k.asm.emscripten_bind_PointCloudBuilder_SetMetadataForAttribute_3).apply(null,arguments)},pe=k._emscripten_bind_PointCloudBuilder___destroy___0=function(){return(pe=k._emscripten_bind_PointCloudBuilder___destroy___0=k.asm.emscripten_bind_PointCloudBuilder___destroy___0).apply(null,arguments)},le=k._emscripten_bind_MeshBuilder_MeshBuilder_0=function(){return(le=k._emscripten_bind_MeshBuilder_MeshBuilder_0=k.asm.emscripten_bind_MeshBuilder_MeshBuilder_0).apply(null,arguments)},fe=k._emscripten_bind_MeshBuilder_AddFacesToMesh_3=function(){return(fe=k._emscripten_bind_MeshBuilder_AddFacesToMesh_3=k.asm.emscripten_bind_MeshBuilder_AddFacesToMesh_3).apply(null,arguments)},_e=k._emscripten_bind_MeshBuilder_AddFloatAttributeToMesh_5=function(){return(_e=k._emscripten_bind_MeshBuilder_AddFloatAttributeToMesh_5=k.asm.emscripten_bind_MeshBuilder_AddFloatAttributeToMesh_5).apply(null,arguments)},de=k._emscripten_bind_MeshBuilder_AddInt32AttributeToMesh_5=function(){return(de=k._emscripten_bind_MeshBuilder_AddInt32AttributeToMesh_5=k.asm.emscripten_bind_MeshBuilder_AddInt32AttributeToMesh_5).apply(null,arguments)},me=k._emscripten_bind_MeshBuilder_AddMetadataToMesh_2=function(){return(me=k._emscripten_bind_MeshBuilder_AddMetadataToMesh_2=k.asm.emscripten_bind_MeshBuilder_AddMetadataToMesh_2).apply(null,arguments)},he=k._emscripten_bind_MeshBuilder_AddFloatAttribute_5=function(){return(he=k._emscripten_bind_MeshBuilder_AddFloatAttribute_5=k.asm.emscripten_bind_MeshBuilder_AddFloatAttribute_5).apply(null,arguments)},ye=k._emscripten_bind_MeshBuilder_AddInt8Attribute_5=function(){return(ye=k._emscripten_bind_MeshBuilder_AddInt8Attribute_5=k.asm.emscripten_bind_MeshBuilder_AddInt8Attribute_5).apply(null,arguments)},be=k._emscripten_bind_MeshBuilder_AddUInt8Attribute_5=function(){return(be=k._emscripten_bind_MeshBuilder_AddUInt8Attribute_5=k.asm.emscripten_bind_MeshBuilder_AddUInt8Attribute_5).apply(null,arguments)},ve=k._emscripten_bind_MeshBuilder_AddInt16Attribute_5=function(){return(ve=k._emscripten_bind_MeshBuilder_AddInt16Attribute_5=k.asm.emscripten_bind_MeshBuilder_AddInt16Attribute_5).apply(null,arguments)},ge=k._emscripten_bind_MeshBuilder_AddUInt16Attribute_5=function(){return(ge=k._emscripten_bind_MeshBuilder_AddUInt16Attribute_5=k.asm.emscripten_bind_MeshBuilder_AddUInt16Attribute_5).apply(null,arguments)},Ae=k._emscripten_bind_MeshBuilder_AddInt32Attribute_5=function(){return(Ae=k._emscripten_bind_MeshBuilder_AddInt32Attribute_5=k.asm.emscripten_bind_MeshBuilder_AddInt32Attribute_5).apply(null,arguments)},we=k._emscripten_bind_MeshBuilder_AddUInt32Attribute_5=function(){return(we=k._emscripten_bind_MeshBuilder_AddUInt32Attribute_5=k.asm.emscripten_bind_MeshBuilder_AddUInt32Attribute_5).apply(null,arguments)},xe=k._emscripten_bind_MeshBuilder_AddMetadata_2=function(){return(xe=k._emscripten_bind_MeshBuilder_AddMetadata_2=k.asm.emscripten_bind_MeshBuilder_AddMetadata_2).apply(null,arguments)},Ee=k._emscripten_bind_MeshBuilder_SetMetadataForAttribute_3=function(){return(Ee=k._emscripten_bind_MeshBuilder_SetMetadataForAttribute_3=k.asm.emscripten_bind_MeshBuilder_SetMetadataForAttribute_3).apply(null,arguments)},Oe=k._emscripten_bind_MeshBuilder___destroy___0=function(){return(Oe=k._emscripten_bind_MeshBuilder___destroy___0=k.asm.emscripten_bind_MeshBuilder___destroy___0).apply(null,arguments)},Te=k._emscripten_bind_Encoder_Encoder_0=function(){return(Te=k._emscripten_bind_Encoder_Encoder_0=k.asm.emscripten_bind_Encoder_Encoder_0).apply(null,arguments)},je=k._emscripten_bind_Encoder_SetEncodingMethod_1=function(){return(je=k._emscripten_bind_Encoder_SetEncodingMethod_1=k.asm.emscripten_bind_Encoder_SetEncodingMethod_1).apply(null,arguments)},Se=k._emscripten_bind_Encoder_SetAttributeQuantization_2=function(){return(Se=k._emscripten_bind_Encoder_SetAttributeQuantization_2=k.asm.emscripten_bind_Encoder_SetAttributeQuantization_2).apply(null,arguments)},Ce=k._emscripten_bind_Encoder_SetAttributeExplicitQuantization_5=function(){return(Ce=k._emscripten_bind_Encoder_SetAttributeExplicitQuantization_5=k.asm.emscripten_bind_Encoder_SetAttributeExplicitQuantization_5).apply(null,arguments)},De=k._emscripten_bind_Encoder_SetSpeedOptions_2=function(){return(De=k._emscripten_bind_Encoder_SetSpeedOptions_2=k.asm.emscripten_bind_Encoder_SetSpeedOptions_2).apply(null,arguments)},Ie=k._emscripten_bind_Encoder_SetTrackEncodedProperties_1=function(){return(Ie=k._emscripten_bind_Encoder_SetTrackEncodedProperties_1=k.asm.emscripten_bind_Encoder_SetTrackEncodedProperties_1).apply(null,arguments)},Pe=k._emscripten_bind_Encoder_EncodeMeshToDracoBuffer_2=function(){return(Pe=k._emscripten_bind_Encoder_EncodeMeshToDracoBuffer_2=k.asm.emscripten_bind_Encoder_EncodeMeshToDracoBuffer_2).apply(null,arguments)},Me=k._emscripten_bind_Encoder_EncodePointCloudToDracoBuffer_3=function(){return(Me=k._emscripten_bind_Encoder_EncodePointCloudToDracoBuffer_3=k.asm.emscripten_bind_Encoder_EncodePointCloudToDracoBuffer_3).apply(null,arguments)},Fe=k._emscripten_bind_Encoder_GetNumberOfEncodedPoints_0=function(){return(Fe=k._emscripten_bind_Encoder_GetNumberOfEncodedPoints_0=k.asm.emscripten_bind_Encoder_GetNumberOfEncodedPoints_0).apply(null,arguments)},ke=k._emscripten_bind_Encoder_GetNumberOfEncodedFaces_0=function(){return(ke=k._emscripten_bind_Encoder_GetNumberOfEncodedFaces_0=k.asm.emscripten_bind_Encoder_GetNumberOfEncodedFaces_0).apply(null,arguments)},Re=k._emscripten_bind_Encoder___destroy___0=function(){return(Re=k._emscripten_bind_Encoder___destroy___0=k.asm.emscripten_bind_Encoder___destroy___0).apply(null,arguments)},Be=k._emscripten_bind_ExpertEncoder_ExpertEncoder_1=function(){return(Be=k._emscripten_bind_ExpertEncoder_ExpertEncoder_1=k.asm.emscripten_bind_ExpertEncoder_ExpertEncoder_1).apply(null,arguments)},ze=k._emscripten_bind_ExpertEncoder_SetEncodingMethod_1=function(){return(ze=k._emscripten_bind_ExpertEncoder_SetEncodingMethod_1=k.asm.emscripten_bind_ExpertEncoder_SetEncodingMethod_1).apply(null,arguments)},Ge=k._emscripten_bind_ExpertEncoder_SetAttributeQuantization_2=function(){return(Ge=k._emscripten_bind_ExpertEncoder_SetAttributeQuantization_2=k.asm.emscripten_bind_ExpertEncoder_SetAttributeQuantization_2).apply(null,arguments)},Ne=k._emscripten_bind_ExpertEncoder_SetAttributeExplicitQuantization_5=function(){return(Ne=k._emscripten_bind_ExpertEncoder_SetAttributeExplicitQuantization_5=k.asm.emscripten_bind_ExpertEncoder_SetAttributeExplicitQuantization_5).apply(null,arguments)},Le=k._emscripten_bind_ExpertEncoder_SetSpeedOptions_2=function(){return(Le=k._emscripten_bind_ExpertEncoder_SetSpeedOptions_2=k.asm.emscripten_bind_ExpertEncoder_SetSpeedOptions_2).apply(null,arguments)},Ue=k._emscripten_bind_ExpertEncoder_SetTrackEncodedProperties_1=function(){return(Ue=k._emscripten_bind_ExpertEncoder_SetTrackEncodedProperties_1=k.asm.emscripten_bind_ExpertEncoder_SetTrackEncodedProperties_1).apply(null,arguments)},We=k._emscripten_bind_ExpertEncoder_EncodeToDracoBuffer_2=function(){return(We=k._emscripten_bind_ExpertEncoder_EncodeToDracoBuffer_2=k.asm.emscripten_bind_ExpertEncoder_EncodeToDracoBuffer_2).apply(null,arguments)},He=k._emscripten_bind_ExpertEncoder_GetNumberOfEncodedPoints_0=function(){return(He=k._emscripten_bind_ExpertEncoder_GetNumberOfEncodedPoints_0=k.asm.emscripten_bind_ExpertEncoder_GetNumberOfEncodedPoints_0).apply(null,arguments)},Ve=k._emscripten_bind_ExpertEncoder_GetNumberOfEncodedFaces_0=function(){return(Ve=k._emscripten_bind_ExpertEncoder_GetNumberOfEncodedFaces_0=k.asm.emscripten_bind_ExpertEncoder_GetNumberOfEncodedFaces_0).apply(null,arguments)},Ye=k._emscripten_bind_ExpertEncoder___destroy___0=function(){return(Ye=k._emscripten_bind_ExpertEncoder___destroy___0=k.asm.emscripten_bind_ExpertEncoder___destroy___0).apply(null,arguments)},Qe=k._emscripten_enum_draco_GeometryAttribute_Type_INVALID=function(){return(Qe=k._emscripten_enum_draco_GeometryAttribute_Type_INVALID=k.asm.emscripten_enum_draco_GeometryAttribute_Type_INVALID).apply(null,arguments)},qe=k._emscripten_enum_draco_GeometryAttribute_Type_POSITION=function(){return(qe=k._emscripten_enum_draco_GeometryAttribute_Type_POSITION=k.asm.emscripten_enum_draco_GeometryAttribute_Type_POSITION).apply(null,arguments)},Ke=k._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=function(){return(Ke=k._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=k.asm.emscripten_enum_draco_GeometryAttribute_Type_NORMAL).apply(null,arguments)},$e=k._emscripten_enum_draco_GeometryAttribute_Type_COLOR=function(){return($e=k._emscripten_enum_draco_GeometryAttribute_Type_COLOR=k.asm.emscripten_enum_draco_GeometryAttribute_Type_COLOR).apply(null,arguments)},Xe=k._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=function(){return(Xe=k._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=k.asm.emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD).apply(null,arguments)},Ze=k._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=function(){return(Ze=k._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=k.asm.emscripten_enum_draco_GeometryAttribute_Type_GENERIC).apply(null,arguments)},Je=k._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=function(){return(Je=k._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=k.asm.emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE).apply(null,arguments)},tr=k._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=function(){return(tr=k._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=k.asm.emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD).apply(null,arguments)},er=k._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=function(){return(er=k._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=k.asm.emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH).apply(null,arguments)},rr=k._emscripten_enum_draco_MeshEncoderMethod_MESH_SEQUENTIAL_ENCODING=function(){return(rr=k._emscripten_enum_draco_MeshEncoderMethod_MESH_SEQUENTIAL_ENCODING=k.asm.emscripten_enum_draco_MeshEncoderMethod_MESH_SEQUENTIAL_ENCODING).apply(null,arguments)},nr=k._emscripten_enum_draco_MeshEncoderMethod_MESH_EDGEBREAKER_ENCODING=function(){return(nr=k._emscripten_enum_draco_MeshEncoderMethod_MESH_EDGEBREAKER_ENCODING=k.asm.emscripten_enum_draco_MeshEncoderMethod_MESH_EDGEBREAKER_ENCODING).apply(null,arguments)};k.___errno_location=function(){return(k.___errno_location=k.asm.__errno_location).apply(null,arguments)},k.stackSave=function(){return(k.stackSave=k.asm.stackSave).apply(null,arguments)},k.stackRestore=function(){return(k.stackRestore=k.asm.stackRestore).apply(null,arguments)},k.stackAlloc=function(){return(k.stackAlloc=k.asm.stackAlloc).apply(null,arguments)},k._setThrew=function(){return(k._setThrew=k.asm.setThrew).apply(null,arguments)},k._free=function(){return(k._free=k.asm.free).apply(null,arguments)};var or,ir=k._malloc=function(){return(ir=k._malloc=k.asm.malloc).apply(null,arguments)};if(_t=function t(){or||f(),or||(_t=t)},k.run=f,k.preInit)for("function"==typeof k.preInit&&(k.preInit=[k.preInit]);0<k.preInit.length;)k.preInit.pop()();f(),_.prototype=Object.create(_.prototype),_.prototype.constructor=_,_.prototype.__class__=_,_.__cache__={},k.WrapperObject=_,k.getCache=d,k.wrapPointer=m,k.castObject=function(t,e){return m(t.ptr,e)},k.NULL=m(0),k.destroy=function(t){if(!t.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";t.__destroy__(),delete d(t.__class__)[t.ptr]},k.compare=function(t,e){return t.ptr===e.ptr},k.getPointer=function(t){return t.ptr},k.getClass=function(t){return t.__class__};var ar={buffer:0,size:0,pos:0,temps:[],needed:0,prepare:function(){if(ar.needed){for(var t=0;t<ar.temps.length;t++)k._free(ar.temps[t]);ar.temps.length=0,k._free(ar.buffer),ar.buffer=0,ar.size+=ar.needed,ar.needed=0}ar.buffer||(ar.size+=128,ar.buffer=k._malloc(ar.size),e(ar.buffer)),ar.pos=0},alloc:function(t,r){return e(ar.buffer),t=7+(t=t.length*r.BYTES_PER_ELEMENT)&-8,ar.pos+t>=ar.size?(e(0<t),ar.needed+=t,r=k._malloc(t),ar.temps.push(r)):(r=ar.buffer+ar.pos,ar.pos+=t),r},copy:function(t,e,r){switch(r>>>=0,e.BYTES_PER_ELEMENT){case 2:r>>>=1;break;case 4:r>>>=2;break;case 8:r>>>=3}for(var n=0;n<t.length;n++)e[r+n]=t[n]}};return A.prototype=Object.create(_.prototype),A.prototype.constructor=A,A.prototype.__class__=A,A.__cache__={},k.VoidPtr=A,A.prototype.__destroy__=A.prototype.__destroy__=function(){vt(this.ptr)},w.prototype=Object.create(_.prototype),w.prototype.constructor=w,w.prototype.__class__=w,w.__cache__={},k.GeometryAttribute=w,w.prototype.__destroy__=w.prototype.__destroy__=function(){At(this.ptr)},x.prototype=Object.create(_.prototype),x.prototype.constructor=x,x.prototype.__class__=x,x.__cache__={},k.PointAttribute=x,x.prototype.size=x.prototype.size=function(){return xt(this.ptr)},x.prototype.attribute_type=x.prototype.attribute_type=function(){return Et(this.ptr)},x.prototype.data_type=x.prototype.data_type=function(){return Ot(this.ptr)},x.prototype.num_components=x.prototype.num_components=function(){return Tt(this.ptr)},x.prototype.normalized=x.prototype.normalized=function(){return!!jt(this.ptr)},x.prototype.byte_stride=x.prototype.byte_stride=function(){return St(this.ptr)},x.prototype.byte_offset=x.prototype.byte_offset=function(){return Ct(this.ptr)},x.prototype.unique_id=x.prototype.unique_id=function(){return Dt(this.ptr)},x.prototype.__destroy__=x.prototype.__destroy__=function(){It(this.ptr)},E.prototype=Object.create(_.prototype),E.prototype.constructor=E,E.prototype.__class__=E,E.__cache__={},k.PointCloud=E,E.prototype.num_attributes=E.prototype.num_attributes=function(){return Mt(this.ptr)},E.prototype.num_points=E.prototype.num_points=function(){return Ft(this.ptr)},E.prototype.__destroy__=E.prototype.__destroy__=function(){kt(this.ptr)},O.prototype=Object.create(_.prototype),O.prototype.constructor=O,O.prototype.__class__=O,O.__cache__={},k.Mesh=O,O.prototype.num_faces=O.prototype.num_faces=function(){return Bt(this.ptr)},O.prototype.num_attributes=O.prototype.num_attributes=function(){return zt(this.ptr)},O.prototype.num_points=O.prototype.num_points=function(){return Gt(this.ptr)},O.prototype.set_num_points=O.prototype.set_num_points=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Nt(e,t)},O.prototype.__destroy__=O.prototype.__destroy__=function(){Lt(this.ptr)},T.prototype=Object.create(_.prototype),T.prototype.constructor=T,T.prototype.__class__=T,T.__cache__={},k.Metadata=T,T.prototype.__destroy__=T.prototype.__destroy__=function(){Wt(this.ptr)},j.prototype=Object.create(_.prototype),j.prototype.constructor=j,j.prototype.__class__=j,j.__cache__={},k.DracoInt8Array=j,j.prototype.GetValue=j.prototype.GetValue=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Vt(e,t)},j.prototype.size=j.prototype.size=function(){return Yt(this.ptr)},j.prototype.__destroy__=j.prototype.__destroy__=function(){Qt(this.ptr)},S.prototype=Object.create(_.prototype),S.prototype.constructor=S,S.prototype.__class__=S,S.__cache__={},k.MetadataBuilder=S,S.prototype.AddStringEntry=S.prototype.AddStringEntry=function(t,e,r){var n=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:h(e),r=r&&"object"==typeof r?r.ptr:h(r),!!Kt(n,t,e,r)},S.prototype.AddIntEntry=S.prototype.AddIntEntry=function(t,e,r){var n=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:h(e),r&&"object"==typeof r&&(r=r.ptr),!!$t(n,t,e,r)},S.prototype.AddIntEntryArray=S.prototype.AddIntEntryArray=function(t,e,r,n){var o=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:h(e),"object"==typeof r&&(r=v(r)),n&&"object"==typeof n&&(n=n.ptr),!!Xt(o,t,e,r,n)},S.prototype.AddDoubleEntry=S.prototype.AddDoubleEntry=function(t,e,r){var n=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:h(e),r&&"object"==typeof r&&(r=r.ptr),!!Zt(n,t,e,r)},S.prototype.__destroy__=S.prototype.__destroy__=function(){Jt(this.ptr)},C.prototype=Object.create(_.prototype),C.prototype.constructor=C,C.prototype.__class__=C,C.__cache__={},k.PointCloudBuilder=C,C.prototype.AddFloatAttribute=C.prototype.AddFloatAttribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=g(o)),ee(i,t,e,r,n,o)},C.prototype.AddInt8Attribute=C.prototype.AddInt8Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=y(o)),re(i,t,e,r,n,o)},C.prototype.AddUInt8Attribute=C.prototype.AddUInt8Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=y(o)),ne(i,t,e,r,n,o)},C.prototype.AddInt16Attribute=C.prototype.AddInt16Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=b(o)),oe(i,t,e,r,n,o)},C.prototype.AddUInt16Attribute=C.prototype.AddUInt16Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=b(o)),ie(i,t,e,r,n,o)},C.prototype.AddInt32Attribute=C.prototype.AddInt32Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=v(o)),ae(i,t,e,r,n,o)},C.prototype.AddUInt32Attribute=C.prototype.AddUInt32Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=v(o)),se(i,t,e,r,n,o)},C.prototype.AddMetadata=C.prototype.AddMetadata=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),!!ce(r,t,e)},C.prototype.SetMetadataForAttribute=C.prototype.SetMetadataForAttribute=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!ue(n,t,e,r)},C.prototype.__destroy__=C.prototype.__destroy__=function(){pe(this.ptr)},D.prototype=Object.create(_.prototype),D.prototype.constructor=D,D.prototype.__class__=D,D.__cache__={},k.MeshBuilder=D,D.prototype.AddFacesToMesh=D.prototype.AddFacesToMesh=function(t,e,r){var n=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),"object"==typeof r&&(r=v(r)),!!fe(n,t,e,r)},D.prototype.AddFloatAttributeToMesh=D.prototype.AddFloatAttributeToMesh=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=g(o)),_e(i,t,e,r,n,o)},D.prototype.AddInt32AttributeToMesh=D.prototype.AddInt32AttributeToMesh=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=v(o)),de(i,t,e,r,n,o)},D.prototype.AddMetadataToMesh=D.prototype.AddMetadataToMesh=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),!!me(r,t,e)},D.prototype.AddFloatAttribute=D.prototype.AddFloatAttribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=g(o)),he(i,t,e,r,n,o)},D.prototype.AddInt8Attribute=D.prototype.AddInt8Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=y(o)),ye(i,t,e,r,n,o)},D.prototype.AddUInt8Attribute=D.prototype.AddUInt8Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=y(o)),be(i,t,e,r,n,o)},D.prototype.AddInt16Attribute=D.prototype.AddInt16Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=b(o)),ve(i,t,e,r,n,o)},D.prototype.AddUInt16Attribute=D.prototype.AddUInt16Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=b(o)),ge(i,t,e,r,n,o)},D.prototype.AddInt32Attribute=D.prototype.AddInt32Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=v(o)),Ae(i,t,e,r,n,o)},D.prototype.AddUInt32Attribute=D.prototype.AddUInt32Attribute=function(t,e,r,n,o){var i=this.ptr;return ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),"object"==typeof o&&(o=v(o)),we(i,t,e,r,n,o)},D.prototype.AddMetadata=D.prototype.AddMetadata=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),!!xe(r,t,e)},D.prototype.SetMetadataForAttribute=D.prototype.SetMetadataForAttribute=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Ee(n,t,e,r)},D.prototype.__destroy__=D.prototype.__destroy__=function(){Oe(this.ptr)},I.prototype=Object.create(_.prototype),I.prototype.constructor=I,I.prototype.__class__=I,I.__cache__={},k.Encoder=I,I.prototype.SetEncodingMethod=I.prototype.SetEncodingMethod=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),je(e,t)},I.prototype.SetAttributeQuantization=I.prototype.SetAttributeQuantization=function(t,e){var r=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Se(r,t,e)},I.prototype.SetAttributeExplicitQuantization=I.prototype.SetAttributeExplicitQuantization=function(t,e,r,n,o){var i=this.ptr;ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),"object"==typeof n&&(n=g(n)),o&&"object"==typeof o&&(o=o.ptr),Ce(i,t,e,r,n,o)},I.prototype.SetSpeedOptions=I.prototype.SetSpeedOptions=function(t,e){var r=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),De(r,t,e)},I.prototype.SetTrackEncodedProperties=I.prototype.SetTrackEncodedProperties=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ie(e,t)},I.prototype.EncodeMeshToDracoBuffer=I.prototype.EncodeMeshToDracoBuffer=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Pe(r,t,e)},I.prototype.EncodePointCloudToDracoBuffer=I.prototype.EncodePointCloudToDracoBuffer=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),Me(n,t,e,r)},I.prototype.GetNumberOfEncodedPoints=I.prototype.GetNumberOfEncodedPoints=function(){return Fe(this.ptr)},I.prototype.GetNumberOfEncodedFaces=I.prototype.GetNumberOfEncodedFaces=function(){return ke(this.ptr)},I.prototype.__destroy__=I.prototype.__destroy__=function(){Re(this.ptr)},P.prototype=Object.create(_.prototype),P.prototype.constructor=P,P.prototype.__class__=P,P.__cache__={},k.ExpertEncoder=P,P.prototype.SetEncodingMethod=P.prototype.SetEncodingMethod=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),ze(e,t)},P.prototype.SetAttributeQuantization=P.prototype.SetAttributeQuantization=function(t,e){var r=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Ge(r,t,e)},P.prototype.SetAttributeExplicitQuantization=P.prototype.SetAttributeExplicitQuantization=function(t,e,r,n,o){var i=this.ptr;ar.prepare(),t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),"object"==typeof n&&(n=g(n)),o&&"object"==typeof o&&(o=o.ptr),Ne(i,t,e,r,n,o)},P.prototype.SetSpeedOptions=P.prototype.SetSpeedOptions=function(t,e){var r=this.ptr;t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),Le(r,t,e)},P.prototype.SetTrackEncodedProperties=P.prototype.SetTrackEncodedProperties=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Ue(e,t)},P.prototype.EncodeToDracoBuffer=P.prototype.EncodeToDracoBuffer=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),We(r,t,e)},P.prototype.GetNumberOfEncodedPoints=P.prototype.GetNumberOfEncodedPoints=function(){return He(this.ptr)},P.prototype.GetNumberOfEncodedFaces=P.prototype.GetNumberOfEncodedFaces=function(){return Ve(this.ptr)},P.prototype.__destroy__=P.prototype.__destroy__=function(){Ye(this.ptr)},function(){function t(){k.INVALID=Qe(),k.POSITION=qe(),k.NORMAL=Ke(),k.COLOR=$e(),k.TEX_COORD=Xe(),k.GENERIC=Ze(),k.INVALID_GEOMETRY_TYPE=Je(),k.POINT_CLOUD=tr(),k.TRIANGULAR_MESH=er(),k.MESH_SEQUENTIAL_ENCODING=rr(),k.MESH_EDGEBREAKER_ENCODING=nr()}lt?t():ut.unshift(t)}(),"function"==typeof k.onModuleParsed&&k.onModuleParsed(),t.ready});t.exports=o});ma.DracoEncoderModule;var ha=_(function(t,e){var r=r||{};r.scope={},r.arrayIteratorImpl=function(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}},r.arrayIterator=function(t){return{next:r.arrayIteratorImpl(t)}},r.makeIterator=function(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):r.arrayIterator(t)},r.ASSUME_ES5=!1,r.ASSUME_NO_NATIVE_MAP=!1,r.ASSUME_NO_NATIVE_SET=!1,r.SIMPLE_FROUND_POLYFILL=!1,r.ISOLATE_POLYFILLS=!1,r.FORCE_POLYFILL_PROMISE=!1,r.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,r.getGlobal=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof f&&f];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},r.global=r.getGlobal(f),r.defineProperty=r.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,r){return t==Array.prototype||t==Object.prototype?t:(t[e]=r.value,t)},r.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),r.TRUST_ES6_POLYFILLS=!r.ISOLATE_POLYFILLS||r.IS_SYMBOL_NATIVE,r.polyfills={},r.propertyToPolyfillSymbol={},r.POLYFILL_PREFIX="$jscp$",r.polyfill=function(t,e,n,o){e&&(r.ISOLATE_POLYFILLS?r.polyfillIsolated(t,e,n,o):r.polyfillUnisolated(t,e,n,o))},r.polyfillUnisolated=function(t,e,n,o){for(n=r.global,t=t.split("."),o=0;o<t.length-1;o++){var i=t[o];if(!(i in n))return;n=n[i]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r.defineProperty(n,t,{configurable:!0,writable:!0,value:e})},r.polyfillIsolated=function(t,e,n,o){var i=t.split(".");t=1===i.length,o=i[0],o=!t&&o in r.polyfills?r.polyfills:r.global;for(var a=0;a<i.length-1;a++){var s=i[a];if(!(s in o))return;o=o[s]}i=i[i.length-1],null!=(e=e(n=r.IS_SYMBOL_NATIVE&&"es6"===n?o[i]:null))&&(t?r.defineProperty(r.polyfills,i,{configurable:!0,writable:!0,value:e}):e!==n&&(r.propertyToPolyfillSymbol[i]=r.IS_SYMBOL_NATIVE?r.global.Symbol(i):r.POLYFILL_PREFIX+i,i=r.propertyToPolyfillSymbol[i],r.defineProperty(o,i,{configurable:!0,writable:!0,value:e})))},r.polyfill("Promise",function(t){function e(){this.batch_=null}function n(t){return t instanceof i?t:new i(function(e,r){e(t)})}if(t&&(!(r.FORCE_POLYFILL_PROMISE||r.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&void 0===r.global.PromiseRejectionEvent)||!r.global.Promise||-1===r.global.Promise.toString().indexOf("[native code]")))return t;e.prototype.asyncExecute=function(t){if(null==this.batch_){this.batch_=[];var e=this;this.asyncExecuteFunction(function(){e.executeBatch_()})}this.batch_.push(t)};var o=r.global.setTimeout;e.prototype.asyncExecuteFunction=function(t){o(t,0)},e.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var t=this.batch_;this.batch_=[];for(var e=0;e<t.length;++e){var r=t[e];t[e]=null;try{r()}catch(t){this.asyncThrow_(t)}}}this.batch_=null},e.prototype.asyncThrow_=function(t){this.asyncExecuteFunction(function(){throw t})};var i=function(t){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[],this.isRejectionHandled_=!1;var e=this.createResolveAndReject_();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}};i.prototype.createResolveAndReject_=function(){function t(t){return function(n){r||(r=!0,t.call(e,n))}}var e=this,r=!1;return{resolve:t(this.resolveTo_),reject:t(this.reject_)}},i.prototype.resolveTo_=function(t){if(t===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof i)this.settleSameAsPromise_(t);else{t:switch(typeof t){case"object":var e=null!=t;break t;case"function":e=!0;break t;default:e=!1}e?this.resolveToNonPromiseObj_(t):this.fulfill_(t)}},i.prototype.resolveToNonPromiseObj_=function(t){var e=void 0;try{e=t.then}catch(t){return void this.reject_(t)}"function"==typeof e?this.settleSameAsThenable_(e,t):this.fulfill_(t)},i.prototype.reject_=function(t){this.settle_(2,t)},i.prototype.fulfill_=function(t){this.settle_(1,t)},i.prototype.settle_=function(t,e){if(0!=this.state_)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.state_);this.state_=t,this.result_=e,2===this.state_&&this.scheduleUnhandledRejectionCheck_(),this.executeOnSettledCallbacks_()},i.prototype.scheduleUnhandledRejectionCheck_=function(){var t=this;o(function(){if(t.notifyUnhandledRejection_()){var e=r.global.console;void 0!==e&&e.error(t.result_)}},1)},i.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var t=r.global.CustomEvent,e=r.global.Event,n=r.global.dispatchEvent;return void 0===n||("function"==typeof t?t=new t("unhandledrejection",{cancelable:!0}):"function"==typeof e?t=new e("unhandledrejection",{cancelable:!0}):(t=r.global.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,t),t.promise=this,t.reason=this.result_,n(t))},i.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var t=0;t<this.onSettledCallbacks_.length;++t)a.asyncExecute(this.onSettledCallbacks_[t]);this.onSettledCallbacks_=null}};var a=new e;return i.prototype.settleSameAsPromise_=function(t){var e=this.createResolveAndReject_();t.callWhenSettled_(e.resolve,e.reject)},i.prototype.settleSameAsThenable_=function(t,e){var r=this.createResolveAndReject_();try{t.call(e,r.resolve,r.reject)}catch(t){r.reject(t)}},i.prototype.then=function(t,e){function r(t,e){return"function"==typeof t?function(e){try{n(t(e))}catch(t){o(t)}}:e}var n,o,a=new i(function(t,e){n=t,o=e});return this.callWhenSettled_(r(t,n),r(e,o)),a},i.prototype.catch=function(t){return this.then(void 0,t)},i.prototype.callWhenSettled_=function(t,e){function r(){switch(n.state_){case 1:t(n.result_);break;case 2:e(n.result_);break;default:throw Error("Unexpected state: "+n.state_)}}var n=this;null==this.onSettledCallbacks_?a.asyncExecute(r):this.onSettledCallbacks_.push(r),this.isRejectionHandled_=!0},i.resolve=n,i.reject=function(t){return new i(function(e,r){r(t)})},i.race=function(t){return new i(function(e,o){for(var i=r.makeIterator(t),a=i.next();!a.done;a=i.next())n(a.value).callWhenSettled_(e,o)})},i.all=function(t){var e=r.makeIterator(t),o=e.next();return o.done?n([]):new i(function(t,r){function i(e){return function(r){a[e]=r,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,n(o.value).callWhenSettled_(i(a.length-1),r),o=e.next()}while(!o.done)})},i},"es6","es3"),r.checkEs6ConformanceViaProxy=function(){try{var t={},e=Object.create(new r.global.Proxy(t,{get:function(r,n,o){return r==t&&"q"==n&&o==e}}));return!0===e.q}catch(t){return!1}},r.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,r.ES6_CONFORMANCE=r.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&r.checkEs6ConformanceViaProxy(),r.owns=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.polyfill("Array.prototype.copyWithin",function(t){function e(t){return 1/0===(t=Number(t))||-1/0===t?t:0|t}return t||function(t,r,n){var o=this.length;if(t=e(t),r=e(r),n=void 0===n?o:e(n),t=0>t?Math.max(o+t,0):Math.min(t,o),r=0>r?Math.max(o+r,0):Math.min(r,o),n=0>n?Math.max(o+n,0):Math.min(n,o),t<r)for(;r<n;)r in this?this[t++]=this[r++]:(delete this[t++],r++);else for(t+=(n=Math.min(n,o+r-t))-r;n>r;)--n in this?this[--t]=this[n]:delete this[--t];return this}},"es6","es3"),r.typedArrayCopyWithin=function(t){return t||Array.prototype.copyWithin},r.polyfill("Int8Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Uint8Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Uint8ClampedArray.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Int16Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Uint16Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Int32Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Uint32Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Float32Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5"),r.polyfill("Float64Array.prototype.copyWithin",r.typedArrayCopyWithin,"es6","es5");var n,o=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(n=n||__filename),function(t){function e(t,e){t||s("Assertion failed: "+e)}function r(t,e,r){var n=e+r;for(r=e;t[r]&&!(r>=n);)++r;if(16<r-e&&t.subarray&&st)return st.decode(t.subarray(e,r));for(n="";e<r;){var o=t[e++];if(128&o){var i=63&t[e++];if(192==(224&o))n+=String.fromCharCode((31&o)<<6|i);else{var a=63&t[e++];65536>(o=224==(240&o)?(15&o)<<12|i<<6|a:(7&o)<<18|i<<12|a<<6|63&t[e++])?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296|o>>10,56320|1023&o))}}else n+=String.fromCharCode(o)}return n}function o(t,e){return t?r(ut,t,e):""}function i(t,e){return 0<t%e&&(t+=e-t%e),t}function a(t){ft=t,U.HEAP8=ct=new Int8Array(t),U.HEAP16=new Int16Array(t),U.HEAP32=pt=new Int32Array(t),U.HEAPU8=ut=new Uint8Array(t),U.HEAPU16=new Uint16Array(t),U.HEAPU32=new Uint32Array(t),U.HEAPF32=new Float32Array(t),U.HEAPF64=new Float64Array(t)}function s(t){throw U.onAbort&&U.onAbort(t),ot(t+=""),at=!0,t=new WebAssembly.RuntimeError("abort("+t+"). Build with -s ASSERTIONS=1 for more info."),L(t),t}function p(t,e){return String.prototype.startsWith?t.startsWith(e):0===t.indexOf(e)}function l(){try{if(rt)return new Uint8Array(rt);if(et)return et(wt);throw"both async and sync fetching of the wasm failed"}catch(t){s(t)}}function f(t){for(;0<t.length;){var e=t.shift();if("function"==typeof e)e(U);else{var r=e.func;"number"==typeof r?void 0===e.arg?_t.get(r)():_t.get(r)(e.arg):r(void 0===e.arg?null:e.arg)}}}function _(t){this.excPtr=t,this.ptr=t-xt.SIZE,this.set_type=function(t){pt[this.ptr+xt.TYPE_OFFSET>>2]=t},this.get_type=function(){return pt[this.ptr+xt.TYPE_OFFSET>>2]},this.set_destructor=function(t){pt[this.ptr+xt.DESTRUCTOR_OFFSET>>2]=t},this.get_destructor=function(){return pt[this.ptr+xt.DESTRUCTOR_OFFSET>>2]},this.set_refcount=function(t){pt[this.ptr+xt.REFCOUNT_OFFSET>>2]=t},this.set_caught=function(t){ct[this.ptr+xt.CAUGHT_OFFSET>>0]=t?1:0},this.get_caught=function(){return 0!=ct[this.ptr+xt.CAUGHT_OFFSET>>0]},this.set_rethrown=function(t){ct[this.ptr+xt.RETHROWN_OFFSET>>0]=t?1:0},this.get_rethrown=function(){return 0!=ct[this.ptr+xt.RETHROWN_OFFSET>>0]},this.init=function(t,e){this.set_type(t),this.set_destructor(e),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){pt[this.ptr+xt.REFCOUNT_OFFSET>>2]+=1},this.release_ref=function(){var t=pt[this.ptr+xt.REFCOUNT_OFFSET>>2];return pt[this.ptr+xt.REFCOUNT_OFFSET>>2]=t-1,1===t}}function d(t){function e(){if(!un&&(un=!0,U.calledRun=!0,!at)){if(bt=!0,f(mt),f(ht),N(U),U.onRuntimeInitialized&&U.onRuntimeInitialized(),U.postRun)for("function"==typeof U.postRun&&(U.postRun=[U.postRun]);U.postRun.length;)yt.unshift(U.postRun.shift());f(yt)}}if(!(0<vt)){if(U.preRun)for("function"==typeof U.preRun&&(U.preRun=[U.preRun]);U.preRun.length;)dt.unshift(U.preRun.shift());f(dt),0<vt||(U.setStatus?(U.setStatus("Running..."),setTimeout(function(){setTimeout(function(){U.setStatus("")},1),e()},1)):e())}}function m(){}function h(t){return(t||m).__cache__}function y(t,e){var r=h(e),n=r[t];return n||((n=Object.create((e||m).prototype)).ptr=t,r[t]=n)}function b(t){if("string"==typeof t){for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);55296<=n&&57343>=n&&(n=65536+((1023&n)<<10)|1023&t.charCodeAt(++r)),127>=n?++e:e=2047>=n?e+2:65535>=n?e+3:e+4}if(r=0,0<(n=(e=Array(e+1)).length)){n=r+n-1;for(var o=0;o<t.length;++o){var i=t.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++o)),127>=i){if(r>=n)break;e[r++]=i}else{if(2047>=i){if(r+1>=n)break;e[r++]=192|i>>6}else{if(65535>=i){if(r+2>=n)break;e[r++]=224|i>>12}else{if(r+3>=n)break;e[r++]=240|i>>18,e[r++]=128|i>>12&63}e[r++]=128|i>>6&63}e[r++]=128|63&i}}e[r]=0}return t=ln.alloc(e,ct),ln.copy(e,ct,t),t}return t}function v(t){if("object"==typeof t){var e=ln.alloc(t,ct);return ln.copy(t,ct,e),e}return t}function g(){throw"cannot construct a VoidPtr, no constructor in IDL"}function A(){this.ptr=St(),h(A)[this.ptr]=this}function w(){this.ptr=It(),h(w)[this.ptr]=this}function x(){this.ptr=Ft(),h(x)[this.ptr]=this}function E(){this.ptr=Rt(),h(E)[this.ptr]=this}function O(){this.ptr=Qt(),h(O)[this.ptr]=this}function T(){this.ptr=Jt(),h(T)[this.ptr]=this}function j(){this.ptr=ne(),h(j)[this.ptr]=this}function S(){this.ptr=se(),h(S)[this.ptr]=this}function C(){this.ptr=fe(),h(C)[this.ptr]=this}function D(){throw"cannot construct a Status, no constructor in IDL"}function I(){this.ptr=be(),h(I)[this.ptr]=this}function P(){this.ptr=we(),h(P)[this.ptr]=this}function M(){this.ptr=Te(),h(M)[this.ptr]=this}function F(){this.ptr=De(),h(F)[this.ptr]=this}function k(){this.ptr=Fe(),h(k)[this.ptr]=this}function R(){this.ptr=ze(),h(R)[this.ptr]=this}function B(){this.ptr=Ue(),h(B)[this.ptr]=this}function z(){this.ptr=Ye(),h(z)[this.ptr]=this}function G(){this.ptr=er(),h(G)[this.ptr]=this}var N,L,U=void 0!==(t=t||{})?t:{};U.ready=new Promise(function(t,e){N=t,L=e});var W=!1,H=!1;U.onRuntimeInitialized=function(){W=!0,H&&"function"==typeof U.onModuleLoaded&&U.onModuleLoaded(U)},U.onModuleParsed=function(){H=!0,W&&"function"==typeof U.onModuleLoaded&&U.onModuleLoaded(U)},U.isVersionSupported=function(t){return"string"==typeof t&&!(2>(t=t.split(".")).length||3<t.length)&&(1==t[0]&&0<=t[1]&&4>=t[1]||!(0!=t[0]||10<t[1]))};var V,Y={};for(V in U)U.hasOwnProperty(V)&&(Y[V]=U[V]);var Q,q,K=!1,$=!1;K="object"==typeof window,$="function"==typeof importScripts,Q="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,q=!K&&!Q&&!$;var X,Z,J="";if(Q){J=$?c.default.dirname(J)+"/":__dirname+"/";var tt=function(t,e){return X||(X=u.default),Z||(Z=c.default),t=Z.normalize(t),X.readFileSync(t,e?null:"utf8")},et=function(t){return(t=tt(t,!0)).buffer||(t=new Uint8Array(t)),e(t.buffer),t};1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),U.inspect=function(){return"[Emscripten Module object]"}}else q?("undefined"!=typeof read&&(tt=function(t){return read(t)}),et=function(t){return"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(e("object"==typeof(t=read(t,"binary"))),t)},"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(K||$)&&($?J=self.location.href:"undefined"!=typeof document&&document.currentScript&&(J=document.currentScript.src),n&&(J=n),J=0!==J.indexOf("blob:")?J.substr(0,J.lastIndexOf("/")+1):"",tt=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},$&&(et=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}));var rt,nt=U.print||console.log.bind(console),ot=U.printErr||console.warn.bind(console);for(V in Y)Y.hasOwnProperty(V)&&(U[V]=Y[V]);Y=null,U.wasmBinary&&(rt=U.wasmBinary),"object"!=typeof WebAssembly&&s("no native wasm support detected");var it,at=!1,st="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var ct,ut,pt,lt=U.INITIAL_MEMORY||16777216;if(it=U.wasmMemory?U.wasmMemory:new WebAssembly.Memory({initial:lt/65536,maximum:32768}))var ft=it.buffer;lt=ft.byteLength,a(ft);var _t,dt=[],mt=[],ht=[],yt=[],bt=!1,vt=0,gt=null;U.preloadedImages={},U.preloadedAudios={};var At,wt="draco_decoder.wasm";p(wt,"data:application/octet-stream;base64,")||(At=wt,wt=U.locateFile?U.locateFile(At,J):J+At);var xt={DESTRUCTOR_OFFSET:0,REFCOUNT_OFFSET:4,TYPE_OFFSET:8,CAUGHT_OFFSET:12,RETHROWN_OFFSET:13,SIZE:16},Et={mappings:{},buffers:[null,[],[]],printChar:function(t,e){var n=Et.buffers[t];0===e||10===e?((1===t?nt:ot)(r(n,0)),n.length=0):n.push(e)},varargs:void 0,get:function(){return Et.varargs+=4,pt[Et.varargs-4>>2]},getStr:function(t){return o(t)},get64:function(t,e){return t}};mt.push({func:function(){Tt()}});var Ot={__cxa_allocate_exception:function(t){return pn(t+xt.SIZE)+xt.SIZE},__cxa_throw:function(t,e,r){throw new _(t).init(e,r),t},abort:function(){s()},array_bounds_check_error:function(t,e){throw"Array index "+t+" out of bounds: [0,"+e+")"},emscripten_memcpy_big:function(t,e,r){ut.copyWithin(t,e,e+r)},emscripten_resize_heap:function(t){t>>>=0;var e=ut.length;if(2147483648<t)return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296),n=Math.min(2147483648,i(Math.max(16777216,t,n),65536));t:{try{it.grow(n-ft.byteLength+65535>>>16),a(it.buffer);var o=1;break t}catch(t){}o=void 0}if(o)return!0}return!1},fd_close:function(t){return 0},fd_seek:function(t,e,r,n,o){},fd_write:function(t,e,r,n){for(var o=0,i=0;i<r;i++){for(var a=pt[e+8*i>>2],s=pt[e+(8*i+4)>>2],c=0;c<s;c++)Et.printChar(t,ut[a+c]);o+=s}return pt[n>>2]=o,0},memory:it,setTempRet0:function(t){}};!function(){function t(t,e){U.asm=t.exports,_t=U.asm.__indirect_function_table,vt--,U.monitorRunDependencies&&U.monitorRunDependencies(vt),0==vt&&gt&&(t=gt,gt=null,t())}function e(e){t(e.instance)}function r(t){return(rt||!K&&!$||"function"!=typeof fetch||p(wt,"file://")?Promise.resolve().then(l):fetch(wt,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+wt+"'";return t.arrayBuffer()}).catch(function(){return l()})).then(function(t){return WebAssembly.instantiate(t,n)}).then(t,function(t){ot("failed to asynchronously prepare wasm: "+t),s(t)})}var n={env:Ot,wasi_snapshot_preview1:Ot};if(vt++,U.monitorRunDependencies&&U.monitorRunDependencies(vt),U.instantiateWasm)try{return U.instantiateWasm(n,t)}catch(t){return ot("Module.instantiateWasm callback failed with error: "+t),!1}(rt||"function"!=typeof WebAssembly.instantiateStreaming||p(wt,"data:application/octet-stream;base64,")||p(wt,"file://")||"function"!=typeof fetch?r(e):fetch(wt,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,n).then(e,function(t){return ot("wasm streaming compile failed: "+t),ot("falling back to ArrayBuffer instantiation"),r(e)})})).catch(L)}();var Tt=U.___wasm_call_ctors=function(){return(Tt=U.___wasm_call_ctors=U.asm.__wasm_call_ctors).apply(null,arguments)};U.___em_js__array_bounds_check_error=function(){return(U.___em_js__array_bounds_check_error=U.asm.__em_js__array_bounds_check_error).apply(null,arguments)};var jt=U._emscripten_bind_VoidPtr___destroy___0=function(){return(jt=U._emscripten_bind_VoidPtr___destroy___0=U.asm.emscripten_bind_VoidPtr___destroy___0).apply(null,arguments)},St=U._emscripten_bind_DecoderBuffer_DecoderBuffer_0=function(){return(St=U._emscripten_bind_DecoderBuffer_DecoderBuffer_0=U.asm.emscripten_bind_DecoderBuffer_DecoderBuffer_0).apply(null,arguments)},Ct=U._emscripten_bind_DecoderBuffer_Init_2=function(){return(Ct=U._emscripten_bind_DecoderBuffer_Init_2=U.asm.emscripten_bind_DecoderBuffer_Init_2).apply(null,arguments)},Dt=U._emscripten_bind_DecoderBuffer___destroy___0=function(){return(Dt=U._emscripten_bind_DecoderBuffer___destroy___0=U.asm.emscripten_bind_DecoderBuffer___destroy___0).apply(null,arguments)},It=U._emscripten_bind_AttributeTransformData_AttributeTransformData_0=function(){return(It=U._emscripten_bind_AttributeTransformData_AttributeTransformData_0=U.asm.emscripten_bind_AttributeTransformData_AttributeTransformData_0).apply(null,arguments)},Pt=U._emscripten_bind_AttributeTransformData_transform_type_0=function(){return(Pt=U._emscripten_bind_AttributeTransformData_transform_type_0=U.asm.emscripten_bind_AttributeTransformData_transform_type_0).apply(null,arguments)},Mt=U._emscripten_bind_AttributeTransformData___destroy___0=function(){return(Mt=U._emscripten_bind_AttributeTransformData___destroy___0=U.asm.emscripten_bind_AttributeTransformData___destroy___0).apply(null,arguments)},Ft=U._emscripten_bind_GeometryAttribute_GeometryAttribute_0=function(){return(Ft=U._emscripten_bind_GeometryAttribute_GeometryAttribute_0=U.asm.emscripten_bind_GeometryAttribute_GeometryAttribute_0).apply(null,arguments)},kt=U._emscripten_bind_GeometryAttribute___destroy___0=function(){return(kt=U._emscripten_bind_GeometryAttribute___destroy___0=U.asm.emscripten_bind_GeometryAttribute___destroy___0).apply(null,arguments)},Rt=U._emscripten_bind_PointAttribute_PointAttribute_0=function(){return(Rt=U._emscripten_bind_PointAttribute_PointAttribute_0=U.asm.emscripten_bind_PointAttribute_PointAttribute_0).apply(null,arguments)},Bt=U._emscripten_bind_PointAttribute_size_0=function(){return(Bt=U._emscripten_bind_PointAttribute_size_0=U.asm.emscripten_bind_PointAttribute_size_0).apply(null,arguments)},zt=U._emscripten_bind_PointAttribute_GetAttributeTransformData_0=function(){return(zt=U._emscripten_bind_PointAttribute_GetAttributeTransformData_0=U.asm.emscripten_bind_PointAttribute_GetAttributeTransformData_0).apply(null,arguments)},Gt=U._emscripten_bind_PointAttribute_attribute_type_0=function(){return(Gt=U._emscripten_bind_PointAttribute_attribute_type_0=U.asm.emscripten_bind_PointAttribute_attribute_type_0).apply(null,arguments)},Nt=U._emscripten_bind_PointAttribute_data_type_0=function(){return(Nt=U._emscripten_bind_PointAttribute_data_type_0=U.asm.emscripten_bind_PointAttribute_data_type_0).apply(null,arguments)},Lt=U._emscripten_bind_PointAttribute_num_components_0=function(){return(Lt=U._emscripten_bind_PointAttribute_num_components_0=U.asm.emscripten_bind_PointAttribute_num_components_0).apply(null,arguments)},Ut=U._emscripten_bind_PointAttribute_normalized_0=function(){return(Ut=U._emscripten_bind_PointAttribute_normalized_0=U.asm.emscripten_bind_PointAttribute_normalized_0).apply(null,arguments)},Wt=U._emscripten_bind_PointAttribute_byte_stride_0=function(){return(Wt=U._emscripten_bind_PointAttribute_byte_stride_0=U.asm.emscripten_bind_PointAttribute_byte_stride_0).apply(null,arguments)},Ht=U._emscripten_bind_PointAttribute_byte_offset_0=function(){return(Ht=U._emscripten_bind_PointAttribute_byte_offset_0=U.asm.emscripten_bind_PointAttribute_byte_offset_0).apply(null,arguments)},Vt=U._emscripten_bind_PointAttribute_unique_id_0=function(){return(Vt=U._emscripten_bind_PointAttribute_unique_id_0=U.asm.emscripten_bind_PointAttribute_unique_id_0).apply(null,arguments)},Yt=U._emscripten_bind_PointAttribute___destroy___0=function(){return(Yt=U._emscripten_bind_PointAttribute___destroy___0=U.asm.emscripten_bind_PointAttribute___destroy___0).apply(null,arguments)},Qt=U._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=function(){return(Qt=U._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=U.asm.emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0).apply(null,arguments)},qt=U._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=function(){return(qt=U._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=U.asm.emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1).apply(null,arguments)},Kt=U._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=function(){return(Kt=U._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=U.asm.emscripten_bind_AttributeQuantizationTransform_quantization_bits_0).apply(null,arguments)},$t=U._emscripten_bind_AttributeQuantizationTransform_min_value_1=function(){return($t=U._emscripten_bind_AttributeQuantizationTransform_min_value_1=U.asm.emscripten_bind_AttributeQuantizationTransform_min_value_1).apply(null,arguments)},Xt=U._emscripten_bind_AttributeQuantizationTransform_range_0=function(){return(Xt=U._emscripten_bind_AttributeQuantizationTransform_range_0=U.asm.emscripten_bind_AttributeQuantizationTransform_range_0).apply(null,arguments)},Zt=U._emscripten_bind_AttributeQuantizationTransform___destroy___0=function(){return(Zt=U._emscripten_bind_AttributeQuantizationTransform___destroy___0=U.asm.emscripten_bind_AttributeQuantizationTransform___destroy___0).apply(null,arguments)},Jt=U._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=function(){return(Jt=U._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=U.asm.emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0).apply(null,arguments)},te=U._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=function(){return(te=U._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=U.asm.emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1).apply(null,arguments)},ee=U._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=function(){return(ee=U._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=U.asm.emscripten_bind_AttributeOctahedronTransform_quantization_bits_0).apply(null,arguments)},re=U._emscripten_bind_AttributeOctahedronTransform___destroy___0=function(){return(re=U._emscripten_bind_AttributeOctahedronTransform___destroy___0=U.asm.emscripten_bind_AttributeOctahedronTransform___destroy___0).apply(null,arguments)},ne=U._emscripten_bind_PointCloud_PointCloud_0=function(){return(ne=U._emscripten_bind_PointCloud_PointCloud_0=U.asm.emscripten_bind_PointCloud_PointCloud_0).apply(null,arguments)},oe=U._emscripten_bind_PointCloud_num_attributes_0=function(){return(oe=U._emscripten_bind_PointCloud_num_attributes_0=U.asm.emscripten_bind_PointCloud_num_attributes_0).apply(null,arguments)},ie=U._emscripten_bind_PointCloud_num_points_0=function(){return(ie=U._emscripten_bind_PointCloud_num_points_0=U.asm.emscripten_bind_PointCloud_num_points_0).apply(null,arguments)},ae=U._emscripten_bind_PointCloud___destroy___0=function(){return(ae=U._emscripten_bind_PointCloud___destroy___0=U.asm.emscripten_bind_PointCloud___destroy___0).apply(null,arguments)},se=U._emscripten_bind_Mesh_Mesh_0=function(){return(se=U._emscripten_bind_Mesh_Mesh_0=U.asm.emscripten_bind_Mesh_Mesh_0).apply(null,arguments)},ce=U._emscripten_bind_Mesh_num_faces_0=function(){return(ce=U._emscripten_bind_Mesh_num_faces_0=U.asm.emscripten_bind_Mesh_num_faces_0).apply(null,arguments)},ue=U._emscripten_bind_Mesh_num_attributes_0=function(){return(ue=U._emscripten_bind_Mesh_num_attributes_0=U.asm.emscripten_bind_Mesh_num_attributes_0).apply(null,arguments)},pe=U._emscripten_bind_Mesh_num_points_0=function(){return(pe=U._emscripten_bind_Mesh_num_points_0=U.asm.emscripten_bind_Mesh_num_points_0).apply(null,arguments)},le=U._emscripten_bind_Mesh___destroy___0=function(){return(le=U._emscripten_bind_Mesh___destroy___0=U.asm.emscripten_bind_Mesh___destroy___0).apply(null,arguments)},fe=U._emscripten_bind_Metadata_Metadata_0=function(){return(fe=U._emscripten_bind_Metadata_Metadata_0=U.asm.emscripten_bind_Metadata_Metadata_0).apply(null,arguments)},_e=U._emscripten_bind_Metadata___destroy___0=function(){return(_e=U._emscripten_bind_Metadata___destroy___0=U.asm.emscripten_bind_Metadata___destroy___0).apply(null,arguments)},de=U._emscripten_bind_Status_code_0=function(){return(de=U._emscripten_bind_Status_code_0=U.asm.emscripten_bind_Status_code_0).apply(null,arguments)},me=U._emscripten_bind_Status_ok_0=function(){return(me=U._emscripten_bind_Status_ok_0=U.asm.emscripten_bind_Status_ok_0).apply(null,arguments)},he=U._emscripten_bind_Status_error_msg_0=function(){return(he=U._emscripten_bind_Status_error_msg_0=U.asm.emscripten_bind_Status_error_msg_0).apply(null,arguments)},ye=U._emscripten_bind_Status___destroy___0=function(){return(ye=U._emscripten_bind_Status___destroy___0=U.asm.emscripten_bind_Status___destroy___0).apply(null,arguments)},be=U._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=function(){return(be=U._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=U.asm.emscripten_bind_DracoFloat32Array_DracoFloat32Array_0).apply(null,arguments)},ve=U._emscripten_bind_DracoFloat32Array_GetValue_1=function(){return(ve=U._emscripten_bind_DracoFloat32Array_GetValue_1=U.asm.emscripten_bind_DracoFloat32Array_GetValue_1).apply(null,arguments)},ge=U._emscripten_bind_DracoFloat32Array_size_0=function(){return(ge=U._emscripten_bind_DracoFloat32Array_size_0=U.asm.emscripten_bind_DracoFloat32Array_size_0).apply(null,arguments)},Ae=U._emscripten_bind_DracoFloat32Array___destroy___0=function(){return(Ae=U._emscripten_bind_DracoFloat32Array___destroy___0=U.asm.emscripten_bind_DracoFloat32Array___destroy___0).apply(null,arguments)},we=U._emscripten_bind_DracoInt8Array_DracoInt8Array_0=function(){return(we=U._emscripten_bind_DracoInt8Array_DracoInt8Array_0=U.asm.emscripten_bind_DracoInt8Array_DracoInt8Array_0).apply(null,arguments)},xe=U._emscripten_bind_DracoInt8Array_GetValue_1=function(){return(xe=U._emscripten_bind_DracoInt8Array_GetValue_1=U.asm.emscripten_bind_DracoInt8Array_GetValue_1).apply(null,arguments)},Ee=U._emscripten_bind_DracoInt8Array_size_0=function(){return(Ee=U._emscripten_bind_DracoInt8Array_size_0=U.asm.emscripten_bind_DracoInt8Array_size_0).apply(null,arguments)},Oe=U._emscripten_bind_DracoInt8Array___destroy___0=function(){return(Oe=U._emscripten_bind_DracoInt8Array___destroy___0=U.asm.emscripten_bind_DracoInt8Array___destroy___0).apply(null,arguments)},Te=U._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=function(){return(Te=U._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=U.asm.emscripten_bind_DracoUInt8Array_DracoUInt8Array_0).apply(null,arguments)},je=U._emscripten_bind_DracoUInt8Array_GetValue_1=function(){return(je=U._emscripten_bind_DracoUInt8Array_GetValue_1=U.asm.emscripten_bind_DracoUInt8Array_GetValue_1).apply(null,arguments)},Se=U._emscripten_bind_DracoUInt8Array_size_0=function(){return(Se=U._emscripten_bind_DracoUInt8Array_size_0=U.asm.emscripten_bind_DracoUInt8Array_size_0).apply(null,arguments)},Ce=U._emscripten_bind_DracoUInt8Array___destroy___0=function(){return(Ce=U._emscripten_bind_DracoUInt8Array___destroy___0=U.asm.emscripten_bind_DracoUInt8Array___destroy___0).apply(null,arguments)},De=U._emscripten_bind_DracoInt16Array_DracoInt16Array_0=function(){return(De=U._emscripten_bind_DracoInt16Array_DracoInt16Array_0=U.asm.emscripten_bind_DracoInt16Array_DracoInt16Array_0).apply(null,arguments)},Ie=U._emscripten_bind_DracoInt16Array_GetValue_1=function(){return(Ie=U._emscripten_bind_DracoInt16Array_GetValue_1=U.asm.emscripten_bind_DracoInt16Array_GetValue_1).apply(null,arguments)},Pe=U._emscripten_bind_DracoInt16Array_size_0=function(){return(Pe=U._emscripten_bind_DracoInt16Array_size_0=U.asm.emscripten_bind_DracoInt16Array_size_0).apply(null,arguments)},Me=U._emscripten_bind_DracoInt16Array___destroy___0=function(){return(Me=U._emscripten_bind_DracoInt16Array___destroy___0=U.asm.emscripten_bind_DracoInt16Array___destroy___0).apply(null,arguments)},Fe=U._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=function(){return(Fe=U._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=U.asm.emscripten_bind_DracoUInt16Array_DracoUInt16Array_0).apply(null,arguments)},ke=U._emscripten_bind_DracoUInt16Array_GetValue_1=function(){return(ke=U._emscripten_bind_DracoUInt16Array_GetValue_1=U.asm.emscripten_bind_DracoUInt16Array_GetValue_1).apply(null,arguments)},Re=U._emscripten_bind_DracoUInt16Array_size_0=function(){return(Re=U._emscripten_bind_DracoUInt16Array_size_0=U.asm.emscripten_bind_DracoUInt16Array_size_0).apply(null,arguments)},Be=U._emscripten_bind_DracoUInt16Array___destroy___0=function(){return(Be=U._emscripten_bind_DracoUInt16Array___destroy___0=U.asm.emscripten_bind_DracoUInt16Array___destroy___0).apply(null,arguments)},ze=U._emscripten_bind_DracoInt32Array_DracoInt32Array_0=function(){return(ze=U._emscripten_bind_DracoInt32Array_DracoInt32Array_0=U.asm.emscripten_bind_DracoInt32Array_DracoInt32Array_0).apply(null,arguments)},Ge=U._emscripten_bind_DracoInt32Array_GetValue_1=function(){return(Ge=U._emscripten_bind_DracoInt32Array_GetValue_1=U.asm.emscripten_bind_DracoInt32Array_GetValue_1).apply(null,arguments)},Ne=U._emscripten_bind_DracoInt32Array_size_0=function(){return(Ne=U._emscripten_bind_DracoInt32Array_size_0=U.asm.emscripten_bind_DracoInt32Array_size_0).apply(null,arguments)},Le=U._emscripten_bind_DracoInt32Array___destroy___0=function(){return(Le=U._emscripten_bind_DracoInt32Array___destroy___0=U.asm.emscripten_bind_DracoInt32Array___destroy___0).apply(null,arguments)},Ue=U._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=function(){return(Ue=U._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=U.asm.emscripten_bind_DracoUInt32Array_DracoUInt32Array_0).apply(null,arguments)},We=U._emscripten_bind_DracoUInt32Array_GetValue_1=function(){return(We=U._emscripten_bind_DracoUInt32Array_GetValue_1=U.asm.emscripten_bind_DracoUInt32Array_GetValue_1).apply(null,arguments)},He=U._emscripten_bind_DracoUInt32Array_size_0=function(){return(He=U._emscripten_bind_DracoUInt32Array_size_0=U.asm.emscripten_bind_DracoUInt32Array_size_0).apply(null,arguments)},Ve=U._emscripten_bind_DracoUInt32Array___destroy___0=function(){return(Ve=U._emscripten_bind_DracoUInt32Array___destroy___0=U.asm.emscripten_bind_DracoUInt32Array___destroy___0).apply(null,arguments)},Ye=U._emscripten_bind_MetadataQuerier_MetadataQuerier_0=function(){return(Ye=U._emscripten_bind_MetadataQuerier_MetadataQuerier_0=U.asm.emscripten_bind_MetadataQuerier_MetadataQuerier_0).apply(null,arguments)},Qe=U._emscripten_bind_MetadataQuerier_HasEntry_2=function(){return(Qe=U._emscripten_bind_MetadataQuerier_HasEntry_2=U.asm.emscripten_bind_MetadataQuerier_HasEntry_2).apply(null,arguments)},qe=U._emscripten_bind_MetadataQuerier_GetIntEntry_2=function(){return(qe=U._emscripten_bind_MetadataQuerier_GetIntEntry_2=U.asm.emscripten_bind_MetadataQuerier_GetIntEntry_2).apply(null,arguments)},Ke=U._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=function(){return(Ke=U._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=U.asm.emscripten_bind_MetadataQuerier_GetIntEntryArray_3).apply(null,arguments)},$e=U._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=function(){return($e=U._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=U.asm.emscripten_bind_MetadataQuerier_GetDoubleEntry_2).apply(null,arguments)},Xe=U._emscripten_bind_MetadataQuerier_GetStringEntry_2=function(){return(Xe=U._emscripten_bind_MetadataQuerier_GetStringEntry_2=U.asm.emscripten_bind_MetadataQuerier_GetStringEntry_2).apply(null,arguments)},Ze=U._emscripten_bind_MetadataQuerier_NumEntries_1=function(){return(Ze=U._emscripten_bind_MetadataQuerier_NumEntries_1=U.asm.emscripten_bind_MetadataQuerier_NumEntries_1).apply(null,arguments)},Je=U._emscripten_bind_MetadataQuerier_GetEntryName_2=function(){return(Je=U._emscripten_bind_MetadataQuerier_GetEntryName_2=U.asm.emscripten_bind_MetadataQuerier_GetEntryName_2).apply(null,arguments)},tr=U._emscripten_bind_MetadataQuerier___destroy___0=function(){return(tr=U._emscripten_bind_MetadataQuerier___destroy___0=U.asm.emscripten_bind_MetadataQuerier___destroy___0).apply(null,arguments)},er=U._emscripten_bind_Decoder_Decoder_0=function(){return(er=U._emscripten_bind_Decoder_Decoder_0=U.asm.emscripten_bind_Decoder_Decoder_0).apply(null,arguments)},rr=U._emscripten_bind_Decoder_DecodeArrayToPointCloud_3=function(){return(rr=U._emscripten_bind_Decoder_DecodeArrayToPointCloud_3=U.asm.emscripten_bind_Decoder_DecodeArrayToPointCloud_3).apply(null,arguments)},nr=U._emscripten_bind_Decoder_DecodeArrayToMesh_3=function(){return(nr=U._emscripten_bind_Decoder_DecodeArrayToMesh_3=U.asm.emscripten_bind_Decoder_DecodeArrayToMesh_3).apply(null,arguments)},or=U._emscripten_bind_Decoder_GetAttributeId_2=function(){return(or=U._emscripten_bind_Decoder_GetAttributeId_2=U.asm.emscripten_bind_Decoder_GetAttributeId_2).apply(null,arguments)},ir=U._emscripten_bind_Decoder_GetAttributeIdByName_2=function(){return(ir=U._emscripten_bind_Decoder_GetAttributeIdByName_2=U.asm.emscripten_bind_Decoder_GetAttributeIdByName_2).apply(null,arguments)},ar=U._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=function(){return(ar=U._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=U.asm.emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3).apply(null,arguments)},sr=U._emscripten_bind_Decoder_GetAttribute_2=function(){return(sr=U._emscripten_bind_Decoder_GetAttribute_2=U.asm.emscripten_bind_Decoder_GetAttribute_2).apply(null,arguments)},cr=U._emscripten_bind_Decoder_GetAttributeByUniqueId_2=function(){return(cr=U._emscripten_bind_Decoder_GetAttributeByUniqueId_2=U.asm.emscripten_bind_Decoder_GetAttributeByUniqueId_2).apply(null,arguments)},ur=U._emscripten_bind_Decoder_GetMetadata_1=function(){return(ur=U._emscripten_bind_Decoder_GetMetadata_1=U.asm.emscripten_bind_Decoder_GetMetadata_1).apply(null,arguments)},pr=U._emscripten_bind_Decoder_GetAttributeMetadata_2=function(){return(pr=U._emscripten_bind_Decoder_GetAttributeMetadata_2=U.asm.emscripten_bind_Decoder_GetAttributeMetadata_2).apply(null,arguments)},lr=U._emscripten_bind_Decoder_GetFaceFromMesh_3=function(){return(lr=U._emscripten_bind_Decoder_GetFaceFromMesh_3=U.asm.emscripten_bind_Decoder_GetFaceFromMesh_3).apply(null,arguments)},fr=U._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=function(){return(fr=U._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=U.asm.emscripten_bind_Decoder_GetTriangleStripsFromMesh_2).apply(null,arguments)},_r=U._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=function(){return(_r=U._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=U.asm.emscripten_bind_Decoder_GetTrianglesUInt16Array_3).apply(null,arguments)},dr=U._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=function(){return(dr=U._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=U.asm.emscripten_bind_Decoder_GetTrianglesUInt32Array_3).apply(null,arguments)},mr=U._emscripten_bind_Decoder_GetAttributeFloat_3=function(){return(mr=U._emscripten_bind_Decoder_GetAttributeFloat_3=U.asm.emscripten_bind_Decoder_GetAttributeFloat_3).apply(null,arguments)},hr=U._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=function(){return(hr=U._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=U.asm.emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3).apply(null,arguments)},yr=U._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=function(){return(yr=U._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=U.asm.emscripten_bind_Decoder_GetAttributeIntForAllPoints_3).apply(null,arguments)},br=U._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=function(){return(br=U._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=U.asm.emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3).apply(null,arguments)},vr=U._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=function(){return(vr=U._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=U.asm.emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3).apply(null,arguments)},gr=U._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=function(){return(gr=U._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=U.asm.emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3).apply(null,arguments)},Ar=U._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=function(){return(Ar=U._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=U.asm.emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3).apply(null,arguments)},wr=U._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=function(){return(wr=U._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=U.asm.emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3).apply(null,arguments)},xr=U._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=function(){return(xr=U._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=U.asm.emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3).apply(null,arguments)},Er=U._emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5=function(){return(Er=U._emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5=U.asm.emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5).apply(null,arguments)},Or=U._emscripten_bind_Decoder_SkipAttributeTransform_1=function(){return(Or=U._emscripten_bind_Decoder_SkipAttributeTransform_1=U.asm.emscripten_bind_Decoder_SkipAttributeTransform_1).apply(null,arguments)},Tr=U._emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1=function(){return(Tr=U._emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1=U.asm.emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1).apply(null,arguments)},jr=U._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=function(){return(jr=U._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=U.asm.emscripten_bind_Decoder_DecodeBufferToPointCloud_2).apply(null,arguments)},Sr=U._emscripten_bind_Decoder_DecodeBufferToMesh_2=function(){return(Sr=U._emscripten_bind_Decoder_DecodeBufferToMesh_2=U.asm.emscripten_bind_Decoder_DecodeBufferToMesh_2).apply(null,arguments)},Cr=U._emscripten_bind_Decoder___destroy___0=function(){return(Cr=U._emscripten_bind_Decoder___destroy___0=U.asm.emscripten_bind_Decoder___destroy___0).apply(null,arguments)},Dr=U._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=function(){return(Dr=U._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=U.asm.emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM).apply(null,arguments)},Ir=U._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=function(){return(Ir=U._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=U.asm.emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM).apply(null,arguments)},Pr=U._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=function(){return(Pr=U._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=U.asm.emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM).apply(null,arguments)},Mr=U._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=function(){return(Mr=U._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=U.asm.emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM).apply(null,arguments)},Fr=U._emscripten_enum_draco_GeometryAttribute_Type_INVALID=function(){return(Fr=U._emscripten_enum_draco_GeometryAttribute_Type_INVALID=U.asm.emscripten_enum_draco_GeometryAttribute_Type_INVALID).apply(null,arguments)},kr=U._emscripten_enum_draco_GeometryAttribute_Type_POSITION=function(){return(kr=U._emscripten_enum_draco_GeometryAttribute_Type_POSITION=U.asm.emscripten_enum_draco_GeometryAttribute_Type_POSITION).apply(null,arguments)},Rr=U._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=function(){return(Rr=U._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=U.asm.emscripten_enum_draco_GeometryAttribute_Type_NORMAL).apply(null,arguments)},Br=U._emscripten_enum_draco_GeometryAttribute_Type_COLOR=function(){return(Br=U._emscripten_enum_draco_GeometryAttribute_Type_COLOR=U.asm.emscripten_enum_draco_GeometryAttribute_Type_COLOR).apply(null,arguments)},zr=U._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=function(){return(zr=U._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=U.asm.emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD).apply(null,arguments)},Gr=U._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=function(){return(Gr=U._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=U.asm.emscripten_enum_draco_GeometryAttribute_Type_GENERIC).apply(null,arguments)},Nr=U._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=function(){return(Nr=U._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=U.asm.emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE).apply(null,arguments)},Lr=U._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=function(){return(Lr=U._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=U.asm.emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD).apply(null,arguments)},Ur=U._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=function(){return(Ur=U._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=U.asm.emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH).apply(null,arguments)},Wr=U._emscripten_enum_draco_DataType_DT_INVALID=function(){return(Wr=U._emscripten_enum_draco_DataType_DT_INVALID=U.asm.emscripten_enum_draco_DataType_DT_INVALID).apply(null,arguments)},Hr=U._emscripten_enum_draco_DataType_DT_INT8=function(){return(Hr=U._emscripten_enum_draco_DataType_DT_INT8=U.asm.emscripten_enum_draco_DataType_DT_INT8).apply(null,arguments)},Vr=U._emscripten_enum_draco_DataType_DT_UINT8=function(){return(Vr=U._emscripten_enum_draco_DataType_DT_UINT8=U.asm.emscripten_enum_draco_DataType_DT_UINT8).apply(null,arguments)},Yr=U._emscripten_enum_draco_DataType_DT_INT16=function(){return(Yr=U._emscripten_enum_draco_DataType_DT_INT16=U.asm.emscripten_enum_draco_DataType_DT_INT16).apply(null,arguments)},Qr=U._emscripten_enum_draco_DataType_DT_UINT16=function(){return(Qr=U._emscripten_enum_draco_DataType_DT_UINT16=U.asm.emscripten_enum_draco_DataType_DT_UINT16).apply(null,arguments)},qr=U._emscripten_enum_draco_DataType_DT_INT32=function(){return(qr=U._emscripten_enum_draco_DataType_DT_INT32=U.asm.emscripten_enum_draco_DataType_DT_INT32).apply(null,arguments)},Kr=U._emscripten_enum_draco_DataType_DT_UINT32=function(){return(Kr=U._emscripten_enum_draco_DataType_DT_UINT32=U.asm.emscripten_enum_draco_DataType_DT_UINT32).apply(null,arguments)},$r=U._emscripten_enum_draco_DataType_DT_INT64=function(){return($r=U._emscripten_enum_draco_DataType_DT_INT64=U.asm.emscripten_enum_draco_DataType_DT_INT64).apply(null,arguments)},Xr=U._emscripten_enum_draco_DataType_DT_UINT64=function(){return(Xr=U._emscripten_enum_draco_DataType_DT_UINT64=U.asm.emscripten_enum_draco_DataType_DT_UINT64).apply(null,arguments)},Zr=U._emscripten_enum_draco_DataType_DT_FLOAT32=function(){return(Zr=U._emscripten_enum_draco_DataType_DT_FLOAT32=U.asm.emscripten_enum_draco_DataType_DT_FLOAT32).apply(null,arguments)},Jr=U._emscripten_enum_draco_DataType_DT_FLOAT64=function(){return(Jr=U._emscripten_enum_draco_DataType_DT_FLOAT64=U.asm.emscripten_enum_draco_DataType_DT_FLOAT64).apply(null,arguments)},tn=U._emscripten_enum_draco_DataType_DT_BOOL=function(){return(tn=U._emscripten_enum_draco_DataType_DT_BOOL=U.asm.emscripten_enum_draco_DataType_DT_BOOL).apply(null,arguments)},en=U._emscripten_enum_draco_DataType_DT_TYPES_COUNT=function(){return(en=U._emscripten_enum_draco_DataType_DT_TYPES_COUNT=U.asm.emscripten_enum_draco_DataType_DT_TYPES_COUNT).apply(null,arguments)},rn=U._emscripten_enum_draco_StatusCode_OK=function(){return(rn=U._emscripten_enum_draco_StatusCode_OK=U.asm.emscripten_enum_draco_StatusCode_OK).apply(null,arguments)},nn=U._emscripten_enum_draco_StatusCode_DRACO_ERROR=function(){return(nn=U._emscripten_enum_draco_StatusCode_DRACO_ERROR=U.asm.emscripten_enum_draco_StatusCode_DRACO_ERROR).apply(null,arguments)},on=U._emscripten_enum_draco_StatusCode_IO_ERROR=function(){return(on=U._emscripten_enum_draco_StatusCode_IO_ERROR=U.asm.emscripten_enum_draco_StatusCode_IO_ERROR).apply(null,arguments)},an=U._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=function(){return(an=U._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=U.asm.emscripten_enum_draco_StatusCode_INVALID_PARAMETER).apply(null,arguments)},sn=U._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=function(){return(sn=U._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=U.asm.emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION).apply(null,arguments)},cn=U._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=function(){return(cn=U._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=U.asm.emscripten_enum_draco_StatusCode_UNKNOWN_VERSION).apply(null,arguments)};U.___errno_location=function(){return(U.___errno_location=U.asm.__errno_location).apply(null,arguments)},U.stackSave=function(){return(U.stackSave=U.asm.stackSave).apply(null,arguments)},U.stackRestore=function(){return(U.stackRestore=U.asm.stackRestore).apply(null,arguments)},U.stackAlloc=function(){return(U.stackAlloc=U.asm.stackAlloc).apply(null,arguments)},U._setThrew=function(){return(U._setThrew=U.asm.setThrew).apply(null,arguments)},U._free=function(){return(U._free=U.asm.free).apply(null,arguments)};var un,pn=U._malloc=function(){return(pn=U._malloc=U.asm.malloc).apply(null,arguments)};if(U.dynCall_jiji=function(){return(U.dynCall_jiji=U.asm.dynCall_jiji).apply(null,arguments)},gt=function t(){un||d(),un||(gt=t)},U.run=d,U.preInit)for("function"==typeof U.preInit&&(U.preInit=[U.preInit]);0<U.preInit.length;)U.preInit.pop()();d(),m.prototype=Object.create(m.prototype),m.prototype.constructor=m,m.prototype.__class__=m,m.__cache__={},U.WrapperObject=m,U.getCache=h,U.wrapPointer=y,U.castObject=function(t,e){return y(t.ptr,e)},U.NULL=y(0),U.destroy=function(t){if(!t.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";t.__destroy__(),delete h(t.__class__)[t.ptr]},U.compare=function(t,e){return t.ptr===e.ptr},U.getPointer=function(t){return t.ptr},U.getClass=function(t){return t.__class__};var ln={buffer:0,size:0,pos:0,temps:[],needed:0,prepare:function(){if(ln.needed){for(var t=0;t<ln.temps.length;t++)U._free(ln.temps[t]);ln.temps.length=0,U._free(ln.buffer),ln.buffer=0,ln.size+=ln.needed,ln.needed=0}ln.buffer||(ln.size+=128,ln.buffer=U._malloc(ln.size),e(ln.buffer)),ln.pos=0},alloc:function(t,r){return e(ln.buffer),t=7+(t=t.length*r.BYTES_PER_ELEMENT)&-8,ln.pos+t>=ln.size?(e(0<t),ln.needed+=t,r=U._malloc(t),ln.temps.push(r)):(r=ln.buffer+ln.pos,ln.pos+=t),r},copy:function(t,e,r){switch(r>>>=0,e.BYTES_PER_ELEMENT){case 2:r>>>=1;break;case 4:r>>>=2;break;case 8:r>>>=3}for(var n=0;n<t.length;n++)e[r+n]=t[n]}};return g.prototype=Object.create(m.prototype),g.prototype.constructor=g,g.prototype.__class__=g,g.__cache__={},U.VoidPtr=g,g.prototype.__destroy__=g.prototype.__destroy__=function(){jt(this.ptr)},A.prototype=Object.create(m.prototype),A.prototype.constructor=A,A.prototype.__class__=A,A.__cache__={},U.DecoderBuffer=A,A.prototype.Init=A.prototype.Init=function(t,e){var r=this.ptr;ln.prepare(),"object"==typeof t&&(t=v(t)),e&&"object"==typeof e&&(e=e.ptr),Ct(r,t,e)},A.prototype.__destroy__=A.prototype.__destroy__=function(){Dt(this.ptr)},w.prototype=Object.create(m.prototype),w.prototype.constructor=w,w.prototype.__class__=w,w.__cache__={},U.AttributeTransformData=w,w.prototype.transform_type=w.prototype.transform_type=function(){return Pt(this.ptr)},w.prototype.__destroy__=w.prototype.__destroy__=function(){Mt(this.ptr)},x.prototype=Object.create(m.prototype),x.prototype.constructor=x,x.prototype.__class__=x,x.__cache__={},U.GeometryAttribute=x,x.prototype.__destroy__=x.prototype.__destroy__=function(){kt(this.ptr)},E.prototype=Object.create(m.prototype),E.prototype.constructor=E,E.prototype.__class__=E,E.__cache__={},U.PointAttribute=E,E.prototype.size=E.prototype.size=function(){return Bt(this.ptr)},E.prototype.GetAttributeTransformData=E.prototype.GetAttributeTransformData=function(){return y(zt(this.ptr),w)},E.prototype.attribute_type=E.prototype.attribute_type=function(){return Gt(this.ptr)},E.prototype.data_type=E.prototype.data_type=function(){return Nt(this.ptr)},E.prototype.num_components=E.prototype.num_components=function(){return Lt(this.ptr)},E.prototype.normalized=E.prototype.normalized=function(){return!!Ut(this.ptr)},E.prototype.byte_stride=E.prototype.byte_stride=function(){return Wt(this.ptr)},E.prototype.byte_offset=E.prototype.byte_offset=function(){return Ht(this.ptr)},E.prototype.unique_id=E.prototype.unique_id=function(){return Vt(this.ptr)},E.prototype.__destroy__=E.prototype.__destroy__=function(){Yt(this.ptr)},O.prototype=Object.create(m.prototype),O.prototype.constructor=O,O.prototype.__class__=O,O.__cache__={},U.AttributeQuantizationTransform=O,O.prototype.InitFromAttribute=O.prototype.InitFromAttribute=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),!!qt(e,t)},O.prototype.quantization_bits=O.prototype.quantization_bits=function(){return Kt(this.ptr)},O.prototype.min_value=O.prototype.min_value=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),$t(e,t)},O.prototype.range=O.prototype.range=function(){return Xt(this.ptr)},O.prototype.__destroy__=O.prototype.__destroy__=function(){Zt(this.ptr)},T.prototype=Object.create(m.prototype),T.prototype.constructor=T,T.prototype.__class__=T,T.__cache__={},U.AttributeOctahedronTransform=T,T.prototype.InitFromAttribute=T.prototype.InitFromAttribute=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),!!te(e,t)},T.prototype.quantization_bits=T.prototype.quantization_bits=function(){return ee(this.ptr)},T.prototype.__destroy__=T.prototype.__destroy__=function(){re(this.ptr)},j.prototype=Object.create(m.prototype),j.prototype.constructor=j,j.prototype.__class__=j,j.__cache__={},U.PointCloud=j,j.prototype.num_attributes=j.prototype.num_attributes=function(){return oe(this.ptr)},j.prototype.num_points=j.prototype.num_points=function(){return ie(this.ptr)},j.prototype.__destroy__=j.prototype.__destroy__=function(){ae(this.ptr)},S.prototype=Object.create(m.prototype),S.prototype.constructor=S,S.prototype.__class__=S,S.__cache__={},U.Mesh=S,S.prototype.num_faces=S.prototype.num_faces=function(){return ce(this.ptr)},S.prototype.num_attributes=S.prototype.num_attributes=function(){return ue(this.ptr)},S.prototype.num_points=S.prototype.num_points=function(){return pe(this.ptr)},S.prototype.__destroy__=S.prototype.__destroy__=function(){le(this.ptr)},C.prototype=Object.create(m.prototype),C.prototype.constructor=C,C.prototype.__class__=C,C.__cache__={},U.Metadata=C,C.prototype.__destroy__=C.prototype.__destroy__=function(){_e(this.ptr)},D.prototype=Object.create(m.prototype),D.prototype.constructor=D,D.prototype.__class__=D,D.__cache__={},U.Status=D,D.prototype.code=D.prototype.code=function(){return de(this.ptr)},D.prototype.ok=D.prototype.ok=function(){return!!me(this.ptr)},D.prototype.error_msg=D.prototype.error_msg=function(){return o(he(this.ptr))},D.prototype.__destroy__=D.prototype.__destroy__=function(){ye(this.ptr)},I.prototype=Object.create(m.prototype),I.prototype.constructor=I,I.prototype.__class__=I,I.__cache__={},U.DracoFloat32Array=I,I.prototype.GetValue=I.prototype.GetValue=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),ve(e,t)},I.prototype.size=I.prototype.size=function(){return ge(this.ptr)},I.prototype.__destroy__=I.prototype.__destroy__=function(){Ae(this.ptr)},P.prototype=Object.create(m.prototype),P.prototype.constructor=P,P.prototype.__class__=P,P.__cache__={},U.DracoInt8Array=P,P.prototype.GetValue=P.prototype.GetValue=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),xe(e,t)},P.prototype.size=P.prototype.size=function(){return Ee(this.ptr)},P.prototype.__destroy__=P.prototype.__destroy__=function(){Oe(this.ptr)},M.prototype=Object.create(m.prototype),M.prototype.constructor=M,M.prototype.__class__=M,M.__cache__={},U.DracoUInt8Array=M,M.prototype.GetValue=M.prototype.GetValue=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),je(e,t)},M.prototype.size=M.prototype.size=function(){return Se(this.ptr)},M.prototype.__destroy__=M.prototype.__destroy__=function(){Ce(this.ptr)},F.prototype=Object.create(m.prototype),F.prototype.constructor=F,F.prototype.__class__=F,F.__cache__={},U.DracoInt16Array=F,F.prototype.GetValue=F.prototype.GetValue=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Ie(e,t)},F.prototype.size=F.prototype.size=function(){return Pe(this.ptr)},F.prototype.__destroy__=F.prototype.__destroy__=function(){Me(this.ptr)},k.prototype=Object.create(m.prototype),k.prototype.constructor=k,k.prototype.__class__=k,k.__cache__={},U.DracoUInt16Array=k,k.prototype.GetValue=k.prototype.GetValue=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),ke(e,t)},k.prototype.size=k.prototype.size=function(){return Re(this.ptr)},k.prototype.__destroy__=k.prototype.__destroy__=function(){Be(this.ptr)},R.prototype=Object.create(m.prototype),R.prototype.constructor=R,R.prototype.__class__=R,R.__cache__={},U.DracoInt32Array=R,R.prototype.GetValue=R.prototype.GetValue=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Ge(e,t)},R.prototype.size=R.prototype.size=function(){return Ne(this.ptr)},R.prototype.__destroy__=R.prototype.__destroy__=function(){Le(this.ptr)},B.prototype=Object.create(m.prototype),B.prototype.constructor=B,B.prototype.__class__=B,B.__cache__={},U.DracoUInt32Array=B,B.prototype.GetValue=B.prototype.GetValue=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),We(e,t)},B.prototype.size=B.prototype.size=function(){return He(this.ptr)},B.prototype.__destroy__=B.prototype.__destroy__=function(){Ve(this.ptr)},z.prototype=Object.create(m.prototype),z.prototype.constructor=z,z.prototype.__class__=z,z.__cache__={},U.MetadataQuerier=z,z.prototype.HasEntry=z.prototype.HasEntry=function(t,e){var r=this.ptr;return ln.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:b(e),!!Qe(r,t,e)},z.prototype.GetIntEntry=z.prototype.GetIntEntry=function(t,e){var r=this.ptr;return ln.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:b(e),qe(r,t,e)},z.prototype.GetIntEntryArray=z.prototype.GetIntEntryArray=function(t,e,r){var n=this.ptr;ln.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:b(e),r&&"object"==typeof r&&(r=r.ptr),Ke(n,t,e,r)},z.prototype.GetDoubleEntry=z.prototype.GetDoubleEntry=function(t,e){var r=this.ptr;return ln.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:b(e),$e(r,t,e)},z.prototype.GetStringEntry=z.prototype.GetStringEntry=function(t,e){var r=this.ptr;return ln.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:b(e),o(Xe(r,t,e))},z.prototype.NumEntries=z.prototype.NumEntries=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Ze(e,t)},z.prototype.GetEntryName=z.prototype.GetEntryName=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),o(Je(r,t,e))},z.prototype.__destroy__=z.prototype.__destroy__=function(){tr(this.ptr)},G.prototype=Object.create(m.prototype),G.prototype.constructor=G,G.prototype.__class__=G,G.__cache__={},U.Decoder=G,G.prototype.DecodeArrayToPointCloud=G.prototype.DecodeArrayToPointCloud=function(t,e,r){var n=this.ptr;return ln.prepare(),"object"==typeof t&&(t=v(t)),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),y(rr(n,t,e,r),D)},G.prototype.DecodeArrayToMesh=G.prototype.DecodeArrayToMesh=function(t,e,r){var n=this.ptr;return ln.prepare(),"object"==typeof t&&(t=v(t)),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),y(nr(n,t,e,r),D)},G.prototype.GetAttributeId=G.prototype.GetAttributeId=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),or(r,t,e)},G.prototype.GetAttributeIdByName=G.prototype.GetAttributeIdByName=function(t,e){var r=this.ptr;return ln.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:b(e),ir(r,t,e)},G.prototype.GetAttributeIdByMetadataEntry=G.prototype.GetAttributeIdByMetadataEntry=function(t,e,r){var n=this.ptr;return ln.prepare(),t&&"object"==typeof t&&(t=t.ptr),e=e&&"object"==typeof e?e.ptr:b(e),r=r&&"object"==typeof r?r.ptr:b(r),ar(n,t,e,r)},G.prototype.GetAttribute=G.prototype.GetAttribute=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),y(sr(r,t,e),E)},G.prototype.GetAttributeByUniqueId=G.prototype.GetAttributeByUniqueId=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),y(cr(r,t,e),E)},G.prototype.GetMetadata=G.prototype.GetMetadata=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),y(ur(e,t),C)},G.prototype.GetAttributeMetadata=G.prototype.GetAttributeMetadata=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),y(pr(r,t,e),C)},G.prototype.GetFaceFromMesh=G.prototype.GetFaceFromMesh=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!lr(n,t,e,r)},G.prototype.GetTriangleStripsFromMesh=G.prototype.GetTriangleStripsFromMesh=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),fr(r,t,e)},G.prototype.GetTrianglesUInt16Array=G.prototype.GetTrianglesUInt16Array=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!_r(n,t,e,r)},G.prototype.GetTrianglesUInt32Array=G.prototype.GetTrianglesUInt32Array=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!dr(n,t,e,r)},G.prototype.GetAttributeFloat=G.prototype.GetAttributeFloat=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!mr(n,t,e,r)},G.prototype.GetAttributeFloatForAllPoints=G.prototype.GetAttributeFloatForAllPoints=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!hr(n,t,e,r)},G.prototype.GetAttributeIntForAllPoints=G.prototype.GetAttributeIntForAllPoints=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!yr(n,t,e,r)},G.prototype.GetAttributeInt8ForAllPoints=G.prototype.GetAttributeInt8ForAllPoints=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!br(n,t,e,r)},G.prototype.GetAttributeUInt8ForAllPoints=G.prototype.GetAttributeUInt8ForAllPoints=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!vr(n,t,e,r)},G.prototype.GetAttributeInt16ForAllPoints=G.prototype.GetAttributeInt16ForAllPoints=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!gr(n,t,e,r)},G.prototype.GetAttributeUInt16ForAllPoints=G.prototype.GetAttributeUInt16ForAllPoints=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Ar(n,t,e,r)},G.prototype.GetAttributeInt32ForAllPoints=G.prototype.GetAttributeInt32ForAllPoints=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!wr(n,t,e,r)},G.prototype.GetAttributeUInt32ForAllPoints=G.prototype.GetAttributeUInt32ForAllPoints=function(t,e,r){var n=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),!!xr(n,t,e,r)},G.prototype.GetAttributeDataArrayForAllPoints=G.prototype.GetAttributeDataArrayForAllPoints=function(t,e,r,n,o){var i=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),r&&"object"==typeof r&&(r=r.ptr),n&&"object"==typeof n&&(n=n.ptr),o&&"object"==typeof o&&(o=o.ptr),!!Er(i,t,e,r,n,o)},G.prototype.SkipAttributeTransform=G.prototype.SkipAttributeTransform=function(t){var e=this.ptr;t&&"object"==typeof t&&(t=t.ptr),Or(e,t)},G.prototype.GetEncodedGeometryType_Deprecated=G.prototype.GetEncodedGeometryType_Deprecated=function(t){var e=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),Tr(e,t)},G.prototype.DecodeBufferToPointCloud=G.prototype.DecodeBufferToPointCloud=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),y(jr(r,t,e),D)},G.prototype.DecodeBufferToMesh=G.prototype.DecodeBufferToMesh=function(t,e){var r=this.ptr;return t&&"object"==typeof t&&(t=t.ptr),e&&"object"==typeof e&&(e=e.ptr),y(Sr(r,t,e),D)},G.prototype.__destroy__=G.prototype.__destroy__=function(){Cr(this.ptr)},function(){function t(){U.ATTRIBUTE_INVALID_TRANSFORM=Dr(),U.ATTRIBUTE_NO_TRANSFORM=Ir(),U.ATTRIBUTE_QUANTIZATION_TRANSFORM=Pr(),U.ATTRIBUTE_OCTAHEDRON_TRANSFORM=Mr(),U.INVALID=Fr(),U.POSITION=kr(),U.NORMAL=Rr(),U.COLOR=Br(),U.TEX_COORD=zr(),U.GENERIC=Gr(),U.INVALID_GEOMETRY_TYPE=Nr(),U.POINT_CLOUD=Lr(),U.TRIANGULAR_MESH=Ur(),U.DT_INVALID=Wr(),U.DT_INT8=Hr(),U.DT_UINT8=Vr(),U.DT_INT16=Yr(),U.DT_UINT16=Qr(),U.DT_INT32=qr(),U.DT_UINT32=Kr(),U.DT_INT64=$r(),U.DT_UINT64=Xr(),U.DT_FLOAT32=Zr(),U.DT_FLOAT64=Jr(),U.DT_BOOL=tn(),U.DT_TYPES_COUNT=en(),U.OK=rn(),U.DRACO_ERROR=nn(),U.IO_ERROR=on(),U.INVALID_PARAMETER=an(),U.UNSUPPORTED_VERSION=sn(),U.UNKNOWN_VERSION=cn()}bt?t():ht.unshift(t)}(),"function"==typeof U.onModuleParsed&&U.onModuleParsed(),U.Decoder.prototype.GetEncodedGeometryType=function(t){if(t.__class__&&t.__class__===U.DecoderBuffer)return U.Decoder.prototype.GetEncodedGeometryType_Deprecated(t);if(8>t.byteLength)return U.INVALID_GEOMETRY_TYPE;switch(t[7]){case 0:return U.POINT_CLOUD;case 1:return U.TRIANGULAR_MESH;default:return U.INVALID_GEOMETRY_TYPE}},t.ready});t.exports=o});ha.DracoDecoderModule;var ya={createEncoderModule:ma,createDecoderModule:ha};ya.createEncoderModule,ya.createDecoderModule;const ba=(t,e,r,n)=>{const o=e.GetAttributeByUniqueId(r,n),i=o.num_components(),a=r.num_points()*i;if(o.data_type()!==t.DT_FLOAT32)throw new Error("Only DT_FLOAT32 is supported");const s=Float32Array,c=a*s.BYTES_PER_ELEMENT,u=t.DT_FLOAT32,p=t._malloc(c);e.GetAttributeDataArrayForAllPoints(r,o,u,c,p);const l=new s(t.HEAPF32.buffer,p,a).slice();return t._free(p),l},va=(t,e,r,n,o)=>{const{extensions:{KHR_draco_mesh_compression:i}={}}=o;if(!i)return;const a=((t,e,r,n,o)=>{var i;const{bufferView:a}=o,s=r.bufferViews[a],c=new t.DecoderBuffer,u=new Int8Array(n.buffer,n.byteOffset+(s.byteOffset||0),s.byteLength);c.Init(u,s.byteLength);const p=e.GetEncodedGeometryType(c);let l,f;if(p===t.TRIANGULAR_MESH)l=new t.Mesh,f=e.DecodeBufferToMesh(c,l);else if(p===t.POINT_CLOUD)l=new t.PointCloud,f=e.DecodeBufferToPointCloud(c,l);else{const t="Error: Unknown geometry type.";console.error(t)}if(!f||!l||!f.ok()||0===(null===(i=l)||void 0===i?void 0:i.ptr))throw new Error(`Decoding failed: ${f?f.error_msg():"unknown error"}`);return t.destroy(c),l})(t,e,r,n,i);i.accessors=[];for(const r of Object.values(i.attributes))i.accessors[r]=ba(t,e,a,r);i.accessors[o.indices]=((t,e,r)=>{const n=3*r.num_faces(),o=4*n,i=t._malloc(o);e.GetTrianglesUInt32Array(r,o,i);const a=new Uint32Array(t.HEAPF32.buffer,i,n).slice();return t._free(i),a})(t,e,a),t.destroy(a)};async function ga(t,e){const{extensionsRequired:r=[]}=t;if(!r.includes("KHR_draco_mesh_compression"))return;const n=await async function(){const t=require("draco3d/draco_decoder.wasm");return ya.createDecoderModule({locateFile:()=>t})}(),o=new n.Decoder;t.meshes.forEach(r=>{r.primitives.forEach(r=>{va(n,o,t,e,r)})}),n.destroy(o)}const Aa=["KHR_draco_mesh_compression","KHR_materials_unlit"];async function wa(t){const e=new DataView(t);let r=0;function n(){const t=e.getUint32(r,!0);return r+=4,t}const o=n();if(1179937895!==o)throw new Error(`incorrect magic value 0x${o.toString(16)}`);const i=n();if(2!==i)throw new Error(`incorrect version ${i}`);const a=n();if(a!==e.byteLength)throw new Error(`length ${a} doesn't match response length ${e.byteLength}`);function s(t){do{const o=n();if(n()===t){const t=new DataView(e.buffer,r,o);return r+=o,t}r+=o}while(r<a)}const c=s(1313821514);if(!c)throw new Error("no JSON chunk found");const u=JSON.parse((new TextDecoder).decode(c)),p=s(5130562);if(!p)return{json:u};if(void 0!==u.buffers[0].uri)throw new Error("expected GLB-stored buffer");for(const t of null!==(l=u.extensionsRequired)&&void 0!==l?l:[]){var l;Aa.includes(t)||console.warn(`Extension ${t} not supported by parseGLB()`)}const f=u.accessors.map(t=>{var e;if(null==t.bufferView)return null;let r,n;switch(t.componentType){case WebGLRenderingContext.BYTE:r=Int8Array;break;case WebGLRenderingContext.UNSIGNED_BYTE:r=Uint8Array;break;case WebGLRenderingContext.SHORT:r=Int16Array;break;case WebGLRenderingContext.UNSIGNED_SHORT:r=Uint16Array;break;case WebGLRenderingContext.UNSIGNED_INT:r=Uint32Array;break;case WebGLRenderingContext.FLOAT:r=Float32Array;break;default:throw new Error(`unrecognized componentType ${t.componentType}`)}switch(t.type){case"SCALAR":n=1;break;case"VEC2":n=2;break;case"VEC3":n=3;break;case"VEC4":case"MAT2":n=4;break;case"MAT3":n=9;break;case"MAT4":n=16;break;default:throw new Error(`unrecognized type ${t.type}`)}const o=u.bufferViews[t.bufferView];if((null!==(e=o.byteStride)&&void 0!==e?e:0)>0&&console.warn("non-zero byteStride is not supported"),0!==o.buffer)throw new Error("only GLB-stored buffers are supported");if(o.byteLength%r.BYTES_PER_ELEMENT!=0)throw new Error("bufferView.byteLength mismatch");return new r(p.buffer,p.byteOffset+(o.byteOffset||0)+(t.byteOffset||0),t.count*n)});await ga(u,p);const _=u.images&&await Promise.all(u.images.map(t=>{const e=u.bufferViews[t.bufferView],r=new DataView(p.buffer,p.byteOffset+(e.byteOffset||0),e.byteLength);return self.createImageBitmap(new Blob([r],{type:t.mimeType}))}));return{json:u,accessors:f,images:_}}var xa=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var Ea=function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=n?n(r[s],t[s],s,r,t):void 0;void 0===c&&(c=t[s]),o?X(r,s,c):fn(r,s,c)}return r};var Oa=function(t,e){return t&&Ea(e,Dt(e),t)};var Ta=function(t,e){return t&&Ea(e,gn(e),t)},ja=_(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?h.Buffer:void 0,i=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=i?i(r):new t.constructor(r);return t.copy(n),n}});var Sa=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var Ca=function(t,e){return Ea(t,Je(t),e)};var Da=function(t,e){return Ea(t,hn(t),e)},Ia=Object.prototype.hasOwnProperty;var Pa=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Ia.call(t,"index")&&(r.index=t.index,r.input=t.input),r};var Ma=function(t){var e=new t.constructor(t.byteLength);return new Se(e).set(new Se(t)),e};var Fa=function(t,e){var r=e?Ma(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},ka=/\w*$/;var Ra=function(t){var e=new t.constructor(t.source,ka.exec(t));return e.lastIndex=t.lastIndex,e},Ba=y?y.prototype:void 0,za=Ba?Ba.valueOf:void 0;var Ga=function(t){return za?Object(za.call(t)):{}};var Na=function(t,e){var r=e?Ma(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)},La="[object Boolean]",Ua="[object Date]",Wa="[object Map]",Ha="[object Number]",Va="[object RegExp]",Ya="[object Set]",Qa="[object String]",qa="[object Symbol]",Ka="[object ArrayBuffer]",$a="[object DataView]",Xa="[object Float32Array]",Za="[object Float64Array]",Ja="[object Int8Array]",ts="[object Int16Array]",es="[object Int32Array]",rs="[object Uint8Array]",ns="[object Uint8ClampedArray]",os="[object Uint16Array]",is="[object Uint32Array]";var as=function(t,e,r){var n=t.constructor;switch(e){case Ka:return Ma(t);case La:case Ua:return new n(+t);case $a:return Fa(t,r);case Xa:case Za:case Ja:case ts:case es:case rs:case ns:case os:case is:return Na(t,r);case Wa:return new n;case Ha:case Qa:return new n(t);case Va:return Ra(t);case Ya:return new n;case qa:return Ga(t)}},ss=Object.create,cs=function(){function t(){}return function(e){if(!C(e))return{};if(ss)return ss(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();var us=function(t){return"function"!=typeof t.constructor||Et(t)?{}:cs(mn(t))},ps="[object Map]";var ls=function(t){return tt(t)&&dr(t)==ps},fs=bt&&bt.isMap,_s=fs?yt(fs):ls,ds="[object Set]";var ms=function(t){return tt(t)&&dr(t)==ds},hs=bt&&bt.isSet,ys=hs?yt(hs):ms,bs=1,vs=2,gs=4,As="[object Arguments]",ws="[object Function]",xs="[object GeneratorFunction]",Es="[object Object]",Os={};Os[As]=Os["[object Array]"]=Os["[object ArrayBuffer]"]=Os["[object DataView]"]=Os["[object Boolean]"]=Os["[object Date]"]=Os["[object Float32Array]"]=Os["[object Float64Array]"]=Os["[object Int8Array]"]=Os["[object Int16Array]"]=Os["[object Int32Array]"]=Os["[object Map]"]=Os["[object Number]"]=Os[Es]=Os["[object RegExp]"]=Os["[object Set]"]=Os["[object String]"]=Os["[object Symbol]"]=Os["[object Uint8Array]"]=Os["[object Uint8ClampedArray]"]=Os["[object Uint16Array]"]=Os["[object Uint32Array]"]=!0,Os["[object Error]"]=Os[ws]=Os["[object WeakMap]"]=!1;var Ts=function t(e,r,n,o,i,a){var s,c=r&bs,u=r&vs,p=r&gs;if(n&&(s=i?n(e,o,i,a):n(e)),void 0!==s)return s;if(!C(e))return e;var l=st(e);if(l){if(s=Pa(e),!c)return Sa(e,s)}else{var f=dr(e),_=f==ws||f==xs;if(ut(e))return ja(e,c);if(f==Es||f==As||_&&!i){if(s=u||_?{}:us(e),!c)return u?Da(e,Ta(s,e)):Ca(e,Oa(s,e))}else{if(!Os[f])return i?e:{};s=as(e,f,c)}}a||(a=new ye);var d=a.get(e);if(d)return d;a.set(e,s),ys(e)?e.forEach(function(o){s.add(t(o,r,n,o,e,a))}):_s(e)&&e.forEach(function(o,i){s.set(i,t(o,r,n,i,e,a))});var m=l?void 0:(p?u?An:tr:u?gn:Dt)(e);return xa(m||e,function(o,i){m&&(o=e[i=o]),fn(s,i,t(o,r,n,i,e,a))}),s};var js=function(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+e];return i};var Ss=function(t,e){return e.length<2?t:$r(t,js(e,0,-1))};var Cs=function(t,e){return e=Qr(e,t),null==(t=Ss(t,e))||delete t[Kr(Zi(e))]},Ds="[object Object]",Is=Function.prototype,Ps=Object.prototype,Ms=Is.toString,Fs=Ps.hasOwnProperty,ks=Ms.call(Object);var Rs=function(t){if(!tt(t)||S(t)!=Ds)return!1;var e=mn(t);if(null===e)return!0;var r=Fs.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Ms.call(r)==ks};var Bs=function(t){return Rs(t)?void 0:t},zs=y?y.isConcatSpreadable:void 0;var Gs=function(t){return st(t)||at(t)||!!(zs&&t&&t[zs])};var Ns=function t(e,r,n,o,i){var a=-1,s=e.length;for(n||(n=Gs),i||(i=[]);++a<s;){var c=e[a];r>0&&n(c)?r>1?t(c,r-1,n,o,i):Qe(i,c):o||(i[i.length]=c)}return i};var Ls=function(t){return null!=t&&t.length?Ns(t,1):[]};var Us=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},Ws=Math.max;var Hs=function(t,e,r){return e=Ws(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=Ws(n.length-e,0),a=Array(i);++o<i;)a[o]=n[e+o];o=-1;for(var s=Array(e+1);++o<e;)s[o]=n[o];return s[e]=r(a),Us(t,this,s)}};var Vs=function(t){return function(){return t}},Ys=$?function(t,e){return $(t,"toString",{configurable:!0,enumerable:!1,value:Vs(e),writable:!0})}:on,Qs=800,qs=16,Ks=Date.now;var $s=function(t){var e=0,r=0;return function(){var n=Ks(),o=qs-(n-r);if(r=n,o>0){if(++e>=Qs)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Ys);var Xs=function(t){return $s(Hs(t,void 0,Ls),t+"")}(function(t,e){var r={};if(null==t)return r;var n=!1;e=Lr(e,function(e){return e=Qr(e,t),n||(n=e.length>1),e}),Ea(t,An(t),r),n&&(r=Ts(r,7,Bs));for(var o=e.length;o--;)Cs(r,e[o]);return r});function Zs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function Js(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Zs(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zs(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function tc(t,e,r,n=!1){const o=n?t.originalMarker:t;if(r.some(({object:t})=>t===o))return null;const i=Js({},t),[a]=e(o,1);return i.color=a,i.colors&&i.points&&i.points.length&&(i.colors=new Array(i.points.length).fill(a)),i}const ec=(t,e,r)=>Array.isArray(t)?t.map(t=>tc(t,e,r)).filter(Boolean):tc(t,e,r),rc=(t,e,r)=>Array.isArray(t)?t.map(t=>tc(t,e,r,!0)).filter(Boolean):tc(t,e,r,!0);function nc(t,e,r,n){const o=r.filter(({object:e,instanceIndex:r})=>e===t),i=o.map(({object:t,instanceIndex:e})=>e).filter(t=>"number"==typeof t),a=Js({},t),s=a.points&&Math.ceil(a.points.length/n)||1,c=e(t,s),u=c[0];if(a.points&&a.points.length){const t=new Array(a.points.length).fill().map(()=>u);for(let e=0;e<s;e++)for(let r=0;r<n;r++){const o=e*n+r;o<t.length&&(t[o]=c[e])}if(a.colors=t,i.length)a.points=a.points.filter((t,e)=>!i.includes(Math.floor(e/n))),a.colors=a.colors.filter((t,e)=>!i.includes(Math.floor(e/n)));else if(o.length)return null}else if(a.color=u,o.length)return null;return a}const oc=t=>(e,r,n)=>Array.isArray(e)?e.map(e=>nc(e,r,n,t)).filter(Boolean):nc(e,r,n,t);function ic(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function ac(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ic(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ic(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}const sc=t=>e=>{const r=t(e),n=Rr(t=>{const{depth:n,blend:o}=t;return e(ac(ac({},r),{},{depth:n,blend:o}))},(...t)=>JSON.stringify(t)),o=t=>{var e,o;const i=t.depth||(null===(e=t.originalMarker)||void 0===e?void 0:e.depth)||r.depth||jo,a=t.blend||(null===(o=t.originalMarker)||void 0===o?void 0:o.blend)||r.blend||To;n({depth:i,blend:a})(t)};return t=>{Array.isArray(t)?t.forEach(o):o(t)}};function cc(t,e){const r=[[0,0,.5],[0,0,-.5]],n=[],o=[];for(let i=0;i<t;i++){const a=2*Math.PI*i/t,s=.5*Math.cos(a),c=.5*Math.sin(a);r.push([s,c,.5],[s,c,-.5]);const u=r.length-1,p=e?0:i+1===t?2:r.length,l=i+1===t?3:r.length+1;if(n.push([u,p,l]),o.push([u,l,1]),!e){const t=r.length-2;n.push([t,u,p]),o.push([t,p,0])}}return{points:r,sideFaces:n,endCapFaces:o}}const{points:uc,sideFaces:pc,endCapFaces:lc}=cc(30,!1),fc=sc(da(uc,pc.concat(lc))),_c=oc(1);function dc(t){return a.createElement(Qi,p({getChildrenForHitmap:_c},t,{reglCommand:fc}))}const{points:mc,sideFaces:hc,endCapFaces:yc}=cc(30,!0),bc=sc(da(mc,hc.concat(yc))),vc=oc(1);function gc(t){return a.createElement(Qi,p({getChildrenForHitmap:vc},t,{reglCommand:bc}))}const Ac=Object.freeze([0,0,1]),wc=t=>{const e=[],r=[];for(const n of t){let t,o,i,a,s,c,u,p,l;if(n.points&&2===n.points.length){const[e,r]=n.points,f=mo(n.pose.position),_=ho(n.pose.orientation);u=Rn([0,0,0],f,[e.x,e.y,e.z]);const d=Rn([0,0,0],f,[r.x,r.y,r.z]),m=Gn(u,d);Ln(l=Bn([0,0,0],d,u),l),Vn(l,l,_),p=ro([0,0,0,0],Ac,l),a=s=n.scale.y,c=n.scale.z||.3*m,t=o=n.scale.x,i=m-c}else u=mo(n.pose.position),Kn(p=ho(n.pose.orientation),p,Math.PI/2),l=Vn([0,0,0],Ac,p),t=n.scale.y||1,o=n.scale.z||1,a=2*t,s=2*o,c=.23*(n.scale.x||1),i=.77*(n.scale.x||1);const f=zn([0,0,0],u,l,i/2),_=zn([0,0,0],u,l,i+c/2);e.push({originalMarker:n,scale:{x:t,y:o,z:i},color:n.color,pose:{position:yo(f),orientation:bo(p)}}),r.push({originalMarker:n,scale:{x:a,y:s,z:c},color:n.color,pose:{position:yo(_),orientation:bo(p)}})}return{cones:r,cylinders:e}};function xc(t){const r=Xs(t,"children"),{cylinders:n,cones:o}=wc(t.children);return s.default.createElement(e.Fragment,null,s.default.createElement(dc,p({getChildrenForHitmap:rc},r),n),s.default.createElement(gc,p({getChildrenForHitmap:rc},r),o))}var Ec=e.memo(xc);const Oc=Float32Array.BYTES_PER_ELEMENT,Tc=3*Oc,jc=[1,1,1,.2],Sc={BL:0,TR:1,BR:2,TL:3},Cc=Object.keys(Sc).length,Dc=`\nprecision mediump float;\n\nattribute float pointType;\n\n// per-instance attributes\nattribute vec4 colorB;\nattribute vec4 colorC;\nattribute vec3 positionA;\nattribute vec3 positionB;\nattribute vec3 positionC;\nattribute vec3 positionD;\n// per-instance pose attributes\nattribute vec3 posePosition;\nattribute vec4 poseRotation;\n\nuniform mat4 projection, view;\nuniform float viewportWidth;\nuniform float viewportHeight;\nuniform float alpha;\nuniform float thickness;\nuniform bool joined;\nuniform bool scaleInvariant;\n\nvarying vec4 vColor;\n\n${Object.keys(Sc).map(t=>`const float POINT_${t} = ${Sc[t]}.0;`).join("\n")}\n\n#WITH_POSE\n\nvec3 applyPoseInstance(vec3 point, vec4 rotation, vec3 position) {\n  // rotate the point and then add the position of the pose\n  // this function is defined in WITH_POSE\n  return rotate(point, rotation) + position;\n}\n\nvec2 rotateCCW(vec2 v) {\n  return vec2(-v.y, v.x);\n}\n\nvec2 normalizeOrZero(vec2 v) {\n  return length(v) < 0.00001 ? vec2(0, 0) : normalize(v);\n}\n\nvoid setPosition(vec4 proj, vec2 offset) {\n  gl_Position = proj;\n\n  offset *= thickness / 2.;\n\n  if (scaleInvariant) {\n    // The given thickness is a number of pixels on screen. Divide x by width/2 and\n    // y by height/2 so that they correspond to pixel distances when scaled from clip space to NDC.\n    offset.x /= viewportWidth / 2.0;\n    offset.y /= viewportHeight / 2.0;\n    // Compensate for automatic division by w\n    offset *= proj.w;\n  } else {\n    // The line thickness should be scaled the same way the camera scales other distances.\n    // projection[0].xyz is the result of projecting a unit x-vector, so its length represents\n    // how much distances are scaled by the camera projection.\n    offset *= length(projection[0].xyz);\n    offset.y *= viewportWidth / viewportHeight;\n  }\n\n  gl_Position.xy += offset;\n}\n\nvoid main () {\n  bool isStart = positionA == positionB;\n  bool isEnd = positionC == positionD;\n  bool isLeft = (pointType == POINT_TL || pointType == POINT_BL);\n  bool isTop = (pointType == POINT_TL || pointType == POINT_TR);\n  bool isEndpoint = isLeft ? isStart : isEnd;\n\n  float scale = isTop ? 1. : -1.;\n\n  mat4 projView = projection * view;\n  vec4 projA = projView * vec4(applyPose(applyPoseInstance(positionA, poseRotation, posePosition)), 1);\n  vec4 projB = projView * vec4(applyPose(applyPoseInstance(positionB, poseRotation, posePosition)), 1);\n  vec4 projC = projView * vec4(applyPose(applyPoseInstance(positionC, poseRotation, posePosition)), 1);\n  vec4 projD = projView * vec4(applyPose(applyPoseInstance(positionD, poseRotation, posePosition)), 1);\n\n  vec2 aspectVec = vec2(viewportWidth / viewportHeight, 1.0);\n  vec2 screenA = projA.xy / projA.w * aspectVec;\n  vec2 screenB = projB.xy / projB.w * aspectVec;\n  vec2 screenC = projC.xy / projC.w * aspectVec;\n  vec2 screenD = projD.xy / projD.w * aspectVec;\n\n  vec2 dirAB = normalizeOrZero(screenB - screenA);\n  vec2 dirBC = normalizeOrZero(screenC - screenB);\n  vec2 dirCD = normalizeOrZero(screenD - screenC);\n\n  vec2 perpAB = rotateCCW(dirAB); // vector perpendicular to AB\n  vec2 perpBC = rotateCCW(dirBC); // vector perpendicular to BC\n\n  vColor = isLeft ? colorB : colorC;\n  vColor.a *= alpha;\n\n  vec4 proj = isLeft ? projB : projC;\n\n  // simple case: non-joined line list\n  if (!joined || isEndpoint) {\n    setPosition(proj, scale * perpBC);\n    return;\n  }\n\n  // clamp to prevent rounding errors from breaking the sqrt()s below\n  float cosB = clamp(-dot(dirAB, dirBC), -1., 1.);\n  float cosC = clamp(-dot(dirBC, dirCD), -1., 1.);\n\n  bool tooSharpB = cosB > 0.01;\n  bool tooSharpC = cosC > 0.01;\n  bool tooSharp = isLeft ? tooSharpB : tooSharpC;\n\n  bool turningRightB = dot(dirAB, rotateCCW(dirBC)) > 0.;\n  bool turningRightC = dot(dirBC, rotateCCW(dirCD)) > 0.;\n  bool turningRight = isLeft ? turningRightB : turningRightC;\n\n  if (tooSharp) {\n    // "fold join"\n    vec2 perp = isLeft ? perpAB : perpBC;\n    vec2 dir = isLeft ? dirAB : dirBC;\n    float scalePerp = isLeft ? -1. : 1.;\n    float scaleDir = (turningRight == isLeft) ? 1. : -1.;\n    float tanHalfB = sqrt((1. - cosB) / (1. + cosB));\n    float tanHalfC = sqrt((1. - cosC) / (1. + cosC));\n    float tanHalf = isLeft ? tanHalfB : tanHalfC;\n    setPosition(proj, scale * (scalePerp * perp + scaleDir * dir * tanHalf));\n  } else {\n    // miter join\n    vec2 bisectorB = rotateCCW(normalize(dirAB + dirBC)); // angle bisector of ABC\n    vec2 bisectorC = rotateCCW(normalize(dirBC + dirCD)); // angle bisector of BCD\n    vec2 bisector = isLeft ? bisectorB : bisectorC;\n    float sinHalfB = sqrt((1. - cosB) / 2.);\n    float sinHalfC = sqrt((1. - cosC) / 2.);\n    float sinHalf = isLeft ? sinHalfB : sinHalfC;\n    setPosition(proj, scale * bisector / sinHalf);\n  }\n}\n`;const Ic=t=>{if(!t)throw new Error("Invalid regl instance");const e=t.buffer({type:"uint16",usage:"static",data:[Sc.TL,Sc.BL,Sc.TR,Sc.BR]}),r=t.buffer({type:"float",usage:"static",data:[[0,1,1,1],[1,0,0,1],[0,1,0,1],[1,0,1,1]]}),n=t.buffer({type:"float",usage:"static",data:Ls(new Array(Cc).fill([0,0,0]))}),o=t.buffer({type:"float",usage:"static",data:Ls(new Array(Cc).fill([0,0,0,1]))}),i=t.buffer({type:"float"}),a=t.buffer({type:"float"}),s=t.buffer({type:"float"}),c=t.buffer({type:"float"}),u=t.buffer({type:"float"}),p=t(Io({vert:Dc,frag:"\nprecision mediump float;\nvarying vec4 vColor;\nvoid main () {\n  gl_FragColor = vColor;\n}\n",blend:Co,uniforms:{thickness:t.prop("scale.x"),viewportWidth:t.context("viewportWidth"),viewportHeight:t.context("viewportHeight"),alpha:t.prop("alpha"),joined:t.prop("joined"),scaleInvariant:t.prop("scaleInvariant")},attributes:{pointType:e,colorB:(t,{joined:e,monochrome:n,debug:o})=>({buffer:o?r:i,offset:0,stride:4*(e||n||o?1:2)*Oc,divisor:n||o?0:1}),colorC:(t,{joined:e,monochrome:n,debug:o})=>({buffer:o?r:i,offset:n||o?0:4*Oc,stride:4*(e||n||o?1:2)*Oc,divisor:n||o?0:1}),positionA:(t,{joined:e})=>({buffer:a,offset:0,stride:(e?1:2)*Tc,divisor:1}),positionB:(t,{joined:e})=>({buffer:a,offset:Tc,stride:(e?1:2)*Tc,divisor:1}),positionC:(t,{joined:e})=>({buffer:s,offset:2*Tc,stride:(e?1:2)*Tc,divisor:1}),positionD:(t,{joined:e})=>({buffer:s,offset:3*Tc,stride:(e?1:2)*Tc,divisor:1}),posePosition:(t,{hasInstancedPoses:e})=>({buffer:e?c:n,divisor:e?1:0}),poseRotation:(t,{hasInstancedPoses:e})=>({buffer:e?u:o,divisor:e?1:0})},count:Cc,instances:t.prop("instances"),primitive:t.prop("primitive")}));let l=new Float32Array(4*Cc),f=new Float32Array(0),_=0,d=new Float32Array(0),m=new Float32Array(0);function h(t){return Fo(t)?t.map(go):t}const y=Rr(e=>{const{depth:r=jo,blend:n=To}=e;return t({depth:r,blend:n})},(...t)=>JSON.stringify(t)),b=(t,e)=>{const{debug:r}=t;r?y({depth:{enable:!1}})(e):y(t)(e)};function v(t){const{debug:e,primitive:r="lines",scaleInvariant:n=!1,depth:o,blend:y}=t,v=t.points.length;if(v<2)return;const g=v>2&&function(t,e){const[r,n,o]=Fo(t)?mo(t):t,[i,a,s]=Fo(e)?mo(e):e;return r===i&&n===a&&o===s}(t.points[0],t.points[v-1]),A=!g&&t.closed,w=function(t,e,r){const n=t.length+(r?3:2);_<n&&(f=new Float32Array(3*n),_=n),t.forEach((t,e)=>{const[r,n,o]=Fo(t)?mo(t):t,i=3+3*e;f[i+0]=r,f[i+1]=n,f[i+2]=o});const o=3*n;return e?(f.copyWithin(0,o-9,o-6),f.copyWithin(o-3,6,9)):r?(f.copyWithin(0,o-9,o-6),f.copyWithin(o-6,3,9)):(f.copyWithin(0,3,6),f.copyWithin(o-3,o-6,o-3)),f.subarray(0,o)}(t.points,g,A);a({data:w,usage:"dynamic"}),s({data:w,usage:"dynamic"});const x=!(t.colors&&t.colors.length),E=function(t,e,r,n){if(r){l.length<4*Cc&&(l=new Float32Array(4*Cc));const e=t||jc,[r]=h([e]),[n,o,i,a]=r;for(let t=0;t<Cc;t++){const e=4*t;l[e+0]=n,l[e+1]=o,l[e+2]=i,l[e+3]=a}return l.subarray(0,4*Cc)}if(e){const t=n?e.length+1:e.length;l.length<4*t&&(l=new Float32Array(4*t));const r=h(e);for(let t=0;t<r.length;t++){const e=4*t,[n,o,i,a]=r[t];l[e+0]=n,l[e+1]=o,l[e+2]=i,l[e+3]=a}if(n){const[e,n,o,i]=r[0],a=t-1;l[4*a+0]=e,l[4*a+1]=n,l[4*a+2]=o,l[4*a+3]=i}return l.subarray(0,4*t)}throw new Error("Impossible: !monochrome implies !!colors.")}(t.color,t.colors,x,A);i({data:E,usage:"dynamic"});const O="line strip"===r,T=v+(A?1:0),j=O?T-1:Math.floor(T/2),{poses:S}=t,C=!!S&&S.length>0;if(C&&S){if(j!==S.length)return void console.error(`Expected ${j} poses but given ${S.length} poses: will result in webgl error.`);const{positionData:t,rotationData:e}=function(t,e){d.length<3*t&&(d=new Float32Array(3*t),m=new Float32Array(4*t));for(let t=0;t<e.length;t++){const r=3*t,n=4*t,{position:o,orientation:i}=e[t],a=Array.isArray(o)?o:mo(o);d[r+0]=a[0],d[r+1]=a[1],d[r+2]=a[2];const s=Array.isArray(i)?i:[i.x,i.y,i.z,i.w];m[n+0]=s[0],m[n+1]=s[1],m[n+2]=s[2],m[n+3]=s[3]}return{positionData:d.subarray(0,3*t),rotationData:m.subarray(0,4*t)}}(j,S);c({data:t,usage:"dynamic"}),u({data:e,usage:"dynamic"})}b({debug:e,depth:o,blend:y},()=>{p(Object.assign({},t,{joined:O,primitive:"triangle strip",alpha:e?.2:1,monochrome:x,instances:j,scaleInvariant:n,hasInstancedPoses:C})),e&&p(Object.assign({},t,{joined:O,primitive:"line strip",alpha:1,monochrome:x,instances:j,scaleInvariant:n,hasInstancedPoses:C}))})}return t=>{Array.isArray(t)?t.forEach(v):v(t)}};function Pc(t){return a.createElement(Qi,p({getChildrenForHitmap:ec},t,{reglCommand:Ic}))}const Mc=t=>({x:t[0],y:t[1],z:t[2]}),Fc=100,kc={orientation:{x:0,y:0,z:0,w:0},position:{x:0,y:0,z:0}};class Rc extends s.default.Component{render(){return s.default.createElement(Pc,null,this.props.children)}}l(Rc,"defaultProps",{children:[{pose:kc,points:[[-Fc,0,0],[Fc,0,0]].map(Mc),scale:{x:.5,y:.5,z:.5},color:{r:.95,g:.26,b:.4,a:1}},{pose:kc,points:[[0,-100,0],[0,100,0]].map(Mc),scale:{x:.5,y:.5,z:.5},color:{r:.02,g:.82,b:.49,a:1}},{pose:kc,points:[[0,0,-100],[0,0,100]].map(Mc),scale:{x:.5,y:.5,z:.5},color:{r:.11,g:.51,b:.92,a:1}}]});const Bc=sc(da([[-.5,-.5,-.5],[-.5,.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,-.5,.5],[-.5,.5,.5],[.5,-.5,.5],[.5,.5,.5]],[[0,1,2],[1,2,3],[4,5,6],[5,6,7],[0,2,4],[2,4,6],[1,3,5],[3,5,7],[2,3,6],[3,6,7],[0,1,4],[1,4,5]])),zc=oc(1);const Gc=[[0,0,.5],[0,0,-.5]],Nc=[];for(let t=0;t<15;t++){for(let e=0;e<15;e++){const r=(t+1)/16*Math.PI,n=.5*Math.cos(r),o=.5*Math.sin(r),i=2*e*Math.PI/15,a=o*Math.cos(i),s=o*Math.sin(i);if(Gc.push([a,s,n]),e>0){const e=0===t?0:Gc.length-1-15;Nc.push([Gc.length-2,Gc.length-1,e]),t>0&&Nc.push([Gc.length-2,e-1,e])}}const e=0===t?0:Gc.length-30;Nc.push([Gc.length-1,Gc.length-15,e]),t>0&&Nc.push([Gc.length-1,Gc.length-15-1,e])}for(let t=0;t<15;t++){const e=Gc.length-15+t,r=0===t?Gc.length-1:e-1;Nc.push([e,r,1])}const Lc=sc(da(Gc,Nc)),Uc=oc(1);function Wc(t){return a.createElement(Qi,p({getChildrenForHitmap:Uc},t,{reglCommand:Lc}))}function Hc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function Vc(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Hc(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Hc(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Yc(t,e){return{x:t.x*e,y:t.y*e,z:t.z*e}}const Qc=[1,1,1,1],qc=[.8,0,.8,1],Kc=[1,.2,1,1],$c="line strip",Xc={x:.1,y:.1,z:.1},Zc=Yc(Xc,1.3),Jc={x:.5,y:.5,z:.5},tu=Yc(Jc,1.3),eu={position:{x:0,y:0,z:0},orientation:{x:0,y:0,z:0,w:0}};let ru=1;class nu{constructor(t){l(this,"id",void 0),l(this,"point",void 0),l(this,"active",!1),this.id=ru++,this.point=t}}class ou{constructor(t=""){l(this,"id",void 0),l(this,"name",void 0),l(this,"points",[]),l(this,"active",!1),this.name=t,this.id=ru++}}const iu=(t,e,r)=>t.map(t=>{if(r.some(({object:e})=>e===t))return null;const n=Vc({},t),[o]=e(t.originalMarker,1);return n.scale=Jc,n.color=o,n.colors&&n.points&&n.points.length&&(n.colors=new Array(n.points.length).fill(o)),n}).filter(Boolean);class au extends s.default.Component{render(){const t=this.props.children,e=[];for(const r of t){const t=r.active?qc:Qc,n=r.points.map(({point:t})=>yo(t));e.push({primitive:$c,pose:eu,points:n,scale:Xc,color:Ao(t),originalMarker:r})}return s.default.createElement(Pc,{getChildrenForHitmap:iu},e)}}const su=(t,e,r)=>t.map(t=>{if(r.some(({object:e})=>e===t))return null;const n=Vc({},t);return n.colors=n.colors.map((r,n)=>e(t.originalMarkers[n],1)),n.scale=tu,n}).filter(Boolean);class cu extends s.default.Component{render(){const t=this.props.children,e=[],r=[],n=[];for(const o of t){const t=o.active?qc:Qc;for(const i of o.points){const o=yo(i.point);e.push(o),r.push(i.active?Kc:t),n.push(i)}}const o={points:e,colors:r,pose:eu,scale:Zc,originalMarkers:n};return s.default.createElement(Wc,{getChildrenForHitmap:su},[o])}}function uu(t,e,r,n,o,i,a){var s;o?(s=((i-t)*r+(a-e)*n)/o)<0?s=0:s>1&&(s=1):s=0;var c=i-(t+s*r),u=a-(e+s*n);return c*c+u*u}function pu(t,e,r,n,o,i){var a=r-t,s=n-e;return uu(t,e,a,s,a*a+s*s,o,i)}function lu(t,e,r,n,o,i){return Math.sqrt(pu(t,e,r,n,o,i))}lu.squared=pu,lu.squaredWithPrecalc=uu;var fu=lu;function _u(t,e){const[r,n,o]=t.point,[i,a,s]=e.point;return r===i&&n===a&&o===s}function du(t){const{points:e}=t;for(let t=0;t<e.length-1;t++)if(_u(e[t],e[t+1]))return!0;return _u(e[0],e[e.length-1])}function mu(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}var hu=bu,yu=bu;function bu(t,e,r){r=r||2;var n,o,i,a,s,c,u,p=e&&e.length,l=p?e[0]*r:t.length,f=vu(t,0,l,r,!0),_=[];if(!f||f.next===f.prev)return _;if(p&&(f=function(t,e,r,n){var o,i,a,s,c,u=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,s=o<i-1?e[o+1]*n:t.length,(c=vu(t,a,s,n,!1))===c.next&&(c.steiner=!0),u.push(Du(c));for(u.sort(Tu),o=0;o<u.length;o++)r=gu(r=ju(u[o],r),r.next);return r}(t,e,f,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var d=r;d<l;d+=r)(s=t[d])<n&&(n=s),(c=t[d+1])<o&&(o=c),s>i&&(i=s),c>a&&(a=c);u=0!==(u=Math.max(i-n,a-o))?1/u:0}return Au(f,_,r,n,o,u),_}function vu(t,e,r,n,o){var i,a;if(o===Wu(t,e,r,n)>0)for(i=e;i<r;i+=n)a=Nu(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=Nu(i,t[i],t[i+1],a);return a&&Fu(a,a.next)&&(Lu(a),a=a.next),a}function gu(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Fu(n,n.next)&&0!==Mu(n.prev,n,n.next))n=n.next;else{if(Lu(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function Au(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{null===o.z&&(o.z=Cu(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,s,c,u=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,s=0,e=0;e<u&&(s++,n=n.nextZ);e++);for(c=u;s>0||c>0&&n;)0!==s&&(0===c||!n||r.z<=n.z)?(o=r,r=r.nextZ,s--):(o=n,n=n.nextZ,c--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,u*=2}while(a>1)}(o)}(t,n,o,i);for(var s,c,u=t;t.prev!==t.next;)if(s=t.prev,c=t.next,i?xu(t,n,o,i):wu(t))e.push(s.i/r),e.push(t.i/r),e.push(c.i/r),Lu(t),t=c.next,u=c.next;else if((t=c)===u){a?1===a?Au(t=Eu(gu(t),e,r),e,r,n,o,i,2):2===a&&Ou(t,e,r,n,o,i):Au(gu(t),e,r,n,o,i,1);break}}}function wu(t){var e=t.prev,r=t,n=t.next;if(Mu(e,r,n)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(Iu(e.x,e.y,r.x,r.y,n.x,n.y,o.x,o.y)&&Mu(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function xu(t,e,r,n){var o=t.prev,i=t,a=t.next;if(Mu(o,i,a)>=0)return!1;for(var s=o.x<i.x?o.x<a.x?o.x:a.x:i.x<a.x?i.x:a.x,c=o.y<i.y?o.y<a.y?o.y:a.y:i.y<a.y?i.y:a.y,u=o.x>i.x?o.x>a.x?o.x:a.x:i.x>a.x?i.x:a.x,p=o.y>i.y?o.y>a.y?o.y:a.y:i.y>a.y?i.y:a.y,l=Cu(s,c,e,r,n),f=Cu(u,p,e,r,n),_=t.prevZ,d=t.nextZ;_&&_.z>=l&&d&&d.z<=f;){if(_!==t.prev&&_!==t.next&&Iu(o.x,o.y,i.x,i.y,a.x,a.y,_.x,_.y)&&Mu(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,d!==t.prev&&d!==t.next&&Iu(o.x,o.y,i.x,i.y,a.x,a.y,d.x,d.y)&&Mu(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;_&&_.z>=l;){if(_!==t.prev&&_!==t.next&&Iu(o.x,o.y,i.x,i.y,a.x,a.y,_.x,_.y)&&Mu(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&Iu(o.x,o.y,i.x,i.y,a.x,a.y,d.x,d.y)&&Mu(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Eu(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!Fu(o,i)&&ku(o,n,n.next,i)&&zu(o,i)&&zu(i,o)&&(e.push(o.i/r),e.push(n.i/r),e.push(i.i/r),Lu(n),Lu(n.next),n=t=i),n=n.next}while(n!==t);return gu(n)}function Ou(t,e,r,n,o,i){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Pu(a,s)){var c=Gu(a,s);return a=gu(a,a.next),c=gu(c,c.next),Au(a,e,r,n,o,i),void Au(c,e,r,n,o,i)}s=s.next}a=a.next}while(a!==t)}function Tu(t,e){return t.x-e.x}function ju(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=o&&s>a){if(a=s,s===o){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(o===a)return r;var c,u=r,p=r.x,l=r.y,f=1/0;n=r;do{o>=n.x&&n.x>=p&&o!==n.x&&Iu(i<l?o:a,i,p,l,i<l?a:o,i,n.x,n.y)&&(c=Math.abs(i-n.y)/(o-n.x),zu(n,t)&&(c<f||c===f&&(n.x>r.x||n.x===r.x&&Su(r,n)))&&(r=n,f=c)),n=n.next}while(n!==u);return r}(t,e);if(!r)return e;var n=Gu(r,t),o=gu(r,r.next);return gu(n,n.next),e===r?o:e}function Su(t,e){return Mu(t.prev,t,e.prev)<0&&Mu(e.next,t,t.next)<0}function Cu(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Du(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Iu(t,e,r,n,o,i,a,s){return(o-a)*(e-s)-(t-a)*(i-s)>=0&&(t-a)*(n-s)-(r-a)*(e-s)>=0&&(r-a)*(i-s)-(o-a)*(n-s)>=0}function Pu(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&ku(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(zu(t,e)&&zu(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Mu(t.prev,t,e.prev)||Mu(t,e.prev,e))||Fu(t,e)&&Mu(t.prev,t,t.next)>0&&Mu(e.prev,e,e.next)>0)}function Mu(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Fu(t,e){return t.x===e.x&&t.y===e.y}function ku(t,e,r,n){var o=Bu(Mu(t,e,r)),i=Bu(Mu(t,e,n)),a=Bu(Mu(r,n,t)),s=Bu(Mu(r,n,e));return o!==i&&a!==s||(!(0!==o||!Ru(t,r,e))||(!(0!==i||!Ru(t,n,e))||(!(0!==a||!Ru(r,t,n))||!(0!==s||!Ru(r,e,n)))))}function Ru(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Bu(t){return t>0?1:t<0?-1:0}function zu(t,e){return Mu(t.prev,t,t.next)<0?Mu(t,e,t.next)>=0&&Mu(t,t.prev,e)>=0:Mu(t,e,t.prev)<0||Mu(t,t.next,e)<0}function Gu(t,e){var r=new Uu(t.i,t.x,t.y),n=new Uu(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function Nu(t,e,r,n){var o=new Uu(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Lu(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Uu(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Wu(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}bu.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Wu(t,0,i,r));if(o)for(var s=0,c=e.length;s<c;s++){var u=e[s]*r,p=s<c-1?e[s+1]*r:t.length;a-=Math.abs(Wu(t,u,p,r))}var l=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,_=n[s+1]*r,d=n[s+2]*r;l+=Math.abs((t[f]-t[d])*(t[_+1]-t[f+1])-(t[f]-t[_])*(t[d+1]-t[f+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},bu.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},hu.default=yu;const Hu=!0,Vu=!1,Yu=!0,Qu=!0,qu=t=>Io({primitive:"triangles",vert:"\n  precision mediump float;\n\n  attribute vec3 point;\n\n  uniform mat4 projection, view;\n\n  #WITH_POSE\n\n  void main () {\n    vec3 pos = applyPose(point);\n    gl_Position = projection * view * vec4(pos, 1);\n  }\n  ",frag:"\n  precision mediump float;\n  uniform vec4 color;\n  void main () {\n    gl_FragColor = color;\n  }\n  ",attributes:{point:(t,e)=>Fo(e.points)?vo(e.points):e.points},uniforms:{color:(t,e)=>Fo(e.color)?go(e.color):e.color},depth:{enable:(t,e)=>e.depth&&e.depth.enable||Hu,mask:(t,e)=>e.depth&&e.depth.mask||Vu},blend:Co,count:(t,e)=>e.points.length}),Ku=t=>Io({primitive:"triangles",vert:"\n  precision mediump float;\n\n  attribute vec3 point;\n  attribute vec4 color;\n\n  uniform mat4 projection, view;\n\n  varying vec4 vColor;\n\n  #WITH_POSE\n\n  void main () {\n    vec3 pos = applyPose(point);\n    vColor = color;\n    gl_Position = projection * view * vec4(pos, 1);\n  }\n  ",frag:"\n  precision mediump float;\n  varying vec4 vColor;\n  void main () {\n    gl_FragColor = vColor;\n  }\n  ",attributes:{point:(t,e)=>Fo(e.points)?vo(e.points):e.points,color:(t,e)=>{if(!e.colors||!e.colors.length)throw new Error('Invalid empty or null prop "colors" when rendering triangles using vertex colors');return Fo(e.colors)?Po(e):e.colors}},depth:{enable:(t,e)=>e.depth&&e.depth.enable||Yu,mask:(t,e)=>e.depth&&e.depth.mask||Qu},blend:Co,count:(t,e)=>e.points.length}),$u=t=>{const e=sc(qu)(t),r=sc(Ku)(t);return(t,n)=>{const o=Array.isArray(t)?t:[t],i=[],a=[];o.forEach(t=>{!n&&t.onlyRenderInHitmap||(t.colors&&t.colors.length?a.push(t):i.push(t))}),e(i),r(a)}},Xu=()=>$u,Zu=oc(3);function Ju(t){return a.createElement(Qi,p({getChildrenForHitmap:Zu},t,{reglCommand:$u}))}const tp=["children"];function ep(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function rp(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ep(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ep(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}const np={position:{x:0,y:0,z:0},orientation:{x:0,y:0,z:0,w:0}},op={x:1,y:1,z:1};function ip(t){const e=function(t){const e=new Float32Array(3*t.length);for(let r=0;r<t.length;r++){const[n,o,i]=t[r];e[3*r]=n,e[3*r+1]=o,e[3*r+2]=i}return e}(t),r=hu(e,null,3),n=[];for(let e=0;e<r.length;e++){const o=r[e];n.push(t[o])}return n}const ap=t=>t.map(t=>{const e=Fo(t.points)?t.points.map(mo):t.points,r=t.pose?t.pose:np,n=ip(e);return rp(rp({},t),{},{points:n,pose:r,scale:op,originalMarker:t})});var sp=pp,cp=pp,up=1e20;function pp(t,e,r,n,o,i){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=n||.25,this.fontFamily=o||"sans-serif",this.fontWeight=i||"normal",this.radius=r||8;var a=this.size=this.fontSize+2*this.buffer,s=a+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function lp(t,e,r,n,o,i){for(var a=0;a<e;a++)fp(t,a,e,r,n,o,i);for(var s=0;s<r;s++)fp(t,s*e,1,e,n,o,i)}function fp(t,e,r,n,o,i,a){var s,c,u,p;for(i[0]=0,a[0]=-up,a[1]=up,s=0;s<n;s++)o[s]=t[e+s*r];for(s=1,c=0,u=0;s<n;s++){do{p=i[c],u=(o[s]-o[p]+s*s-p*p)/(s-p)/2}while(u<=a[c]&&--c>-1);i[++c]=s,a[c]=u,a[c+1]=up}for(s=0,c=0;s<n;s++){for(;a[c+1]<s;)c++;p=i[c],t[e+s*r]=o[p]+(s-p)*(s-p)}}pp.prototype._draw=function(t,e){var r,n,o,i,a,s,c,u,p,l=this.ctx.measureText(t),f=l.width,_=2*this.buffer;e&&this.useMetrics?(a=Math.floor(l.actualBoundingBoxAscent),u=this.buffer+Math.ceil(l.actualBoundingBoxAscent),s=this.buffer,c=this.buffer,r=(n=Math.min(this.size,Math.ceil(l.actualBoundingBoxRight-l.actualBoundingBoxLeft)))+_,o=(i=Math.min(this.size-s,Math.ceil(l.actualBoundingBoxAscent+l.actualBoundingBoxDescent)))+_,this.ctx.textBaseline="alphabetic"):(r=n=this.size,o=i=this.size,a=19*this.fontSize/24,s=c=0,u=this.middle,this.ctx.textBaseline="middle"),n&&i&&(this.ctx.clearRect(c,s,n,i),this.ctx.fillText(t,this.buffer,u),p=this.ctx.getImageData(c,s,n,i));var d=new Uint8ClampedArray(r*o);return function(t,e,r,n,o,i,a){i.fill(up,0,e*r),a.fill(0,0,e*r);for(var s=(e-n)/2,c=0;c<o;c++)for(var u=0;u<n;u++){var p=(c+s)*e+u+s,l=t.data[4*(c*n+u)+3]/255;if(1===l)i[p]=0,a[p]=up;else if(0===l)i[p]=up,a[p]=0;else{var f=Math.max(0,.5-l),_=Math.max(0,l-.5);i[p]=f*f,a[p]=_*_}}}(p,r,o,n,i,this.gridOuter,this.gridInner),lp(this.gridOuter,r,o,this.f,this.v,this.z),lp(this.gridInner,r,o,this.f,this.v,this.z),function(t,e,r,n,o,i,a){for(var s=0;s<e*r;s++){var c=Math.sqrt(n[s])-Math.sqrt(o[s]);t[s]=Math.round(255-255*(c/i+a))}}(d,r,o,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:d,metrics:{width:n,height:i,sdfWidth:r,sdfHeight:o,top:a,left:0,advance:f}}},pp.prototype.draw=function(t){return this._draw(t,!1).data},pp.prototype.drawWithMetrics=function(t){return this._draw(t,!0)},sp.default=cp;var _p=function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1};var dp=function(t){return t!=t};var mp=function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1};var hp=function(t,e,r){return e==e?mp(t,e,r):_p(t,dp,r)};var yp=function(t,e){return!(null==t||!t.length)&&hp(t,e,0)>-1};var bp=function(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1},vp=200;var gp=function(t,e,r,n){var o=-1,i=yp,a=!0,s=t.length,c=[],u=e.length;if(!s)return c;r&&(e=Lr(e,yt(r))),n?(i=bp,a=!1):e.length>=vp&&(i=Ee,a=!1,e=new we(e));t:for(;++o<s;){var p=t[o],l=null==r?p:r(p);if(p=n||0!==p?p:0,a&&l==l){for(var f=u;f--;)if(e[f]===l)continue t;c.push(p)}else i(e,l,n)||c.push(p)}return c};var Ap=function(t){return tt(t)&&Ct(t)},wp=function(t,e){return $s(Hs(t,e,on),t+"")}(function(t,e){return Ap(t)?gp(t,Ns(e,1,Ap,!0)):[]}),xp=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function Ep(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(n=t[r],o=e[r],!(n===o||xp(n)&&xp(o)))return!1;var n,o;return!0}function Op(t,e){var r;void 0===e&&(e=Ep);var n,o=[],i=!1;return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return i&&r===this&&e(a,o)?n:(n=t.apply(this,a),i=!0,r=this,o=a,n)}}const Tp="#ffffff",jp="rgba(0,0,0,0.8)",Sp=128,Cp={r:1,g:1,b:1,a:1},Dp={r:0,g:0,b:0,a:.8};let Ip=!1;function Pp({r:t,g:e,b:r}){return 54.213*t+182.376*e+18.411*r<Sp}function Mp(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a}class Fp{constructor(){l(this,"wrapper",document.createElement("span")),l(this,"_inner",document.createElement("span")),l(this,"_text",document.createTextNode("")),l(this,"_prevTextColor",Cp),l(this,"_prevBgColor",Dp),l(this,"_prevAutoBackgroundColor",null),function(){if(Ip)return;const t=document.createElement("style");t.innerHTML="\n    .regl-worldview-text-wrapper {\n      position: absolute;\n      white-space: nowrap;\n      z-index: 100;\n      pointer-events: none;\n      top: 0;\n      left: 0;\n      will-change: transform;\n    }\n    .regl-worldview-text-inner {\n      position: relative;\n      left: -50%;\n      top: -0.5em;\n      white-space: pre-line;\n    }\n  ",document.body&&document.body.appendChild(t),Ip=!0}(),this.wrapper.className="regl-worldview-text-wrapper",this._inner.className="regl-worldview-text-inner",this.wrapper.appendChild(this._inner),this._inner.appendChild(this._text),this.wrapper.style.color=xo(Cp)}update(t,e,r,n){this.wrapper.style.transform=`translate(${e.toFixed()}px,${r.toFixed()}px)`;const{color:o,colors:i=[]}=t,a=i.length>=2,s=wo(a?i[0]:o||[0,0,0,1]);if(s){const t=wo(i[1]);if(Mp(this._prevTextColor,s)||(this._prevTextColor=s,this.wrapper.style.color=xo(s)),n||n===this._prevAutoBackgroundColor)if(n&&(!this._prevBgColor||this._prevBgColor&&!Mp(s,this._prevBgColor))){this._prevBgColor=s;const t=Pp(s)?Tp:jp;this._inner.style.background=t}else a&&this._prevBgColor&&!Mp(t,this._prevBgColor)&&(this._prevBgColor=t,this._inner.style.background=xo(t));else this._inner.style.background="transparent",this._prevBgColor=null}this._prevAutoBackgroundColor=n,this._text.textContent!==t.text&&(this._text.textContent=t.text||"")}}class kp extends s.default.Component{constructor(...t){super(...t),l(this,"_context",void 0),l(this,"_textComponents",new Map),l(this,"_textContainerRef",s.default.createRef()),l(this,"componentWillUnmount",()=>{this._context&&this._context.unregisterPaintCallback(this.paint)}),l(this,"paint",()=>{const t=this._context,e=this._textComponents,{children:r,autoBackgroundColor:n}=this.props,{current:o}=this._textContainerRef,i=t&&t.initializedData;if(!o||!t||!i)return;const{dimension:a,dimension:{width:s,height:c}}=t,{camera:u}=i,p=new Set(e.keys());for(const t of r){const{pose:r,name:i}=t,{position:l}=r,f=this.project(l,u,a);if(!f)continue;const[_,d]=f;if(_<-10||d<-10||_>s+10||d>c+10)continue;let m=e.get(i||t);m?p.delete(i||t):(m=new Fp,e.set(i||t,m),o.appendChild(m.wrapper)),m.update(t,_,d,n)}for(const t of p){const r=e.get(t);r&&(r.wrapper.remove(),e.delete(t))}}),l(this,"project",(t,e,r)=>{const n=[t.x,t.y,t.z],{left:o,top:i,width:a,height:s}=r,c=[o,i,a,s];return e.toScreenCoord(c,n)})}componentDidMount(){this._context&&this._context.registerPaintCallback(this.paint)}render(){return s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{ref:this._textContainerRef}),s.default.createElement(Yi.Consumer,null,t=>(t&&(this._context=t),null)))}}l(kp,"defaultProps",{children:[]}),"undefined"==typeof self||self.document||(self.document={createElement:()=>new OffscreenCanvas(0,0)});const Rp=.25,Bp=10,zp=Object.freeze({r:1,g:1,b:1,a:1}),Gp=Object.freeze({r:0,g:0,b:0,a:1}),Np=Op(t=>{const e=(self.OffscreenCanvas?new OffscreenCanvas(0,0):document.createElement("canvas")).getContext("2d");return e.font=t,e}),Lp=t=>{const{x:e,y:r,z:n}=t.pose.position;return`x${e}y${r}z${n}`},Up=(t,e)=>t.get(Lp(e))||0,Wp=(t,e,r)=>{t.set(Lp(e),r)},Hp=()=>Op((t,e,r,n)=>{const o=new sp(r,Bp,8,Rp,"sans-serif","normal"),i=Np(`${r}px sans-serif`);let a=0;const s=r+2*Bp,c={};let u=0,p=0;for(const e of t){const t=i.measureText(e).width,r=Math.ceil(t)+2*Bp;u+r>n&&(u=0,p+=s),c[e]={x:u,y:p,width:t},u+=r,a=Math.max(a,u)}const l=p+s,f=new Uint8Array(a*l);for(const e of t){const{x:t,y:r}=c[e],n=o.draw(e);for(let e=0;e<o.size;e++)for(let i=0;i<o.size;i++)t+i<a&&(f[a*(r+e)+t+i]=n[e*o.size+i])}return{charInfo:c,textureWidth:a,textureHeight:l,textureData:f}}),Vp=()=>Op((t,e)=>{e({data:t.textureData,width:t.textureWidth,height:t.textureHeight,format:"alpha",wrap:"clamp",mag:"linear",min:"linear"})}),Yp="\n  precision mediump float;\n\n  uniform mat4 projection, view, billboardRotation;\n  uniform float fontSize;\n  uniform vec2 atlasSize;\n  uniform bool scaleInvariant;\n  uniform float scaleInvariantSize;\n  uniform float viewportHeight;\n  uniform float viewportWidth;\n  uniform bool isPerspective;\n  uniform float cameraFovY;\n\n  // per-vertex attributes\n  attribute vec2 texCoord;\n  attribute vec2 position;\n\n  // per-instance (character) attributes\n  attribute vec2 srcOffset;\n  attribute float srcWidth;\n  attribute vec2 destOffset;\n\n  // per-marker attributes\n  attribute vec3 scale;\n  attribute float billboard;\n  attribute vec2 alignmentOffset;\n  attribute float enableBackground;\n  attribute float enableHighlight;\n  attribute vec4 foregroundColor;\n  attribute vec4 backgroundColor;\n  attribute vec4 highlightColor;\n  attribute vec3 posePosition;\n  attribute vec4 poseOrientation;\n\n  varying vec2 vTexCoord;\n  varying float vEnableBackground;\n  varying vec4 vForegroundColor;\n  varying vec4 vBackgroundColor;\n  varying vec4 vHighlightColor;\n  varying float vEnableHighlight;\n  varying float vBillboard;\n\n  // rotate a 3d point v by a rotation quaternion q\n  // like applyPose(), but we need to use a custom per-instance pose\n  vec3 rotate(vec3 v, vec4 q) {\n    vec3 temp = cross(q.xyz, v) + q.w * v;\n    return v + (2.0 * cross(q.xyz, temp));\n  }\n\n  vec4 computeVertexPosition(vec3 markerPos) {\n    vec3 pos;\n    if (billboard == 1.0) {\n      pos = (billboardRotation * vec4(markerPos, 1.0)).xyz + posePosition;\n    } else {\n      pos = rotate(markerPos, poseOrientation) + posePosition;\n    }\n    return projection * view * vec4(pos, 1.0);\n  }\n\n  void main () {\n    // Scale invariance only works for billboards\n    bool scaleInvariantEnabled = scaleInvariant && billboard == 1.0;\n\n    vec2 srcSize = vec2(srcWidth, fontSize);\n    vec3 markerSpacePos = vec3((destOffset + position * srcSize + alignmentOffset) / fontSize, 0);\n\n    if (!scaleInvariantEnabled) {\n      // Apply marker scale only when scale invariance is disabled\n      markerSpacePos *= scale;\n    } else {\n      // If scale invariance is enabled, the text will be rendered at a constant\n      // scale regardless of the zoom level.\n      // The given scaleInvariantSize is in pixels. We need to scale it based on\n      // the current canvas resolution to get the proper dimensions later in NDC\n      float scaleInvariantFactor = scaleInvariantSize / viewportHeight;\n      if (isPerspective) {\n        // When using a perspective projection, the effect is achieved by using\n        // the w-component for scaling, which is obtained by first projecting\n        // the marker position into clip space.\n        gl_Position = computeVertexPosition(markerSpacePos);\n        scaleInvariantFactor *= gl_Position.w;\n        // We also need to take into account the camera's half vertical FOV\n        scaleInvariantFactor *= cameraFovY;\n      } else {\n        // Compute inverse aspect ratio\n        float invAspect = viewportHeight / viewportWidth;\n        // When using orthographic projection, the scaling factor is obtain from\n        // the camera projection itself.\n        // We also need applied the inverse aspect ratio\n        scaleInvariantFactor *= 2.0 * invAspect / length(projection[0].xyz);\n      }\n      // Apply scale invariant factor\n      markerSpacePos *= scaleInvariantFactor;\n    }\n\n    // Compute final vertex position\n    gl_Position = computeVertexPosition(markerSpacePos);\n\n    vTexCoord = (srcOffset + texCoord * srcSize) / atlasSize;\n    vEnableBackground = enableBackground;\n    vForegroundColor = foregroundColor;\n    vBackgroundColor = backgroundColor;\n    vHighlightColor = highlightColor;\n    vEnableHighlight = enableHighlight;\n    vBillboard = billboard;\n  }\n",Qp='\n  #extension GL_OES_standard_derivatives : enable\n  precision mediump float;\n  uniform mat4 projection;\n  uniform sampler2D atlas;\n  uniform float cutoff;\n  uniform bool scaleInvariant;\n  uniform float scaleInvariantSize;\n  uniform bool isHitmap;\n\n  varying vec2 vTexCoord;\n  varying float vEnableBackground;\n  varying vec4 vForegroundColor;\n  varying vec4 vBackgroundColor;\n  varying vec4 vHighlightColor;\n  varying float vEnableHighlight;\n  varying float vBillboard;\n\n  void main() {\n    float dist = texture2D(atlas, vTexCoord).a;\n\n    // fwidth(dist) is used to provide some anti-aliasing. However it\'s currently only used\n    // when the solid background is enabled, because the alpha blending and\n    // depth test don\'t work together nicely for partially-transparent pixels.\n    float edgeStep = smoothstep(1.0 - cutoff - fwidth(dist), 1.0 - cutoff, dist);\n\n    if (scaleInvariant && vBillboard == 1.0 && scaleInvariantSize <= 20.0) {\n      // If scale invariant is enabled and scaleInvariantSize is "too small", do not interpolate\n      // the raw distance value since at such small scale, the SDF approach causes some\n      // visual artifacts.\n      // The value used for checking if scaleInvariantSize is "too small" is arbitrary and\n      // was defined after some experimentation.\n      edgeStep = dist;\n    }\n\n    if (isHitmap) {\n      // When rendering for the hitmap buffer, we draw flat polygons using the foreground color\n      // instead of the actual glyphs. This way we increase the selection range and provide a\n      // better user experience.\n      gl_FragColor = vForegroundColor;\n    } else if (vEnableHighlight > 0.5) {\n      gl_FragColor = mix(vHighlightColor, vec4(0, 0, 0, 1), edgeStep);\n    } else if (vEnableBackground > 0.5) {\n      gl_FragColor = mix(vBackgroundColor, vForegroundColor, edgeStep);\n    } else {\n      gl_FragColor = vForegroundColor;\n      gl_FragColor.a *= edgeStep;\n    }\n\n    if (gl_FragColor.a == 0.) {\n      discard;\n    }\n  }\n';const qp=t=>{var e;const r=function(t){const e=new Set(t||[]),r=Hp(),n=Vp(),o=t=>{if(!t)throw new Error("Invalid regl instance");const i=t.texture(),a=t({depth:{enable:(t,e)=>!e.scaleInvariant&&So.enable(t,e),mask:(t,e)=>!e.scaleInvariant&&So.mask(t,e)},blend:Co,primitive:"triangle strip",vert:Yp,frag:Qp,uniforms:{atlas:i,atlasSize:()=>[i.width,i.height],fontSize:t.prop("resolution"),cutoff:Rp,scaleInvariant:t.prop("scaleInvariant"),scaleInvariantSize:t.prop("scaleInvariantSize"),isHitmap:t.prop("isHitmap"),viewportHeight:t.context("viewportHeight"),viewportWidth:t.context("viewportWidth"),isPerspective:t.context("isPerspective"),cameraFovY:t.context("fovy")},instances:t.prop("instances"),count:4,attributes:{position:[[0,0],[0,-1],[1,0],[1,-1]],texCoord:[[0,0],[0,1],[1,0],[1,1]],srcOffset:(t,e)=>({buffer:e.srcOffsets,divisor:1}),destOffset:(t,e)=>({buffer:e.destOffsets,divisor:1}),srcWidth:(t,e)=>({buffer:e.srcWidths,divisor:1}),scale:(t,e)=>({buffer:e.scale,divisor:1}),alignmentOffset:(t,e)=>({buffer:e.alignmentOffset,divisor:1}),billboard:(t,e)=>({buffer:e.billboard,divisor:1}),foregroundColor:(t,e)=>({buffer:e.foregroundColor,divisor:1}),backgroundColor:(t,e)=>({buffer:e.backgroundColor,divisor:1}),highlightColor:(t,e)=>({buffer:e.highlightColor,divisor:1}),enableBackground:(t,e)=>({buffer:e.enableBackground,divisor:1}),enableHighlight:(t,e)=>({buffer:e.enableHighlight,divisor:1}),posePosition:(t,e)=>({buffer:e.posePosition,divisor:1}),poseOrientation:(t,e)=>({buffer:e.poseOrientation,divisor:1})}});return(s,c)=>{let u=0;for(const{text:t}of s){if("string"!=typeof t)throw new Error(`Expected typeof 'text' to be a string. But got type '${typeof t}' instead.`);for(const r of t)++u,e.add(r)}let p=o.textAtlas;const l=p?Object.keys(p.charInfo):[],f=Array.from(e),_=0===wp(f,l).length;if(!p||!_){const n=t.limits.maxTextureSize||2048;p=r(e,e.size,o.resolution,n)}n(p,i);const d=new Float32Array(2*u),m=new Float32Array(u),h=new Float32Array(2*u),y=new Float32Array(2*u),b=new Float32Array(3*u),v=new Float32Array(4*u),g=new Float32Array(4*u),A=new Float32Array(4*u),w=new Float32Array(u),x=new Float32Array(u),E=new Float32Array(3*u),O=new Float32Array(4*u),T=new Float32Array(u);let j=0;const S=new Map;for(const t of s){var C,D,I;let e=0,r=0,n=Up(S,t),i=0,a=1;const s=wo(c?t.color||[0,0,0,1]:(null===(C=t.colors)||void 0===C?void 0:C[0])||t.color||zp),u=null!=(null===(D=t.colors)||void 0===D?void 0:D[1])||o.autoBackgroundColor,l=wo((null===(I=t.colors)||void 0===I?void 0:I[1])||(o.autoBackgroundColor&&Pp(s)?zp:Gp)),f=(null==t?void 0:t.highlightColor)||{r:1,b:0,g:1,a:1};for(let c=0;c<t.text.length;c++){var P;const _=t.text[c];if("\n"===_){r=0,n+=o.resolution,a++;continue}const y=p.charInfo[_],S=j+i;d[2*S+0]=r,d[2*S+1]=-n,h[2*S+0]=y.x+Bp,h[2*S+1]=y.y+Bp+.05*o.resolution,m[S]=y.width,r+=y.width,e=Math.max(e,r),x[S]=null===(P=t.billboard)||void 0===P||P?1:0,b[3*S+0]=t.scale.x,b[3*S+1]=t.scale.y,b[3*S+2]=t.scale.z,E[3*S+0]=t.pose.position.x,E[3*S+1]=t.pose.position.y,E[3*S+2]=t.pose.position.z,O[4*S+0]=t.pose.orientation.x,O[4*S+1]=t.pose.orientation.y,O[4*S+2]=t.pose.orientation.z,O[4*S+3]=t.pose.orientation.w,v[4*S+0]=s.r,v[4*S+1]=s.g,v[4*S+2]=s.b,v[4*S+3]=s.a,g[4*S+0]=l.r,g[4*S+1]=l.g,g[4*S+2]=l.b,g[4*S+3]=l.a,A[4*S+0]=f.r,A[4*S+1]=f.g,A[4*S+2]=f.b,A[4*S+3]=f.a,T[S]=t.highlightedIndices&&t.highlightedIndices.includes(c)?1:0,w[S]=u?1:0,++i}const _=n+o.resolution;for(let t=0;t<i;t++)y[2*(j+t)+0]=-e/2,y[2*(j+t)+1]=_/2;Wp(S,t,_+a*o.resolution),j+=i}a({instances:j,isHitmap:!!c,scaleInvariant:o.scaleInvariant,resolution:o.resolution,scaleInvariantSize:o.scaleInvariantSize,srcOffsets:h,destOffsets:d,srcWidths:m,alignmentOffset:y,billboard:x,enableBackground:w,enableHighlight:T,foregroundColor:v,backgroundColor:g,highlightColor:A,poseOrientation:O,posePosition:E,scale:b})}};return o.autoBackgroundColor=!1,o}(t.alphabet);return r.autoBackgroundColor=t.autoBackgroundColor,r.resolution=Math.max(40,t.resolution||160),r.scaleInvariant=null!=t.scaleInvariantFontSize,r.scaleInvariantSize=null!==(e=t.scaleInvariantFontSize)&&void 0!==e?e:0,r.textAtlas=t.textAtlas,r};function Kp(t){return"object"!=typeof t&&"function"!=typeof t||null===t}function $p(){this.childBranches=new WeakMap,this.primitiveKeys=new Map,this.hasValue=!1,this.value=void 0}$p.prototype.has=function(t){var e=Kp(t)?this.primitiveKeys.get(t):t;return!!e&&this.childBranches.has(e)},$p.prototype.get=function(t){var e=Kp(t)?this.primitiveKeys.get(t):t;return e?this.childBranches.get(e):void 0},$p.prototype.resolveBranch=function(t){if(this.has(t))return this.get(t);var e=new $p,r=this.createKey(t);return this.childBranches.set(r,e),e},$p.prototype.setValue=function(t){return this.hasValue=!0,this.value=t},$p.prototype.createKey=function(t){if(Kp(t)){var e={};return this.primitiveKeys.set(t,e),e}return t},$p.prototype.clear=function(){if(0===arguments.length)this.childBranches=new WeakMap,this.primitiveKeys.clear(),this.hasValue=!1,this.value=void 0;else if(1===arguments.length){var t=arguments[0];if(Kp(t)){var e=this.primitiveKeys.get(t);e&&(this.childBranches.delete(e),this.primitiveKeys.delete(t))}else this.childBranches.delete(t)}else{var r=arguments[0];if(this.has(r)){var n=this.get(r);n.clear.apply(n,Array.prototype.slice.call(arguments,1))}}};var Xp=function(t){var e=new $p;function r(){var r=Array.prototype.slice.call(arguments),n=r.reduce(function(t,e){return t.resolveBranch(e)},e);if(n.hasValue)return n.value;var o=t.apply(null,r);return n.setValue(o)}return r.clear=e.clear.bind(e),r};const Zp=["children","model"];function Jp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function tl(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Jp(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jp(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function el(t){if(void 0!==t){switch(t){case WebGLRenderingContext.NEAREST:return"nearest";case WebGLRenderingContext.LINEAR:return"linear";case WebGLRenderingContext.NEAREST_MIPMAP_NEAREST:return"nearest mipmap nearest";case WebGLRenderingContext.NEAREST_MIPMAP_LINEAR:return"nearest mipmap linear";case WebGLRenderingContext.LINEAR_MIPMAP_NEAREST:return"linear mipmap nearest";case WebGLRenderingContext.LINEAR_MIPMAP_LINEAR:return"linear mipmap linear";case WebGLRenderingContext.REPEAT:return"repeat";case WebGLRenderingContext.CLAMP_TO_EDGE:return"clamp";case WebGLRenderingContext.MIRRORED_REPEAT:return"mirror"}throw new Error(`unhandled constant value ${JSON.stringify(t)}`)}}const rl=t=>{if(!t)throw new Error("Invalid regl instance");const e=t({primitive:"triangles",blend:Co,uniforms:{globalAlpha:t.context("globalAlpha"),poseMatrix:t.context("poseMatrix"),baseColorTexture:t.prop("baseColorTexture"),baseColorFactor:t.prop("baseColorFactor"),nodeMatrix:t.prop("nodeMatrix"),"light.direction":[0,0,-1],"light.ambientIntensity":.5,"light.diffuseIntensity":.5,hitmapColor:t.context("hitmapColor"),isHitmap:t.context("isHitmap"),unlit:t.prop("unlit"),overrideColor:t.context("overrideColor"),useOverrideColor:t.context("useOverrideColor")},attributes:{position:t.prop("positions"),normal:t.prop("normals"),texCoord:t.prop("texCoords")},elements:t.prop("indices"),vert:"\n  uniform mat4 projection, view;\n  uniform mat4 nodeMatrix;\n  uniform mat4 poseMatrix;\n  attribute vec3 position, normal;\n  varying vec3 vNormal;\n  attribute vec2 texCoord;\n  varying vec2 vTexCoord;\n\n  void main() {\n    // using the projection matrix for normals breaks lighting for orthographic mode\n    mat4 mv = view * poseMatrix * nodeMatrix;\n    vNormal = normalize((mv * vec4(normal, 0)).xyz);\n    vTexCoord = texCoord;\n    gl_Position = projection * mv * vec4(position, 1);\n  }\n  ",frag:"\n  precision mediump float;\n  uniform bool isHitmap;\n  uniform bool unlit;\n  uniform vec4 hitmapColor;\n  uniform bool useOverrideColor;\n  uniform vec4 overrideColor;\n  uniform float globalAlpha;\n  uniform sampler2D baseColorTexture;\n  uniform vec4 baseColorFactor;\n  varying mediump vec2 vTexCoord;\n  varying mediump vec3 vNormal;\n\n  // Basic directional lighting from:\n  // http://ogldev.atspace.co.uk/www/tutorial18/tutorial18.html\n  struct DirectionalLight {\n    mediump vec3 direction;\n    lowp float ambientIntensity;\n    lowp float diffuseIntensity;\n  };\n  uniform DirectionalLight light;\n\n  void main() {\n    vec4 baseColor = useOverrideColor ? overrideColor : texture2D(baseColorTexture, vTexCoord) * baseColorFactor;\n    float diffuse = light.diffuseIntensity * max(0.0, dot(vNormal, -light.direction));\n    if (isHitmap) {\n      gl_FragColor = hitmapColor;\n    } else if (unlit) {\n      gl_FragColor = vec4(baseColor.rgb, baseColor.a * globalAlpha);\n    } else {\n      gl_FragColor = vec4((light.ambientIntensity + diffuse) * baseColor.rgb, baseColor.a * globalAlpha);\n    }\n  }\n  "}),r=t.buffer([0,0]),n=t.texture({data:[255,255,255,255],width:1,height:1}),o=Xp(e=>{const{accessors:o}=e,i=e.json.textures&&e.json.textures.map(r=>{const n=r.sampler?e.json.samplers[r.sampler]:(()=>({minFilter:WebGLRenderingContext.NEAREST_MIPMAP_LINEAR,magFilter:WebGLRenderingContext.LINEAR,wrapS:WebGLRenderingContext.REPEAT,wrapT:WebGLRenderingContext.REPEAT}))(),o=e.images&&e.images[r.source];return t.texture({data:o,min:el(n.minFilter),mag:el(n.magFilter),wrapS:n.wrapS?el(n.wrapS):"repeat",wrapT:n.wrapT?el(n.wrapT):"repeat"})});e.images&&e.images.forEach(t=>t.close());const a=[];function s(t,c){const u=t.matrix?(p=t.matrix,(l=new xn(16))[0]=p[0],l[1]=p[1],l[2]=p[2],l[3]=p[3],l[4]=p[4],l[5]=p[5],l[6]=p[6],l[7]=p[7],l[8]=p[8],l[9]=p[9],l[10]=p[10],l[11]=p[11],l[12]=p[12],l[13]=p[13],l[14]=p[14],l[15]=p[15],l):In(En(),t.rotation||[0,0,0,1],t.translation||[0,0,0],t.scale||[1,1,1]);var p,l;if(Mn(u,c,u),null!=t.mesh&&function(t,s){for(const p of t.primitives){var c,u;if(4!==(null!==(c=p.mode)&&void 0!==c?c:4)){console.warn(`GLTFScene: ignoring glTF primitive with mode ${p.mode}, only TRIANGLES are currently supported`);continue}const t=e.json.materials[p.material],l=t.pbrMetallicRoughness.baseColorTexture;let f=o,_=p.attributes;const{extensions:d={}}=p,m=d.KHR_draco_mesh_compression;if(m&&(f=m.accessors,_=m.attributes),!f)throw new Error("Error decoding GLB model: Missing `accessors` in JSON data");const h=void 0!==(null===(u=t.extensions)||void 0===u?void 0:u.KHR_materials_unlit);a.push({indices:f[p.indices],positions:f[_.POSITION],normals:h?{constant:0}:f[_.NORMAL],unlit:h,texCoords:l?f[_[`TEXCOORD_${l.texCoord||0}`]]:{divisor:1,buffer:r},baseColorTexture:l?i[l.index]:n,baseColorFactor:t.pbrMetallicRoughness.baseColorFactor||[1,1,1,1],nodeMatrix:s})}}(e.json.meshes[t.mesh],u),t.children)for(const r of t.children)s(e.json.nodes[r],u)}for(const t of e.json.scenes[(({json:t})=>{var e;if(null!=t.scene)return t.scene;const r=Object.keys(null!==(e=t.scenes)&&void 0!==e?e:{});if(0===r.length)throw new Error("No scenes to render");return r[0]})(e)].nodes){const r=En();Cn(r,r,Math.PI/2),Dn(r,r,Math.PI/2),s(e.json.nodes[t],r)}return a}),i=t({context:{poseMatrix:(t,e)=>In(En(),ho(e.pose.orientation),mo(e.pose.position),e.scale?mo(e.scale):[1,1,1]),globalAlpha:(t,e)=>null==e.alpha?1:e.alpha,hitmapColor:(t,e)=>e.color||[0,0,0,1],isHitmap:(t,e)=>!!e.isHitmap,useOverrideColor:(t,e)=>!!e.overrideColor,overrideColor:(t,e)=>e.overrideColor?go(e.overrideColor):[0,0,0,1]}});return(t,r)=>{const n=o(t.model);i(r?tl(tl({},t),{},{isHitmap:r}):t,()=>{e(n)})}};function nl(t){return e.useDebugValue(t),function(t,r){const[n,o]=e.useState();return e.useEffect(e.useCallback(()=>{let e=!1;return t().then(t=>{e||o(t)}),()=>{e=!0,o(void 0)}},r||[t]),r||[t]),n}(async()=>{if("function"==typeof t)return t();if("string"==typeof t){const e=await fetch(t);if(!e.ok)throw new Error(`failed to fetch GLTF model: ${e.status}`);return wa(await e.arrayBuffer())}throw new Error(`unsupported model prop: ${typeof t}`)},[t])}const ol=["count"],il=[.3,.3,.3,1];function al(){return Io({vert:"\n    precision mediump float;\n    uniform mat4 projection, view;\n\n    attribute vec3 point;\n    attribute vec4 color;\n    varying vec4 fragColor;\n\n    void main () {\n      fragColor = color;\n      vec3 p = point;\n      gl_Position = projection * view * vec4(p, 1);\n    }\n    ",frag:"\n      precision mediump float;\n      varying vec4 fragColor;\n      void main () {\n        gl_FragColor = fragColor;\n      }\n    ",primitive:"lines",attributes:{point:(t,e)=>{const r=[],n=e.count;for(let t=-e.count;t<e.count;t++)r.push([-n,t,0]),r.push([n,t,0]),r.push([t,-n,0]),r.push([t,n,0]);return r},color:(t,e)=>{const r=e.color||il;return new Array(4*e.count*2).fill(r)}},count:(t,e)=>{return 4*e.count*2}})}function sl(t){let{count:e}=t,r=mu(t,ol);const n={count:e};return s.default.createElement(Qi,p({getChildrenForHitmap:ec},r,{reglCommand:al}),n)}sl.defaultProps={count:6};const cl=({useWorldSpaceSize:t})=>e=>{if(!e)throw new Error("Invalid regl instance");const[r,n]=e.limits.pointSizeDims;return Io({primitive:"points",vert:"\n    precision mediump float;\n\n    #WITH_POSE\n\n    uniform mat4 projection, view;\n    uniform float pointSize;\n    uniform bool useWorldSpaceSize;\n    uniform float viewportWidth;\n    uniform float viewportHeight;\n    uniform float minPointSize;\n    uniform float maxPointSize;\n\n    attribute vec3 point;\n    attribute vec4 color;\n    varying vec4 fragColor;\n    void main () {\n      vec3 pos = applyPose(point);\n      gl_Position = projection * view * vec4(pos, 1);\n      fragColor = color;\n\n      if (useWorldSpaceSize) {\n        // Calculate the point size based on world dimensions:\n        // First, we need to compute a new point that is one unit away from\n        // the center of the current point being rendered. We do it in view space\n        // in order to make sure the new point is always one unit up and it's not\n        // affected by view rotation.\n        vec4 up = projection * (view * vec4(pos, 1.0) + vec4(0.0, 1.0, 0.0, 0.0));\n\n        // Then, we compute the distance between both points in clip space, dividing\n        // by the w-component to account for distance in perspective projection.\n        float d = length(up.xyz / up.w - gl_Position.xyz / gl_Position.w);\n\n        // Finally, the point size is calculated using the size of the render target\n        // and it's aspect ratio. We multiply it by 0.5 since distance in clip space\n        // is in range [0, 2] (because clip space's range is [-1, 1]) and\n        // we need it to be [0, 1].\n        float invAspect = viewportHeight / viewportWidth;\n        gl_PointSize = pointSize * 0.5 * d * viewportWidth * invAspect;\n      } else {\n        gl_PointSize = pointSize;\n      }\n\n      // Finally, ensure the calculated point size is within the limits.\n      gl_PointSize = min(maxPointSize, max(minPointSize, gl_PointSize));\n    }\n    ",frag:"\n    precision mediump float;\n    varying vec4 fragColor;\n    void main () {\n      gl_FragColor = vec4(fragColor.x, fragColor.y, fragColor.z, 1);\n    }\n    ",attributes:{point:(t,e)=>e.points.map(t=>Array.isArray(t)?t:mo(t)),color:(t,e)=>{return Po(e)}},uniforms:{pointSize:(t,e)=>e.scale.x||1,useWorldSpaceSize:!!t,viewportWidth:e.context("viewportWidth"),viewportHeight:e.context("viewportHeight"),minPointSize:r,maxPointSize:n},count:e.prop("points.length")})},ul=oc(1);return t.Arrows=Ec,t.Axes=Rc,t.Bounds=class{constructor(){l(this,"x",void 0),l(this,"y",void 0),l(this,"z",void 0),this.x=new fa,this.y=new fa,this.z=new fa}update(t){this.x.update(t.x),this.y.update(t.y),this.z.update(t.z)}},t.CameraListener=Ni,t.CameraStore=ni,t.Command=Qi,t.Cones=gc,t.Cubes=function(t){return a.createElement(Qi,p({getChildrenForHitmap:zc},t,{reglCommand:Bc}))},t.Cylinders=dc,t.DEFAULT_CAMERA_STATE=ri,t.DrawPolygons=function({children:t=[]}){return 0===t.length?null:s.default.createElement(s.default.Fragment,null,s.default.createElement(au,null,t),s.default.createElement(cu,null,t))},t.FilledPolygons=function(t){let{children:e=[]}=t,r=mu(t,tp);const n=ap(e);return s.default.createElement(Ju,p({getChildrenForHitmap:rc},r),n)},t.GLTFScene=function(t){const{children:r,model:n}=t,o=mu(t,Zp),i=e.useContext(Yi),a=nl(n);return e.useEffect(()=>{i&&i.onDirty()},[i,a]),a?s.default.createElement(Qi,p({},o,{reglCommand:rl,getChildrenForHitmap:rc}),tl(tl({},r),{},{model:a,originalMarker:r})):null},t.GLText=function(t){const[r]=e.useState(()=>qp(t)),n=oc(1);return s.default.createElement(Qi,p({getChildrenForHitmap:n,reglCommand:r},t))},t.Grid=sl,t.Lines=Pc,t.OffscreenWorldview=pa,t.Overlay=class extends a.Component{constructor(...t){super(...t),l(this,"_context",void 0),l(this,"state",{items:[]}),l(this,"componentWillUnmount",()=>{this._context&&this._context.unregisterPaintCallback(this.paint)}),l(this,"paint",()=>{const t=this._context,e=t&&t.dimension,{renderItem:r,children:n}=this.props;if(!t||!e)return;const o=n.map((n,o)=>{const i=this.project(n.pose.position,t);return r({item:n,index:o,coordinates:i,dimension:e})});this.setState({items:o})}),l(this,"project",(t,e)=>{if(!e||!e.initializedData)return;const{dimension:r}=e,{camera:n}=e.initializedData,o=[t.x,t.y,t.z],{left:i,top:a,width:s,height:c}=r,u=[i,a,s,c];return n.toScreenCoord(u,o)})}componentDidMount(){this._context&&this._context.registerPaintCallback(this.paint)}render(){return a.createElement(a.Fragment,null,a.createElement(Yi.Consumer,null,t=>(t&&(this._context=t),this.state.items)))}},t.Points=function(t){const[r]=e.useState(()=>cl(t));return s.default.createElement(Qi,p({getChildrenForHitmap:ul},t,{reglCommand:r}))},t.Polygon=ou,t.PolygonBuilder=class{constructor(t=[]){l(this,"mouseDown",!1),l(this,"polygons",void 0),l(this,"onChange",()=>{}),l(this,"activePolygon",void 0),l(this,"activePoint",void 0),l(this,"mouseDownPoint",void 0),l(this,"onMouseMove",(t,e)=>{if(this.activePolygon&&(t.preventDefault(),t.stopPropagation()),!this.mouseDown)return;if(!e)return;if(!this.activePoint&&!this.activePolygon)return;const{ray:r}=e,n=r.planeIntersection([0,0,0],[0,0,1]);if(!n)return;const{activePolygon:o}=this;if(this.activePoint)this.updateActivePoint(n);else if(o&&this.mouseDownPoint){const[t,e]=n,[r,i]=this.mouseDownPoint,a=t-r,s=e-i;this.mouseDownPoint=n;const c=o.points.reduce((t,e)=>(t.includes(e)||t.push(e),t),[]);for(const t of c){const{point:e}=t;e[0]=e[0]+a,e[1]=e[1]+s}this.onChange()}}),l(this,"onKeyDown",t=>{const{activePolygon:e}=this;if(e)switch(t.key){case"Delete":case"Backspace":this.activePoint?this.deletePoint(this.activePoint):this.deletePolygon(e),this.onChange()}}),l(this,"onMouseUp",(t,e)=>{t.ctrlKey||(this.mouseDown=!1)}),l(this,"onDoubleClick",(t,e)=>{if(!e)return;if(!e.objects.length)return;if(this.selectObject(e.objects[0].object),this.activePoint)return void this.deletePoint(this.activePoint);const{activePolygon:r}=this;if(!r)return;let n=Number.MAX_SAFE_INTEGER,o=-1;const{ray:i}=e,a=i.planeIntersection([0,0,0],[0,0,1]);if(!a)return;const[s,c]=a,{points:u}=r;for(let t=0;t<u.length-1;t++){const e=u[t],r=u[t+1],[i,a]=e.point,[p,l]=r.point,f=fu.squared(i,a,p,l,s,c);f<n&&(n=f,o=t)}if(o>-1){const t=new nu(a);r.points.splice(o+1,0,t),this.activePoint=t}this.onChange()}),l(this,"onMouseDown",(t,e)=>{if(!e)return;const{ray:r}=e,n=r.planeIntersection([0,0,0],[0,0,1]);if(!n)return;const o=!this.mouseDown;this.mouseDown=!0,this.mouseDownPoint=n;const i=t.ctrlKey;if(o&&!i){const t=e.objects[0];return this.selectObject(t&&t.object),this.onChange()}return i?(this.pushPoint(n),this.onChange()):(this.closeActivePolygon(),this.onChange())}),this.polygons=t}isActivePolygonClosed(){return!!this.activePolygon&&du(this.activePolygon)}addPolygon(t){const{points:e,name:r}=t;if(e.length<3)return;this.selectObject();const n=new ou(r);n.points=e.map(t=>new nu([t.x,t.y,t.z||0])),du(n)||n.points.push(n.points[0]),this.polygons.push(n)}pushPoint(t){const{activePolygon:e}=this;if(e&&!du(e)){const r=new nu(t);return e.points.push(r),void this.selectObject(r)}const r=new ou;r.points.push(new nu(t));const n=new nu(t);r.points.push(n),this.polygons.push(r),this.selectObject(n),this.onChange()}updateActivePoint(t){this.activePoint&&(this.activePoint.point=t,this.onChange())}closeActivePolygon(){const t=this.activePolygon;t&&(2===t.points.length?this.deletePolygon(t):t.points.push(t.points[0]),this.onChange())}deletePolygon(t){this.polygons=this.polygons.filter(e=>e!==t),this.activePolygon=null}deletePoint(t){const{activePolygon:e}=this;if(!e)return;const r=e.points.filter(e=>e.id!==t.id);r.length===e.points.length-2&&r.push(r[0]),e.points=r,this.activePoint=null,e.points.length<4&&this.deletePolygon(e),this.onChange()}selectObject(t){this.activePolygon=null,this.activePoint&&(this.activePoint.active=!1),this.activePoint=null;for(const e of this.polygons){let r=e===t;e.active=r,r&&(this.activePolygon=e);for(const n of e.points)n===t&&(this.activePoint=n,n.active=!0,e.active=!0,this.activePolygon=e,r=!0)}this.onChange()}},t.PolygonPoint=nu,t.Ray=Hi,t.SUPPORTED_MOUSE_EVENTS=["onClick","onMouseUp","onMouseMove","onMouseDown","onDoubleClick"],t.Spheres=Wc,t.Text=kp,t.Triangles=Ju,t.Worldview=la,t.WorldviewReactContext=Yi,t.blend=Do,t.camera=gi,t.cameraStateSelectors=Xo,t.colorBuffer=Mo,t.cones=bc,t.createInstancedGetChildrenForHitmap=oc,t.cubes=Bc,t.cylinders=fc,t.default=la,t.defaultBlend=Co,t.defaultDepth=So,t.defaultReglBlend=To,t.defaultReglDepth=jo,t.eulerFromQuaternion=function(t,e){const r=function(t,e){var r=e[0],n=e[1],o=e[2],i=e[3],a=r+r,s=n+n,c=o+o,u=r*a,p=n*a,l=n*s,f=o*a,_=o*s,d=o*c,m=i*a,h=i*s,y=i*c;return t[0]=1-l-d,t[3]=p-y,t[6]=f+h,t[1]=p+y,t[4]=1-u-d,t[7]=_-m,t[2]=f-h,t[5]=_+m,t[8]=1-u-l,t}(_a,e),n=r[0],o=r[3],i=r[6],a=r[4],s=r[7],c=r[5],u=r[8];return t[1]=Math.asin(i<-1?-1:i>1?1:i),Math.abs(i)<.99999?(t[0]=Math.atan2(-s,u),t[2]=Math.atan2(-o,n)):(t[0]=Math.atan2(c,a),t[2]=0),t},t.fromGeometry=da,t.fromSpherical=Bo,t.getCSSColor=xo,t.getChildrenForHitmapWithOriginalMarker=rc,t.getIdFromColor=function(t){const e=255*t[0],r=255*t[1];return 255*t[2]|r<<8|e<<16},t.getIdFromPixel=Ro,t.getRayFromClick=Vi,t.getVertexColors=Po,t.intToRGB=ko,t.lines=Ic,t.makeArrowsCommand=(()=>t=>{const e=fc(t),r=bc(t);return t=>{const{cylinders:n,cones:o}=wc(t);e(n),r(o)}}),t.makeFilledPolygonsCommand=(()=>t=>{const e=Xu()(t);return t=>{e(ap(t),!1)}}),t.makeGLTextCommand=qp,t.makePointsCommand=cl,t.makeTrianglesCommand=Xu,t.nonInstancedGetChildrenForHitmap=ec,t.orientationToVec4=ho,t.parseGLB=wa,t.pointToVec3=mo,t.pointToVec3Array=vo,t.shouldConvert=Fo,t.spheres=Lc,t.toColor=wo,t.toRGBA=go,t.vec3ToPoint=yo,t.vec4ToOrientation=bo,t.vec4ToRGBA=Ao,t.withPose=Io,Object.defineProperty(t,"__esModule",{value:!0}),t}({},React,path,fs);
//# sourceMappingURL=index.umd.js.map
